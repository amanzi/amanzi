
<!DOCTYPE html>


<html lang="en" data-content_root="../" data-theme="auto">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chemistry Models &#8212; Amanzi</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "auto";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "auto";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/fix_eq_position.css?v=19b1522f" />
    <link rel="stylesheet" type="text/css" href="../_static/default.css?v=f6536f91" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=7eff24e8"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'capabilities/chemistry';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/amanzi/amanzi/gh-pages/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.5.0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Multiphysics Models" href="mpc.html" />
    <link rel="prev" title="Transport Models" href="transport.html" /> 
 <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
        extensions: ["mhchem.js"]
    }
  });
</script>

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="auto">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>




  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/Amanzi-color.png" class="logo__image only-light" alt="Amanzi - Home"/>
    <script>document.write(`<img src="../_static/Amanzi-Dark.png" class="logo__image only-dark" alt="Amanzi - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../background/index.html">
    Background
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../background/getting_started.html">
    Getting Started with Amanzi
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Amanzi Features and Capabilities
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../input/index.html">
    Amanzi Input Description
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install/index.html">
    Building Amanzi
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../tutorial/index.html">
    Tutorial
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../verification/index.html">
    Verification Testing
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../benchmarking/index.html">
    Benchmark Testing
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../background/index.html">
    Background
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../background/getting_started.html">
    Getting Started with Amanzi
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Amanzi Features and Capabilities
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../input/index.html">
    Amanzi Input Description
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install/index.html">
    Building Amanzi
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorial/index.html">
    Tutorial
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../verification/index.html">
    Verification Testing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../benchmarking/index.html">
    Benchmark Testing
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><!-- This will display the version of the docs -->
Version  1.5.0</div>
        <div class="sidebar-primary-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="features.html">Amanzi Features</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="process.html">Amanzi Process Capabilities</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="flow.html">Flow Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="transport.html">Transport Models</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Chemistry Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpc.html">Multiphysics Models</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
        <div class="sidebar-primary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stoichiometry">Stoichiometry</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geochemical-equilibrium">Geochemical Equilibrium</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#total-component-concentrations">Total Component Concentrations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transport-and-chemistry-coupling-operator-splitting-approach">Transport and Chemistry Coupling: Operator Splitting Approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geochemical-kinetics">Geochemical Kinetics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geochemical-engines">Geochemical Engines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#native-geochemistry">Native Geochemistry</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alquimia-api">Alquimia API</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Amanzi Features and Capabilities</a></li>
    
    
    <li class="breadcrumb-item"><a href="process.html" class="nav-link">Amanzi Process Capabilities</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Chemistry Models</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="chemistry-models">
<h1>Chemistry Models<a class="headerlink" href="#chemistry-models" title="Link to this heading">#</a></h1>
<p>The chemistry component of Amanzi models a set of geochemical processes that lead to the transformation of reactant species to product species. Amanzi can simulate a comprehensive set of reaction types.  These reactions can be classified into <em>homogeneous</em> if they occur within the aqueous phase or <em>heterogeneous</em> if, in addition to the aqueous phase, they involve the solid phase. These reactions can also be classified into equilibrium or kinetic depending on whether local equilibrium can be assumed. The following table summarizes the reactions available by type.</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p><em>Reaction Types</em></p></td>
<td><p>Homogeneous</p></td>
<td><p>Heterogeneous</p></td>
</tr>
<tr class="row-even"><td><p>Equilibrium</p></td>
<td><p><strong>Aqueous Complexation</strong></p></td>
<td><p><strong>Surface Complexation</strong>,
<strong>Ion Exchange</strong></p></td>
</tr>
<tr class="row-odd"><td><p>Kinetic</p></td>
<td><p><strong>Aqueous Kinetics</strong></p></td>
<td><p><strong>Mineral Dissolution-Precipitation</strong></p></td>
</tr>
</tbody>
</table>
</div>
<section id="stoichiometry">
<h2>Stoichiometry<a class="headerlink" href="#stoichiometry" title="Link to this heading">#</a></h2>
<p>The transformation from reactant to product species occurs according to a stoichiometric relationship. The stoichiometry of a generic reaction involving <span class="math notranslate nohighlight">\(N_c\)</span> reactants (<span class="math notranslate nohighlight">\(A_j\)</span>) and a product (<span class="math notranslate nohighlight">\(A_i\)</span>) can be written as</p>
<div class="math notranslate nohighlight" id="equation-stoichiometry">
<span class="eqno">(1)<a class="headerlink" href="#equation-stoichiometry" title="Link to this equation">#</a></span>\[\sum_{j=1}^{N_c} \nu_{ij}~A_j = A_i\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu_{ij}\)</span> is the stoichiometric coefficients of reactant <em>j</em> in reaction <em>i</em>.</p>
</section>
<section id="geochemical-equilibrium">
<h2>Geochemical Equilibrium<a class="headerlink" href="#geochemical-equilibrium" title="Link to this heading">#</a></h2>
<p>The local equilibrium assumption is applicable when reaction rates are much faster than transport rates, and therefore the relationship between the concentrations of products and reactants can be expressed with the law of mass action:</p>
<div class="math notranslate nohighlight" id="equation-equilibrium">
<span class="eqno">(2)<a class="headerlink" href="#equation-equilibrium" title="Link to this equation">#</a></span>\[\log(K_i) = \sum_{j=1}^{N_c}{\nu_{ij}~log(\gamma_j \cdot C_j)} - log(\gamma_i \cdot C_i)\]</div>
<p>where <span class="math notranslate nohighlight">\(K_i\)</span> is the equilibrium constant, <span class="math notranslate nohighlight">\(C_i\)</span> and <span class="math notranslate nohighlight">\(C_j\)</span> are the concentrations of reactant and product species, and <span class="math notranslate nohighlight">\(\gamma_i\)</span> and <span class="math notranslate nohighlight">\(\gamma_j\)</span> are the corresponding activity coefficients.</p>
</section>
<section id="total-component-concentrations">
<h2>Total Component Concentrations<a class="headerlink" href="#total-component-concentrations" title="Link to this heading">#</a></h2>
<p>Geochemical equilibrium between aqueous species makes it possible to calculate the concentration of a set of secondary species as a function of a set of primary species. Further, one can define a set of components, one for each primary species, the mass of which are not affected by geochemical aqueous equilibrium reactions. The total mass of a component  (<span class="math notranslate nohighlight">\(U_j\)</span>) is defined as the sum of the mass of a primary species and the mass of a number of secondary species multiplied by the corresponding stoichiometric coefficient:</p>
<div class="math notranslate nohighlight" id="equation-totalcomponent">
<span class="eqno">(3)<a class="headerlink" href="#equation-totalcomponent" title="Link to this equation">#</a></span>\[U_j = C_j + \sum_{i=1}^{N_r}{\nu_{ij}~C_i}\]</div>
<p>where <span class="math notranslate nohighlight">\(N_r\)</span> is the number of aqueous equilibrium reactions.</p>
<p>This approach is widely used in geochemical models (<span id="id1">[<a class="reference internal" href="#id47" title="P. C. Lichtner. Continuum model for simultaneous chemical reactions and mass transport in hydrothermal systems. Geochimica et Cosmochimica Acta, 49(3):779–800, 1985.">Lic85</a>]</span>, <span id="id2">[<a class="reference internal" href="#id48" title="G. T. Yeh and V. S. Tripathi. A critical evaluation of recent developments in hydrogeochemical transport models of reactive multichemical components. Water Resour. Res., 25:93-108, 1989.">YT89</a>]</span>, <span id="id3">[<a class="reference internal" href="#id49" title="C. I. Steefel and A. C. Lasaga. A coupled model for transport of multiple chemical species and kinetic precipitation/dissolution reactions with applications to reactive flow in single phase hydrothermal systems. American Journal of Science, 294(5):529–592, 1994.">SL94</a>]</span>, <span id="id4">[<a class="reference internal" href="#id50" title="C. I. Steefel and K. T. B. MacQuarrie. Approaches to modeling of reactive transport in porous media. In Reactive Transport in Porous Media, Reviews in Mineralogy and Geochemistry 34, pages 83–125. Mineral Soc America, 1996.">SM96</a>]</span>) to reduce the size of the system to solve, and more specifically the number of transport equations.</p>
</section>
<section id="transport-and-chemistry-coupling-operator-splitting-approach">
<h2>Transport and Chemistry Coupling: Operator Splitting Approach<a class="headerlink" href="#transport-and-chemistry-coupling-operator-splitting-approach" title="Link to this heading">#</a></h2>
<p>Amanzi uses the operator spliting aproach to couple transport and reaction processes <span id="id5">[<a class="reference internal" href="#id48" title="G. T. Yeh and V. S. Tripathi. A critical evaluation of recent developments in hydrogeochemical transport models of reactive multichemical components. Water Resour. Res., 25:93-108, 1989.">YT89</a>]</span>. In the operator splitting approach, transport and chemistry are solved sequentially over the same time step, first transport and then chemistry. One advantage of this approach is that transport equations can be solved using linear solvers. Additionally, the non-linear chemical equations can be solved on a cell-by-cell basis in what is an embarassingly parallel problem. To access these advantages, the transport solver does not operate on the concentrations of each reactant (<span class="math notranslate nohighlight">\(C_j\)</span>) and product species (<span class="math notranslate nohighlight">\(C_i\)</span>). Rather, transport operates on the total component concentrations (<span class="math notranslate nohighlight">\(U_j\)</span>) as defined in eq. <a class="reference internal" href="#equation-totalcomponent">(3)</a>. Please see <a class="reference internal" href="transport.html"><span class="doc">Transport Models</span></a> for details of the transport capabilities of Amanzi. Following transport, the chemical processes affecting the mass balance of all components are solved over the same timestep:</p>
<div class="math notranslate nohighlight" id="equation-operatorsplitting">
<span class="eqno">(4)<a class="headerlink" href="#equation-operatorsplitting" title="Link to this equation">#</a></span>\[\frac{\partial (\phi s_l U_j)}{\partial t}
= r_j\]</div>
<p>This set of equations is solved together with eqs. <a class="reference internal" href="#equation-totalcomponent">(3)</a> and <a class="reference internal" href="#equation-equilibrium">(2)</a> to know the concentration of the individual species, as well as with the equations that describe the kinetic reaction rates <span class="math notranslate nohighlight">\(r_j\)</span> (see eq. <a class="reference internal" href="#equation-kinetics">(5)</a> below).</p>
</section>
<section id="geochemical-kinetics">
<h2>Geochemical Kinetics<a class="headerlink" href="#geochemical-kinetics" title="Link to this heading">#</a></h2>
<p>When local equilibrium cannot be assumed, reaction rates need to be calculated explicitly. The reaction rates are in general a non-linear function of concentrations of the geochemical species. Additionally, for heterogeneous reactions, the rates can be a function of material properties (symbolically: <span class="math notranslate nohighlight">\(\Psi\)</span>), e.g. reactive surface area in the case of mineral dissolution-precipitation. The particular expression depends on the reaction type. For example, mathematical formulations include the transition state theory rate law for mineral dissolution-precipitation or a first order dependence on concentration for radioactive decay. For the sake of brevitiy, the rate expression for reaction <em>k</em> is provided here only as a generic function:</p>
<div class="math notranslate nohighlight" id="equation-kinetics">
<span class="eqno">(5)<a class="headerlink" href="#equation-kinetics" title="Link to this equation">#</a></span>\[r_k = f(C_i,\Psi)\]</div>
<p>The specific mathematical formulations employed for the rate expression depend on the geochemical engine. The choices for geochemical engines are discussed below.</p>
</section>
<section id="geochemical-engines">
<h2>Geochemical Engines<a class="headerlink" href="#geochemical-engines" title="Link to this heading">#</a></h2>
<p>Taking advantage of the operator splitting approach, whereby transport and chemistry are solved sequentially, Amanzi offers a flexible approach to use geochemical engines. The objective of these geochemical engines is to solve the chemistry problem, i.e. equations <a class="reference internal" href="#equation-operatorsplitting">(4)</a>, <a class="reference internal" href="#equation-totalcomponent">(3)</a>, <a class="reference internal" href="#equation-equilibrium">(2)</a> and <a class="reference internal" href="#equation-kinetics">(5)</a>. These geochemical engines can be grouped into two groups:</p>
<ul class="simple">
<li><p>Amanzi’s native geochemical engine: a set of basic geochemical capabilites included in Amanzi.</p></li>
<li><p>External geochemical engines: any existing geochemical code that is coupled to Amanzi through using the Alquimia API.</p></li>
</ul>
</section>
<section id="native-geochemistry">
<h2>Native Geochemistry<a class="headerlink" href="#native-geochemistry" title="Link to this heading">#</a></h2>
<p>The native geochemical engine implements in Amanzi the methods to solve the equations eqs. <a class="reference internal" href="#equation-operatorsplitting">(4)</a>, <a class="reference internal" href="#equation-totalcomponent">(3)</a>, <a class="reference internal" href="#equation-equilibrium">(2)</a> and <a class="reference internal" href="#equation-kinetics">(5)</a> for the types of reactions outlined above. Specifically for kinetic reactions, the following mathematical formulation are available for reaction rate expressions (<span class="math notranslate nohighlight">\(r_k\)</span>)</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Kinetic Reaction Types</p></th>
<th class="head"><p>Rate Expression Type</p></th>
<th class="head"><p>Mathematical Formulation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Mineral Dissolution-Precipitation</p></td>
<td><p>Transition State Theory</p></td>
<td><p><span class="math notranslate nohighlight">\(r_k = k \times A_s \times (1 -Q/K_s)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Aqueous Kinetics</p></td>
<td><p>First order dependence</p></td>
<td><p><span class="math notranslate nohighlight">\(r_k = \lambda \times C_i\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(\lambda\)</span> are rate constants; <span class="math notranslate nohighlight">\(A_s\)</span> is the reactive surface area of the mineral, a material property; <span class="math notranslate nohighlight">\(Q\)</span> is the ion activity product; and <span class="math notranslate nohighlight">\(K_s\)</span> is the solubility or equlibrium constant of the mineral reaction.</p>
<p>The reaction network is specified through a its own geochemical database file (typically with extension .bgd) that is specific to the problem at hand. The total concentrations of all components (<span class="math notranslate nohighlight">\(U_i\)</span>) are specified in the Amanzi input file.</p>
<p>The reader is kindly directed to the <a class="reference internal" href="../benchmarking/chemistry/index.html#sec-benchmarks-chemistry"><span class="std std-ref">Benchmark Testing/Chemistry</span></a> section for examples.</p>
</section>
<section id="alquimia-api">
<h2>Alquimia API<a class="headerlink" href="#alquimia-api" title="Link to this heading">#</a></h2>
<p>Alquimia is an Application Programming Interface (API) that exposes the functionality of a geochemical engine to Amanzi. Alquimia does not perform any geochemical calculations itself. The geochemical engine is responsible for all geochemical calculations, and must provide a wrapper library that exactly conforms to the Alquimia API. Thus, the geochemical capabilities of Amanzi when using the Alquimia interface will depend on the geochemical engine of choice. That means that they can provide Amanzi with those capabilities or specific formulation not available in the native geochemical engine.</p>
<p>Currently, the geochemical capabilities of the reactive transport code PFloTran
(<a class="reference external" href="http://ees.lanl.gov/pflotran/">http://ees.lanl.gov/pflotran/</a> and <a class="reference external" href="https://bitbucket.org/pflotran">https://bitbucket.org/pflotran</a>)
and CrunchFlow (<a class="github reference external" href="https://github.com/cisteefel/crunchtope">cisteefel/crunchtope</a>) are available within Amanzi through the Alquimia interface.
These capabilities are described in the documentation for these packages.
Some examples are available in the Amanzi documentation (<a class="reference internal" href="../benchmarking/chemistry/index.html#sec-benchmarks-chemistry"><span class="std std-ref">Benchmark Testing/Chemistry</span></a>).</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<div class="docutils container" id="id6">
<div role="list" class="citation-list">
<div class="citation" id="id47" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Lic85</a><span class="fn-bracket">]</span></span>
<p>P. C. Lichtner. Continuum model for simultaneous chemical reactions and mass transport in hydrothermal systems. <em>Geochimica et Cosmochimica Acta</em>, 49(3):779–800, 1985.</p>
</div>
<div class="citation" id="id49" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">SL94</a><span class="fn-bracket">]</span></span>
<p>C. I. Steefel and A. C. Lasaga. A coupled model for transport of multiple chemical species and kinetic precipitation/dissolution reactions with applications to reactive flow in single phase hydrothermal systems. <em>American Journal of Science</em>, 294(5):529–592, 1994.</p>
</div>
<div class="citation" id="id50" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">SM96</a><span class="fn-bracket">]</span></span>
<p>C. I. Steefel and K. T. B. MacQuarrie. Approaches to modeling of reactive transport in porous media. In <em>Reactive Transport in Porous Media, Reviews in Mineralogy and Geochemistry 34</em>, pages 83–125. Mineral Soc America, 1996.</p>
</div>
<div class="citation" id="id48" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>YT89<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id5">2</a>)</span>
<p>G. T. Yeh and V. S. Tripathi. A critical evaluation of recent developments in hydrogeochemical transport models of reactive multichemical components. <em>Water Resour. Res.</em>, 25:93–108, 1989.</p>
</div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="transport.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Transport Models</p>
      </div>
    </a>
    <a class="right-next"
       href="mpc.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Multiphysics Models</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Contributing National Laboratories (LANL, LBNL, ORNL, PNNL).
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>