
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Native XML Input Specification for Amanzi-U, Version 1.6-dev &#8212; Amanzi  1.6-dev documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=362ab14a" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=7b05baf8"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'AmanziNativeSpec_dev';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Unstructured Input Specification for Amanzi 1.6-dev" href="AmanziInputSpec-u.html" />
    <link rel="prev" title="Input Specification" href="input_specs.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/Amanzi-color.png" class="logo__image only-light" alt="Amanzi  1.6-dev documentation - Home"/>
    <script>document.write(`<img src="_static/Amanzi-Dark.png" class="logo__image only-dark" alt="Amanzi  1.6-dev documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="input_specs.html">
    Input Specification
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="input_specs.html">
    Input Specification
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Native XML Input Specification for Amanzi-U, Version  1.6-dev</a></li>
<li class="toctree-l1"><a class="reference internal" href="AmanziInputSpec-u.html">Unstructured Input Specification for Amanzi  1.6-dev</a></li>
<li class="toctree-l1"><a class="reference internal" href="AmanziInputSpec-s.html">Structured Input Specification for Amanzi  1.6-dev</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="input_specs.html" class="nav-link">Input Specification</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Native XML...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="native-xml-input-specification-for-amanzi-u-version-version">
<h1><a class="toc-backref" href="#id31" role="doc-backlink">Native XML Input Specification for Amanzi-U, Version  1.6-dev</a><a class="headerlink" href="#native-xml-input-specification-for-amanzi-u-version-version" title="Link to this heading">#</a></h1>
<nav class="contents" id="table-of-contents">
<p class="topic-title"><strong>Table of Contents</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#native-xml-input-specification-for-amanzi-u-version-version" id="id31">Native XML Input Specification for Amanzi-U, Version  1.6-dev</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id32">OVERVIEW</a></p></li>
<li><p><a class="reference internal" href="#parameter-list" id="id33">PARAMETER LIST</a></p>
<ul>
<li><p><a class="reference internal" href="#syntax-of-the-specification" id="id34">Syntax of the specification</a></p></li>
<li><p><a class="reference internal" href="#naming-convention-rule" id="id35">Naming convention rule</a></p></li>
<li><p><a class="reference internal" href="#verbose-output" id="id36">Verbose output</a></p></li>
<li><p><a class="reference internal" href="#residual-debugger" id="id37">Residual debugger</a></p></li>
<li><p><a class="reference internal" href="#units" id="id38">Units</a></p></li>
<li><p><a class="reference internal" href="#symbol-index" id="id39">Symbol index</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#cycle-driver" id="id40">CYCLE DRIVER</a></p>
<ul>
<li><p><a class="reference internal" href="#time-period-control" id="id41">Time period control</a></p></li>
<li><p><a class="reference internal" href="#restart-from-checkpoint-data-file" id="id42">Restart from checkpoint data file</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#state" id="id43">STATE</a></p>
<ul>
<li><p><a class="reference internal" href="#field-evaluators" id="id44">Field evaluators</a></p></li>
<li><p><a class="reference internal" href="#initial-conditions" id="id45">Initial conditions</a></p></li>
<li><p><a class="reference internal" href="#initialization-from-exodus-ii-file" id="id46">Initialization from Exodus II file</a></p></li>
<li><p><a class="reference internal" href="#initialization-from-hdf5-file" id="id47">Initialization from HDF5 file</a></p></li>
<li><p><a class="reference internal" href="#initialization-of-1d-column" id="id48">Initialization of 1D column</a></p></li>
<li><p><a class="reference internal" href="#mesh-partitioning" id="id49">Mesh partitioning</a></p></li>
<li><p><a class="reference internal" href="#data-io-control" id="id50">Data IO control</a></p></li>
<li><p><a class="reference internal" href="#example" id="id51">Example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#process-kernels-pks" id="id52">PROCESS KERNELS (PKs)</a></p></li>
<li><p><a class="reference internal" href="#base-pks" id="id53">BASE PKs</a></p>
<ul>
<li><p><a class="reference internal" href="#pk-physical" id="id54">PK_Physical</a></p></li>
<li><p><a class="reference internal" href="#pk-bdf" id="id55">PK_BDF</a></p></li>
<li><p><a class="reference internal" href="#pk-physicalbdf" id="id56">PK_PhysicalBDF</a></p></li>
<li><p><a class="reference internal" href="#pk-domainfunction" id="id57">PK_DomainFunction</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#physics-pks" id="id58">PHYSICS PKs</a></p>
<ul>
<li><p><a class="reference internal" href="#flow-pk" id="id59">Flow PK</a></p></li>
<li><p><a class="reference internal" href="#transport-pk" id="id60">Transport PK</a></p></li>
<li><p><a class="reference internal" href="#chemistry-pk" id="id61">Chemistry PK</a></p></li>
<li><p><a class="reference internal" href="#energy-pk" id="id62">Energy PK</a></p></li>
<li><p><a class="reference internal" href="#navier-stokes-pk" id="id63">Navier Stokes PK</a></p></li>
<li><p><a class="reference internal" href="#multiphase-pk" id="id64">Multiphase PK</a></p></li>
<li><p><a class="reference internal" href="#shallow-water-pk" id="id65">Shallow water PK</a></p></li>
<li><p><a class="reference internal" href="#mechanics-pk" id="id66">Mechanics PK</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#coupled-pks-mpcs" id="id67">COUPLED PKs (MPCs)</a></p>
<ul>
<li><p><a class="reference internal" href="#reactive-transport-pk" id="id68">Reactive transport PK</a></p></li>
<li><p><a class="reference internal" href="#flow-and-reactive-transport-pk" id="id69">Flow and reactive transport PK</a></p></li>
<li><p><a class="reference internal" href="#thermal-flow-pk" id="id70">Thermal flow PK</a></p></li>
<li><p><a class="reference internal" href="#coupled-matrix-fracture-darcy-flow-pk" id="id71">Coupled matrix-fracture Darcy flow PK</a></p></li>
<li><p><a class="reference internal" href="#thermoporoelasticty-pk" id="id72">Thermoporoelasticty PK</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#generic-capabilities" id="id73">GENERIC CAPABILITIES</a></p>
<ul>
<li><p><a class="reference internal" href="#id20" id="id74">Operators</a></p></li>
<li><p><a class="reference internal" href="#schema" id="id75">Schema</a></p></li>
<li><p><a class="reference internal" href="#id25" id="id76">Time integrator</a></p></li>
<li><p><a class="reference internal" href="#time-step-controller" id="id77">Time step controller</a></p></li>
<li><p><a class="reference internal" href="#functions" id="id78">Functions</a></p></li>
<li><p><a class="reference internal" href="#time-functions" id="id79">Time functions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#solvers" id="id80">SOLVERS</a></p>
<ul>
<li><p><a class="reference internal" href="#iterative-solvers" id="id81">Iterative solvers</a></p></li>
<li><p><a class="reference internal" href="#direct-solvers-from-amesos-library" id="id82">Direct solvers from Amesos library</a></p></li>
<li><p><a class="reference internal" href="#nonlinear-solvers" id="id83">Nonlinear solvers</a></p></li>
<li><p><a class="reference internal" href="#preconditioners" id="id84">Preconditioners</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#mesh" id="id85">MESH</a></p></li>
<li><p><a class="reference internal" href="#geometric-model" id="id86">GEOMETRIC MODEL</a></p>
<ul>
<li><p><a class="reference internal" href="#domain" id="id87">Domain</a></p></li>
<li><p><a class="reference internal" href="#regions" id="id88">Regions</a></p></li>
<li><p><a class="reference internal" href="#notes-and-example" id="id89">Notes and example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#databases" id="id90">DATABASES</a></p>
<ul>
<li><p><a class="reference internal" href="#thermodynamic-database" id="id91">Thermodynamic database</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#output-data" id="id92">OUTPUT DATA</a></p>
<ul>
<li><p><a class="reference internal" href="#observation-file" id="id93">Observation file</a></p></li>
<li><p><a class="reference internal" href="#checkpoint-file" id="id94">Checkpoint file</a></p></li>
<li><p><a class="reference internal" href="#visualization-file" id="id95">Visualization file</a></p></li>
<li><p><a class="reference internal" href="#walkabout-file" id="id96">Walkabout file</a></p></li>
<li><p><a class="reference internal" href="#mesh-info" id="id97">Mesh info</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#input-data" id="id98">INPUT DATA</a></p>
<ul>
<li><p><a class="reference internal" href="#input-analysis" id="id99">Input analysis</a></p></li>
<li><p><a class="reference internal" href="#tabulated-eos-format-amanzi" id="id100">Tabulated EOS format (Amanzi)</a></p></li>
<li><p><a class="reference internal" href="#tabulated-eos-format-fehm" id="id101">Tabulated EOS format (FEHM)</a></p></li>
<li><p><a class="reference internal" href="#tabulated-function-file-format" id="id102">Tabulated function file format</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id32" role="doc-backlink">OVERVIEW</a><a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This is a continuously evolving specification format used by the code developers.
Its main purpose is to develop and test new capabilities without disruption of end-users.</p>
</section>
<section id="parameter-list">
<h2><a class="toc-backref" href="#id33" role="doc-backlink">PARAMETER LIST</a><a class="headerlink" href="#parameter-list" title="Link to this heading">#</a></h2>
<p>The Amanzi input file is an ASCII text XML-formatted file that must be framed
at the beginning and end by the following statements:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;transport&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span>various<span class="w"> </span>parameters<span class="w"> </span>and<span class="w"> </span>sublists
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>The value of <em>name</em> can be anything (<em>transport</em> in this example).
A ParameterList consists of just two types of entries: Parameter and ParameterList.
ParameterLists are labeled with <em>name</em> [string], while Parameters have a separate
fields called <em>name</em> [string], <em>type</em> <code class="docutils literal notranslate"><span class="pre">[string]</span></code> and <em>value</em> [TYPE], where TYPE can
be any of the following: double, int, bool, string, Array(double), Array(int),
and Array(string).
The value of the parameter is given in quotes (e.g. value=”2.7e3”).
Array data is specified as a single comma-delimited string bounded by brackets (e.g. value=”{linear, constant, linear}”).</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;transport&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cfl&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.9&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ratio&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 1, 4}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, the list <em>transport</em> has parameter <em>cfl</em> that is the double with
value 0.9, and parameter <em>ratio</em> that is the integer array such that ratio[0] = 2,
ratio[1]=1, and ratio[2]=4.</p>
<section id="syntax-of-the-specification">
<h3><a class="toc-backref" href="#id34" role="doc-backlink">Syntax of the specification</a><a class="headerlink" href="#syntax-of-the-specification" title="Link to this heading">#</a></h3>
<p>Input specification for each ParameterList entry consists of two parts.
First, a bulleted list defines the usage syntax and available options.
This is followed by example snippets of XML code to demonstrate usage.</p>
<p>In many cases, the input specifies data for a particular parameterized model, and Amanzi
supports a number of parameterizations.
For example, initial data might be uniform (the value is required), or linear in y (the value
and its gradient are required).
Where Amanzi supports a number of parameterized models for parameter <em>model</em>, the available
models will be listed by name, and then will be described in the subsequent section.
In the manufactured example below, the specification looks as follows:</p>
<ul class="simple">
<li><p>SOIL <code class="docutils literal notranslate"><span class="pre">[list]</span></code> accepts parameters that describes properties of this soil.</p>
<ul>
<li><p><cite>“region</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines a subdomain of the computational domain.</p></li>
<li><p><cite>“model</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> specifies a model for the soil. Available options are <cite>“van Genuchten</cite>”
and <cite>“Brooks-Corey</cite>”.</p></li>
</ul>
</li>
</ul>
<p>Here SOIL is defined by a <em>region</em> and a <em>model</em>.
The <em>region</em> is a string parameter but the <em>model</em> is given by a sublist with its own set of parameters.
The parameter for <em>model</em> can be described in the same section or in a separate section
of this document. For instance, the local description may look like:</p>
<ul class="simple">
<li><p><cite>“model</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> specifies a model for the soil. Available options are <cite>“van Genuchten</cite>”
and <cite>“Brooks-Corey</cite>”.
The option <cite>“van Genuchten</cite>” requires <cite>“m</cite>” [double].
The option <cite>“Brooks-Corey</cite>” requires <cite>“lambda</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> and <cite>“alpha</cite>” [double].</p></li>
</ul>
<p>Each part of the spec is illustrated by an example followed by optional comments:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;water retention models&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;SOIL&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;TOP_DOMAIN&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Brooks-Corey&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;lambda&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.7&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;alpha&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-3&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>This defines soil properties in region TOP_DOMAIN using the
Brooks-Corey model with parameters <em>lambda=0.7</em> and <em>alpha=1e-3</em>.</p>
<p>Additional conventions:</p>
<ul class="simple">
<li><p>Reserved keywords and labels are <em>italicized</em> in discussions and <cite>“quoted and italicized</cite>” in the spec.
These are usually labels or values of parameters
in the input file and must match (using XML matching rules) the specified or allowable values.</p></li>
<li><p>User-defined labels are marked with _ALL_CAPS in this document.
In practice, no rules are imposed on these names.</p></li>
<li><p>Lists with too many parameters are described using multiple sections and multiple examples.
For most examples we show name of the parent sublist.</p></li>
</ul>
</section>
<section id="naming-convention-rule">
<h3><a class="toc-backref" href="#id35" role="doc-backlink">Naming convention rule</a><a class="headerlink" href="#naming-convention-rule" title="Link to this heading">#</a></h3>
<p>It is hard to overestimate importance of a reasonable naming convention rule for efficient
code development and its daily usage in research.</p>
<ul class="simple">
<li><p>Camel-case names should <em>not</em> be used as names for fixed keywords (parameters and parameter lists).
The following is a short list of allowed exceptions.</p>
<ul>
<li><p>The names created by the user are not fixed/reserved keywords and are exempt from the above
rule. In this documents, we always prefix user-defined names with
the underscore symbol.</p></li>
<li><p>Proper names such as an individual person, place, or organization, including their derivatives
<em>should</em> be spelled using capital letters. Examples: <em>van Genuchten m</em>, <em>Brooks-Corey lambda</em>,
<em>Jacobian matrix</em>, and <em>Newton correction</em>.</p></li>
<li><p>Names of chemical species (inside fixed keywords) should be capitalized. Examples: <em>CO2</em>, <em>H+</em>.</p></li>
<li><p>A few well-established abbreviations. Their complete list is here: <em>PK</em>, <em>MPC</em>, <em>BDF1</em>, <em>EOS</em>,
<em>IEM</em>, <em>PFloTran</em>, <em>pH</em>, <em>TP</em>. Note that names of linear and nonlinear solvers and preconditioners are
not included in this list. Thus, we have to use <em>pcg</em>, <em>gmres</em>, <em>nka</em>, <em>amg</em>, <em>ml</em>, and <em>ilu</em>.</p></li>
<li><p>Units such as energy [J] and temperature [K].</p></li>
<li><p>The Hilbert spaces <em>L2</em> and <em>H1</em>. Note that <em>L2</em> and <em>l2</em> are different spaces and should be used
appropriately.</p></li>
<li><p>Trilinos parameters. There are a few camel-case parameters that
go directly to Trilinos functions and therefore outside of our control, e.g. <em>ML output</em>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="verbose-output">
<span id="verbose-object"></span><h3><a class="toc-backref" href="#id36" role="doc-backlink">Verbose output</a><a class="headerlink" href="#verbose-output" title="Link to this heading">#</a></h3>
<p>Output of all components of Amanzi is controlled by a standard verbose
object list. This list can be inserted in almost any significant
component of this spec to produce a verbose output, see the embedded examples.
If this list is not specified, the default verbosity value is used.</p>
<ul class="simple">
<li><p><cite>“verbosity level</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Available options are <em>none</em>, <em>low</em>, <em>medium</em>, <em>high</em>, and <em>extreme</em>.
Option <em>extreme is used by the developers only. For communication between users and developers,
the recommended option is *high</em>.</p></li>
<li><p><cite>“hide line prefix</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> defines prefix for output messages. Default value is <em>true</em>.</p></li>
<li><p><cite>“name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the name of the prefix.</p></li>
<li><p><cite>“write on rank</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> is processor rank on which the output is performed. Default is 0.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbose object&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbosity level&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;medium&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;my header&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;hide line prefix&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;write on rank&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="residual-debugger">
<h3><a class="toc-backref" href="#id37" role="doc-backlink">Residual debugger</a><a class="headerlink" href="#residual-debugger" title="Link to this heading">#</a></h3>
<p>Some components (currently just nonlinear solver, this may change)
leverage a <em>residual debugger</em> object for writing, to file, residuals,
corrections, and internal iterates of a solve process for solver
debugging/work.  Control of when these iterates are written is
controlled by a few parameters.  This should be written sparingly –
each attempt at a timestep and each cycle is its own file, and writes
its own mesh file, so this should be considered i/o and runtime
expensive.</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>“cycles start period stop</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> the first entry is the start cycle,
the second is the cycle period, and the third is the stop cycle or -1 in which case
there is no stop cycle. All iterations shall be written at such cycles that
satisfy formula cycle = start + n*period, for n=0,1,2,… and cycle &lt; stop if stop != -1.0.</p></li>
<li><p><cite>“cycles start period stop n</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> if multiple cycles start-period-stop parameters
are needed, then use these parameters with n=0,1,2,…, and not the single
<cite>“cycles start period stop</cite>” parameter.</p></li>
<li><p><cite>“cycles</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> an array of single cycles at which all iterations shall be written.</p></li>
</ul>
</div></blockquote>
<p>Note: <em>cycle</em> here means the current time integration step and <em>not</em> the global cycle.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;BDF1&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;residual debugger&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycles start period stop&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0,100,-1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycles&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{999, 1001}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="units">
<h3><a class="toc-backref" href="#id38" role="doc-backlink">Units</a><a class="headerlink" href="#units" title="Link to this heading">#</a></h3>
<p>Amanzi’s internal default units are SI units except for the concentration.</p>
<p>Curently format of units is very rigid, we need to use multiplication and
division operators, e.g. Pa*s and kg/s. However, this allows to mix and match,
e.g. m/s^2 or ms^-2 or s^-2*m.</p>
<ul class="simple">
<li><p><cite>“concentration</cite>” [string] defines units for concentration. Available options
are <cite>“molar</cite>” (default) which is <cite>“mol/L</cite>” and <cite>“SI</cite>” which is <cite>“mol/m^3</cite>”.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;units&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;length&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;m&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;s&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mass&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;kg&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;temperature&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;K&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;concentration&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;molar&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="symbol-index">
<h3><a class="toc-backref" href="#id39" role="doc-backlink">Symbol index</a><a class="headerlink" href="#symbol-index" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(C\)</span></p></td>
<td><p>concentration <span class="math notranslate nohighlight">\([mol/m^3]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\boldsymbol{D}\)</span></p></td>
<td><p>dispersion tensor <span class="math notranslate nohighlight">\([m^2/s]\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(H\)</span></p></td>
<td><p>specific molar enthalpy <span class="math notranslate nohighlight">\([J/mol]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\boldsymbol{K}\)</span></p></td>
<td><p>absolute permeability tensor <span class="math notranslate nohighlight">\([m^2]\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\boldsymbol{M}\)</span></p></td>
<td><p>molecular diffusion coefficient <span class="math notranslate nohighlight">\([m^2/s]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(Q\)</span></p></td>
<td><p>source, units depends on equation</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td><p>temperature <span class="math notranslate nohighlight">\([K]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(U_\alpha\)</span></p></td>
<td><p>specific internal energy of phase <span class="math notranslate nohighlight">\(\alpha\)</span> <span class="math notranslate nohighlight">\([J/mol]\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\varepsilon\)</span></p></td>
<td><p>specific energy <span class="math notranslate nohighlight">\([J/m^3]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(g\)</span></p></td>
<td><p>gravitational acceleration vector <span class="math notranslate nohighlight">\([m/s^2]\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(h\)</span></p></td>
<td><p>ponded depth, or the water head over the surface <span class="math notranslate nohighlight">\([m]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(k_r\)</span></p></td>
<td><p>relative permeability <span class="math notranslate nohighlight">\([-]\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(p_\alpha\)</span></p></td>
<td><p>pressure of phase <span class="math notranslate nohighlight">\(\alpha\)</span> <span class="math notranslate nohighlight">\([Pa]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\mathbf{q}\)</span></p></td>
<td><p>Darcy flux vector <span class="math notranslate nohighlight">\([mol\ / m^2 / s]\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(s_\alpha\)</span></p></td>
<td><p>saturation of phase <span class="math notranslate nohighlight">\(\alpha\)</span> <span class="math notranslate nohighlight">\([-]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(z\)</span></p></td>
<td><p>spatial coordinates <span class="math notranslate nohighlight">\([m]\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(z\)</span></p></td>
<td><p>elevation <span class="math notranslate nohighlight">\([m]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\alpha_l\)</span>, <span class="math notranslate nohighlight">\(\alpha_t\)</span></p></td>
<td><p>longitudinal and transverse dispersivities <span class="math notranslate nohighlight">\([m]\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
<td><p>Biot-Willis coefficient <span class="math notranslate nohighlight">\([-]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\beta_*\)</span></p></td>
<td><p>thermal dilation coefficients <span class="math notranslate nohighlight">\([W/K]\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\kappa\)</span></p></td>
<td><p>thermal conductivity <span class="math notranslate nohighlight">\([W/m/K]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\mu_\alpha\)</span></p></td>
<td><p>dynamic viscosity of phase <span class="math notranslate nohighlight">\(alpha\)</span> <span class="math notranslate nohighlight">\([Pa\cdot s]\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\eta_\alpha\)</span></p></td>
<td><p>molar density of phase <span class="math notranslate nohighlight">\(\alpha\)</span> <span class="math notranslate nohighlight">\([mol/m^3]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\rho_\alpha\)</span></p></td>
<td><p>mass density of phase <span class="math notranslate nohighlight">\(\alpha\)</span> <span class="math notranslate nohighlight">\([kg / m^3]\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\phi\)</span></p></td>
<td><p>porosity of the soil <span class="math notranslate nohighlight">\([-]\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\tau\)</span></p></td>
<td><p>tortuosity <span class="math notranslate nohighlight">\([-]\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\theta\)</span></p></td>
<td><p>water content <span class="math notranslate nohighlight">\([mol]\)</span></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="cycle-driver">
<h2><a class="toc-backref" href="#id40" role="doc-backlink">CYCLE DRIVER</a><a class="headerlink" href="#cycle-driver" title="Link to this heading">#</a></h2>
<p>CycleDriver is a class to hold the cycle driver, which runs the overall, top level timestep
loop. It instantiates states, ensures they are initialized, and runs the timestep loop
including Vis and restart/checkpoint dumps.  It contains one and only one PK
– most likely this PK is an MPC of some type – to do the actual work.</p>
<p>The new multi-processor cycle driver provides more flexibility
to handle multiphysics process kernels (PKs) and multiple time periods.</p>
<div class="admonition-cycle-driver-spec admonition" id="cycle-driver-spec">
<p class="admonition-title">cycle_driver-spec</p>
<ul class="simple">
<li><p><cite>“component names</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> provides the list of species names.
It is required for reactive transport.</p></li>
<li><p><cite>“component molar masses</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> provides the list of
molar masses of species. It is required for proper conversion to and from
dimensionless units. Default is 1.</p></li>
<li><p><cite>“number of liquid components</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> is the number of liquid components.</p></li>
<li><p><cite>“time periods</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> contains the list of time periods involved in the simulation.
The number of time periods is not limited.</p>
<ul>
<li><p><cite>“TP #</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines a particular time period. The numbering
should be sequential starting with 0.</p>
<ul>
<li><p><cite>“PK tree</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> describes a hierarchical structure of the process kernels
that reflect their weak and strong coupling.</p>
<ul>
<li><p><cite>“PKNAME</cite>”  <code class="docutils literal notranslate"><span class="pre">[list]</span></code> name of PK which is used in the
simulation. Name can be arbitrary but the sublist with the same name
should exist in the list of PKs (see below).</p></li>
<li><p><cite>“PK type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies the type of PK supported by Amanzi. At the moment
available options are (<cite>“darcy</cite>”, <cite>“richards</cite>”, <cite>“transport</cite>”, <cite>“one-phase energy</cite>”,
<cite>“two-phase energy</cite>”, <cite>“reactive transport</cite>”, <cite>“flow reactive transport</cite>”,
<cite>“thermal richards</cite>”, <cite>“chemistry</cite>”, <cite>“transport implicit</cite>”, <cite>“transport matrix fracture</cite>”,
<cite>“transport matrix fracture implicit</cite>”, <cite>“flow</cite>”, and <cite>“darcy matrix fracture</cite>”).</p></li>
<li><p><cite>“start period time</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the start time of the current time period.</p></li>
<li><p><cite>“end period time</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the end time of the current time period.</p></li>
<li><p><cite>“maximum cycle number</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> is the maximum allowed number of cycles in
the current time period. Special value -1 means unlimited number of cycles.</p></li>
<li><p><cite>“initial timestep</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the initial timestep for the current time period.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><cite>“io frequency</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> defines frequency of printing field statistics.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycle driver&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;component names&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{H+, Na+, NO3-, Zn++}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;component molar masses&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1.0e-3, 23.0e-3, 62.0e-3, 65.4e-3}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of liquid components&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;4&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time periods&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;TP 0&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK tree&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_FLOW and REACTIVE TRANSPORT&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;flow reactive transport&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_REACTIVE TRANSPORT&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;reactive transport&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_TRANSPORT&quot;</span><span class="nt">&gt;</span>
<span class="w">              </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;transport&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">            </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_CHEMISTRY&quot;</span><span class="nt">&gt;</span>
<span class="w">              </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;chemistry&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_FLOW&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;darcy&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;start period time&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;end period time&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.5778463e+09&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;maximum cycle number&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;-1&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial timestep&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.57680e+05&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;TP 1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this simulation, we use the PK labeled as <em>flow reactive transport</em>. It is
defined internally as sequential application of two PKs, <em>flow</em> and <em>reactive transport</em>.
The latter is defined as sequential application of two PKs, <em>transport</em> and <em>chemistry</em>.
Process kernel <em>reactive transport</em> can susbcycle with respect to <em>flow</em>.
Process kernel <em>chemistry</em> can susbcycle with respect to <em>transport</em>.</p>
<section id="time-period-control">
<h3><a class="toc-backref" href="#id41" role="doc-backlink">Time period control</a><a class="headerlink" href="#time-period-control" title="Link to this heading">#</a></h3>
<p>A set of times that simulation hits exactly can be used to avoid problems with
sudden change of boundary conditions or source/sink terms.
This list must <em>NOT</em> include start times for time periods <em>TP #</em>.</p>
<div class="admonition-time-period-controls-spec admonition">
<p class="admonition-title">time_period_controls-spec</p>
<ul class="simple">
<li><p><cite>“start times</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> is the list of particular times that we want to hit exactly.</p></li>
<li><p><cite>“initial time step</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> is the size of the first time step after we hit a special
time specified above.</p></li>
<li><p><cite>“maximum time step</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> allows the user to limit the time step between
two particular times.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycle driver&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time period control&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;start times&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{3.16e+10, 6.32e+10}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial time step&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{100.0, 100.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;maximum time step&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{3.2e+8, 4e+17}&quot;</span><span class="nt">/&gt;</span>
<span class="w"> </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w"> </span><span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Between approximately 1000 and 2000 years, we limit the maximum time step to 10 years.</p>
</section>
<section id="restart-from-checkpoint-data-file">
<h3><a class="toc-backref" href="#id42" role="doc-backlink">Restart from checkpoint data file</a><a class="headerlink" href="#restart-from-checkpoint-data-file" title="Link to this heading">#</a></h3>
<p>A user may request to restart a simulation from a checkpoint data file by creating list
<em>restart</em>. In this scenario, the code will overwrite data initialized using the input XML file.
The purpose of restart is to continue the simulation that has been terminated before for some reasons,
e.g. because its allocation of time ran out.
The value for the current time and current cycle is read from the checkpoint file.</p>
<div class="admonition-restart-from-file-spec admonition">
<p class="admonition-title">restart_from_file-spec</p>
<ul class="simple">
<li><p><cite>“restart</cite>” [list]</p>
<ul>
<li><p><cite>“file name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> provides name of the existing checkpoint data file to restart from.</p></li>
</ul>
</li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycle driver&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;restart&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file name&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_CHECK00123.h5&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, Amanzi is restarted with all state data initialized from file
CHECK00123.h5.</p>
</section>
</section>
<section id="state">
<h2><a class="toc-backref" href="#id43" role="doc-backlink">STATE</a><a class="headerlink" href="#state" title="Link to this heading">#</a></h2>
<p>State  is a  simple data-manager,  allowing PKs  to require,  read, and  write
various fields.</p>
<ul class="simple">
<li><p>Acts as a factory for data through the various require methods.</p></li>
<li><p>Provides some data protection by providing both const and non-const
data pointers to PKs.</p></li>
<li><p>Provides some initialization capability – this is where all
independent variables can be initialized (as independent variables
are owned by state, not by any PK).</p></li>
</ul>
<div class="admonition-state-spec admonition" id="state-spec">
<p class="admonition-title">state-spec</p>
<ul class="simple">
<li><p><cite>“evaluators</cite>” <code class="docutils literal notranslate"><span class="pre">[evaluator-typedinline-spec-list]</span></code> A list of evaluators.</p></li>
<li><p><cite>“initial conditions</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> A list of constant-in-time data.  Note
that <cite>“initial conditions</cite>” is not a particularly descriptive name here –
PDE initial conditions are generally not here.  This list consists of</p></li>
<li><p><cite>“model parameters</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> A list of shared model parameters that can
be used across all evaluators.</p></li>
</ul>
</div>
<div class="admonition-evaluator-typedinline-spec admonition" id="evaluator-typedinline-spec">
<p class="admonition-title">evaluator-typedinline-spec</p>
<ul class="simple">
<li><p><cite>“evaluator type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Type of the evaluator Included for
convenience in defining data that is not in the dependency graph,
constants are things (like gravity, or atmospheric pressure) which are
stored in state but never change.  Typically they’re limited to scalars
and dense, local vectors.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;state&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initialization filename&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_CHECK00123.h5&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;evaluators&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pressure&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;evaluator type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;primary variable&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;atmospheric pressure&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;101325.0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0.0,0.0,-9.80665}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p><cite>“initialization filename</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> (optional) provides name of the existing checkpoint data
file. The initialization sequence is as follows. First, we try to initialize a
field using the provided checkpoint file. Second, regardless of the outcome of the
previous step, we try to initialize the field using the sublist <cite>“initial conditions</cite>”.
By design, the second step allows us to overwrite only part for the
field.</p></li>
<li><p><cite>“initial conditions</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> There are several options available to initialize
fields using this list: <cite>“restart file</cite>” - read field
from existing HDF5 file, <cite>“exodus file initialization</cite>” - read field
from existing Exodus file, <cite>“cells from file</cite>” - read cell
components from HDF5 file, <cite>“constant</cite>” - set field values to constant, <cite>“initialize
from 1D column</cite>” - initialize 1D column from file and <cite>“function</cite>” -
field is initialized by function. Initialization time is specified with <cite>“time</cite>”
that defaults to 0.</p></li>
</ul>
</div>
<section id="field-evaluators">
<h3><a class="toc-backref" href="#id44" role="doc-backlink">Field evaluators</a><a class="headerlink" href="#field-evaluators" title="Link to this heading">#</a></h3>
<p>There are five different types of field evaluators.</p>
<section id="independent-variable-field-evaluator">
<h4>Independent variable field evaluator<a class="headerlink" href="#independent-variable-field-evaluator" title="Link to this heading">#</a></h4>
<p>An independent variable field evaluator has no dependencies and is specified by a function.
Typically, it is evaluated once per simulation.
The evaluator has the following control parameters.</p>
<ul class="simple">
<li><p><cite>“field evaluator type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> The value of this parameter is used by the factory
of evaluators. The available option are <cite>“independent variable</cite>”, <cite>“primary variable</cite>”,
and <cite>“secondary variable</cite>”.</p></li>
<li><p><cite>“constant in time</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> specifies time-dependence nature of the field.</p></li>
<li><p><cite>“function</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines a piecewise continuous function for calculating the independent variable.
In may contain multiple sublists <cite>“_DOMAIN</cite>” with identical structure.</p>
<ul>
<li><p><cite>“_DOMAIN</cite>” [list]</p>
<ul>
<li><p><cite>“region</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies domain of the function, a single region.</p></li>
<li><p><cite>“regions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> is the alternative to option <cite>“region</cite>”, domain on
the function consists of many regions.</p></li>
<li><p><cite>“component</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies geometric object associated with the mesh function.
Available options are <cite>“cell</cite>”, <cite>“face</cite>”, and <cite>“node</cite>”.</p></li>
<li><p><cite>“function</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines an analytic function for calculation. Its structure
is described in the <a class="reference internal" href="#functions">Functions</a> section below.</p></li>
<li><p><cite>“initialize faces from cells</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> instructs state to initialize face-component
and boundary face-component (if any) of a composite vector from a cell-component
using simple averaging. Default is false.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;field_evaluators&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;saturation_liquid&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;field evaluator type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;independent variable&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;constant in time&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_DOMAIN&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_ALL DOMAIN&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;component&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.8&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbose object&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbosity level&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;extreme&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example field <em>saturation_liquid</em> is defined as a cell-based variable with constant value 0.8.
Note that the user-defined name for this field cannot have spaces.</p>
</section>
<section id="independent-variable-field-evaluator-from-file">
<h4>Independent variable field evaluator from file<a class="headerlink" href="#independent-variable-field-evaluator-from-file" title="Link to this heading">#</a></h4>
<p>This evaluator is typically used for providing data that are functions of space
and time.  Data is provided, discretely (e.g. with one data point per
cell/face/node), at a series of time slices.  The time slices are interpolated
linearly in time to provide the value.</p>
<p>Within the file, data is expected to meet the following (HDF5) layout:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">time</span> <span class="p">:</span> <span class="n">a</span> <span class="mi">1</span><span class="n">D</span> <span class="n">array</span> <span class="n">of</span> <span class="n">length</span> <span class="n">NTIMES</span><span class="p">,</span> <span class="n">providing</span> <span class="n">the</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">seconds</span><span class="o">.</span>
<span class="o">/</span><span class="n">variable_name</span><span class="o">.</span><span class="n">ENTITY</span><span class="o">.</span><span class="n">DOF</span>  <span class="p">(</span><span class="n">group</span><span class="p">)</span>

   <span class="o">/</span><span class="mi">0</span> <span class="p">:</span> <span class="n">a</span> <span class="mi">1</span><span class="n">D</span> <span class="n">array</span> <span class="n">of</span> <span class="n">length</span> <span class="n">NENTITIES</span><span class="p">,</span> <span class="n">providing</span> <span class="n">the</span> <span class="n">values</span> <span class="k">for</span> <span class="n">each</span> <span class="n">entity</span>
        <span class="n">at</span> <span class="n">time</span> <span class="o">/</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
   <span class="o">/</span><span class="mi">1</span> <span class="p">:</span> <span class="o">...</span>
   <span class="o">/</span><span class="n">NTIMES</span><span class="o">-</span><span class="mi">1</span> <span class="p">:</span> <span class="mi">1</span><span class="n">D</span> <span class="n">array</span> <span class="n">at</span> <span class="n">time</span> <span class="o">/</span><span class="n">time</span><span class="p">[</span><span class="n">NTIMES</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>This evaluator is used by providing the option:</p>
<p><cite>“evaluator type</cite>” == <cite>“independent variable</cite>”</p>
<div class="admonition-independent-variable-from-file-evaluator-spec admonition" id="independent-variable-from-file-evaluator-spec">
<p class="admonition-title">independent-variable-from-file-evaluator-spec</p>
<ul class="simple">
<li><p><cite>“filename</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Path to the file.</p></li>
<li><p><cite>“variable name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Name of the dataset to read from the file.</p></li>
<li><p><cite>“domain name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>domain</strong> Name of the domain on which the
field is defined.</p></li>
<li><p><cite>“component name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>cell</strong> Name of the component in the
field to populate.</p></li>
<li><p><cite>“mesh entity</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>cell</strong> Name of the entity on which the
component is defined.</p></li>
<li><p><cite>“number of dofs</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>1</strong> Number of degrees of freedom to read.</p></li>
<li><p><cite>“time function</cite>” <code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code> <strong>optional</strong> If provided, time is
first manipulated by this function before interpolation.  This is useful
for things like cyclic data, which can use a modulo time function to
repeat the same data.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;field_evaluators&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;porosity&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;field evaluator type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;independent variable from file&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;filename&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_DATA_FILE.h5&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;domain name&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;domain&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;variable name&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;porosity&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;component name&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mesh entity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of dofs&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time function&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1.0, 2.0, 3.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>The field <em>porosity</em> is defined as a cell-based variable and
interpolated between three time intervals.</p>
</section>
<section id="constant-variable-field-evaluator">
<h4>Constant variable field evaluator<a class="headerlink" href="#constant-variable-field-evaluator" title="Link to this heading">#</a></h4>
<p>Constant variable field evaluator as a simplified version of independent field evaluator from
file which allows one to define constant in time field. Initialization of the field
has to be done in the initial conditions sublist of state.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;porosity&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_ANY NAME&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_ALL DOMAIN}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;component&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;90000.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>

<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;field_evaluators&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;porosity&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;field evaluator type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;constant variable&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="primary-variable-field-evaluator">
<h4>Primary variable field evaluator<a class="headerlink" href="#primary-variable-field-evaluator" title="Link to this heading">#</a></h4>
<p>An evaluator with no dependencies that serves as the primary variable to be
solved for by a PK.  Note that users almost never are required to write an
input spec for these – they are controlled by the PK and therefore the input
spec for this evaluator is written by that PK.</p>
<div class="admonition-evaluator-primary-spec admonition" id="evaluator-primary-spec">
<p class="admonition-title">evaluator-primary-spec</p>
<ul class="simple">
<li><p><cite>“tag</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>“”</strong> Time tag at which this primary variable is used.</p></li>
</ul>
</div>
</section>
<section id="secondary-variable-field-evaluators">
<h4>Secondary variable field evaluators<a class="headerlink" href="#secondary-variable-field-evaluators" title="Link to this heading">#</a></h4>
<p>Secondary fields are derived either from primary fields or other secondary fields.
There are two types of secondary fields evaluators.
The first type is used to evaluate a single field.
The second type is used to evaluate efficiently (in one call of an evaluator) multiple fields.</p>
<p>Typically, secondary fields are created by high-level PKs during the setup phase and
inserted automatically in the list of evaluators.
The related XML syntax can provide various parameters needed for evaluation as explained in two
examples below.
The developer can create a secondary field evaluator using common parameters as well
as custom parameters (see the examples).</p>
<ul class="simple">
<li><p><cite>“evaluator dependencies</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> provides a list of fields on which this evaluator
depends.</p></li>
<li><p><cite>“check derivatives</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> allows the develop to check derivatives with finite differences.
This is the expensive option involving finite difference approximations and is recommended for
code debugging only. Default is <em>false</em>.</p></li>
<li><p><cite>“finite difference epsilon</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines the finite difference epsilon.
Default is 1e-10.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;field_evaluators&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;molar_density_liquid&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;field evaluator type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;eos&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;eos basis&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;both&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;molar density key&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;molar_density_liquid&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mass density key&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mass_density_liquid&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;EOS parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;eos type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;liquid water&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbose object&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbosity level&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;extreme&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, the secondary field <em>internal_energy_rock</em> is evaluated using one of the
internal <em>iem</em> evaluators.
A particular evaluator is selected dynamically using parameter <em>iem type</em>.</p>
</section>
</section>
<section id="initial-conditions">
<h3><a class="toc-backref" href="#id45" role="doc-backlink">Initial conditions</a><a class="headerlink" href="#initial-conditions" title="Link to this heading">#</a></h3>
<section id="constant-scalar-field">
<h4>Constant scalar field<a class="headerlink" href="#constant-scalar-field" title="Link to this heading">#</a></h4>
<p>A constant field is the global (with respect to the mesh) constant.
At the moment, the set of such fields includes <em>fluid_density</em>
and <em>fluid_viscosity</em>.
The initialization requires to provide a named sublist with a single
parameter <em>value</em>.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;fluid_density&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;998.0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="constant-vector-field">
<h4>Constant vector field<a class="headerlink" href="#constant-vector-field" title="Link to this heading">#</a></h4>
<p>A constant vector field is the global (with respect to the mesh) vector constant.
At the moment, the set of such vector constants includes <em>gravity</em>.
The initialization requires to provide a named sublist with a single
parameter <em>value</em>. In three dimensions, it looks like</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0.0, 0.0, -9.81}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="a-scalar-field">
<h4>A scalar field<a class="headerlink" href="#a-scalar-field" title="Link to this heading">#</a></h4>
<p>A variable scalar field is defined by a few functions (labeled with _MESH BLOCK #
in our example) with non-overlapping domains.
The required parameters for each function are <em>region</em>, <em>component</em>,
and <em>function</em>.</p>
<ul class="simple">
<li><p><cite>“regions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> is list of mesh regions where the function
should be applied, the domain of the function.</p></li>
<li><p><cite>“component</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies a mesh object on which the discrete field
is defined.</p></li>
</ul>
<p>Optional parameters are <em>write checkpoint</em> and <em>write vis</em>.
These parameters define whether the field has to be written into
checkpoints of visualization files. Default values are <em>true</em>.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pressure&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;write checkpoint&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value =</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;write vis&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value =</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_MESH BLOCK 1&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_DOMAIN 1&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;component&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;90000.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_MESH BLOCK 2&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_DOMAIN 2, _DOMAIN 3}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, the field <em>pressure</em> has constant value 90000 [Pa] in
each mesh cell of the first region. The second mesh block will define
the pressure in the second mesh region and so on.
Note that the names of functions may coincide with the names of regions.</p>
</section>
<section id="a-vector-or-tensor-field">
<h4>A vector or tensor field<a class="headerlink" href="#a-vector-or-tensor-field" title="Link to this heading">#</a></h4>
<p>A variable tensor (or vector) field is defined similarly to a variable scalar field.
The difference lies in the definition of the function which is now a multi-valued function.</p>
<div class="admonition-tensor-field-spec admonition">
<p class="admonition-title">tensor_field-spec</p>
<ul class="simple">
<li><p><cite>“number of dofs</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> is the number of components in the vector or tensor.</p></li>
<li><p><cite>“function type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines the function type. The only available option
is <cite>“composite function</cite>”.</p></li>
<li><p><cite>“dot with normal</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> triggers the special initialization of a
vector field such as the <cite>“volumetric_flow_rate</cite>”. This field is defined by
projection of the velocity (a vector field) on face normals.
Changing value to <em>false</em> will produce the vector field.</p></li>
</ul>
</div>
<p>Optional parameters are <em>write checkpoint</em>,  and <em>write vis</em>.
These parameters define whether the field has to be written into
checkpoints of vis files. Default values are <em>true</em>.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;volumetric_flow_rate&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;write checkpoint&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;write vis&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dot with normal&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_MESH BLOCK 1&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_ALL DOMAIN}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;component&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;face&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of dofs&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;composite function&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dof 1 function&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.002&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dof 2 function&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.001&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example the constant Darcy velocity (0.002, 0.001) [m/s] is dotted with the face
normal producing one number per mesh face.</p>
</section>
<section id="geochemical-constraint">
<h4>Geochemical constraint<a class="headerlink" href="#geochemical-constraint" title="Link to this heading">#</a></h4>
<p>We can define geochemical constraint as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;geochemical conditions&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_ENTIRE DOMAIN}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="initialization-from-exodus-ii-file">
<h3><a class="toc-backref" href="#id46" role="doc-backlink">Initialization from Exodus II file</a><a class="headerlink" href="#initialization-from-exodus-ii-file" title="Link to this heading">#</a></h3>
<p>Some fields can be initialized from Exodus II files.
For each field, an additional sublist has to be added to the
named sublist of <em>State</em> list with the file name and the name of attributes.
For a serial run, the file extension must be <em>.exo</em>.
For a parallel run, it must be <em>.par</em>.</p>
<ul class="simple">
<li><p><cite>“attributes</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> defines names of attributes. The number of names
must be equal to the number of components in the field. The names can be repeated.
Scalar fields (e.g. porosity) require one name, tensorial fields (e.g. permeability)
require two or three names.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;permeability&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;exodus file initialization&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_MESH_AND_DATA.exo&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;attributes&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{permx, permx, permz}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="initialization-from-hdf5-file">
<h3><a class="toc-backref" href="#id47" role="doc-backlink">Initialization from HDF5 file</a><a class="headerlink" href="#initialization-from-hdf5-file" title="Link to this heading">#</a></h3>
<p>Some field can be initialized from HDF5 file. The field has to written
to HDF5 file as 2D array (number_elements, number_of_components) and
has to name as field_name.entity.component, e.g
transport_porosity.cell.0. Parameter <cite>“cell from file</cite>” initializes
only cell part of the field.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;transport_porosity&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;restart file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_TEST1.h5&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;porosity&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cells from file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_TEST3.h5&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="initialization-of-1d-column">
<h3><a class="toc-backref" href="#id48" role="doc-backlink">Initialization of 1D column</a><a class="headerlink" href="#initialization-of-1d-column" title="Link to this heading">#</a></h3>
<p>It is possible to initialize only 1D column portion of a particular field.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;temperature&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initialize from 1D column&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_COLUMN_DATA.h5&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;z header&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;/z&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;f header&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;/temperature&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;coordinate orientation&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;depth&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;surface sideset&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;surface&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="mesh-partitioning">
<h3><a class="toc-backref" href="#id49" role="doc-backlink">Mesh partitioning</a><a class="headerlink" href="#mesh-partitioning" title="Link to this heading">#</a></h3>
<p>Amanzi’s state has a number of tools to verify completeness of initial data.
This is done using list <em>mesh partitions</em>.
Each sublist must have parameter <em>region list</em> specifying
regions that define unique partition of the mesh.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;state&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mesh partitions&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_MATERIALS&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region list&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_SAND1,_CLAY,_SAND2}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, we verify that three mesh regions representing sand and clay cover completely
the mesh without overlaps.
If so, all material fields, such as <em>porosity</em> and <em>permeability</em>, will be initialized properly.</p>
</section>
<section id="data-io-control">
<h3><a class="toc-backref" href="#id50" role="doc-backlink">Data IO control</a><a class="headerlink" href="#data-io-control" title="Link to this heading">#</a></h3>
<p>Two parameters below allow us to control fields that will go into a visualization file.
First, we remove all fields matching the patterns specified by <em>blacklist</em>.
Second, we add all fields matching the patterns specified by <em>whitelist</em>.
Both parameters are optional.</p>
<ul class="simple">
<li><p><cite>“blacklist</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> list of fields that should <em>not</em> be written to the visualization file.
Standard regular expression rules can be used, e.g. <cite>“(secondary_)(.*)</cite>” skips all fields
those names start with <cite>“secondary_</cite>”.</p></li>
<li><p><cite>“whitelist</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> list of fields that should <em>be</em> written to the visualization file.
Standard regular expression rules can be used, e.g. <cite>“(primary_)(.*)</cite>” adds all fields
those names start with <cite>“primary_</cite>”.</p></li>
</ul>
</section>
<section id="example">
<h3><a class="toc-backref" href="#id51" role="doc-backlink">Example</a><a class="headerlink" href="#example" title="Link to this heading">#</a></h3>
<p>The complete example of a state initialization is below. Note that
_MATERIAL1 and _MATERIAL2 must be labels of the existing regions that cover
the computational domain.
The fields <em>porosity</em> and <em>pressure</em> are constant over the whole domain.
The field <em>permeability</em> is the piecewise constant diagonal tensor.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;state&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;field evaluators&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;porosity&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_ANY NAME &quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_ALL DOMAIN}&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;component&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.408&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>

<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;fluid_density&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;998.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0.0, -9.81}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pressure&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_ANY NAME&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_ALL DOMAIN}&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;component&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;90000.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;permeability&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_ANY NAME&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_MATERIAL1&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;component&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;composite function&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of dofs&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dof 1 function&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">              </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-12&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dof 2 function&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">              </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-13&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_ANY_NAME&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_MATERIAL2&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;component&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;composite function&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of dofs&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dof 1 function&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">              </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2e-13&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dof 2 function&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">              </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2e-14&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="process-kernels-pks">
<h2><a class="toc-backref" href="#id52" role="doc-backlink">PROCESS KERNELS (PKs)</a><a class="headerlink" href="#process-kernels-pks" title="Link to this heading">#</a></h2>
<p>A process kernel represents a single or system of partial/ordinary
differential equation(s) or conservation law(s), and is used as the
fundamental unit for coupling strategies.</p>
<p>Implementations of this interface typically are either an MPC
(multi-process coupler) whose job is to heirarchically couple several
other PKs and represent the system of equations, or a Physical PK,
which represents a single equation.</p>
<p>Note there are two PK specs – the first is the “typed” spec, which appears in
the “cycle driver” list in the PK tree and has no other parameters other than
its type and its children.  The second is the spec for the base class PK, which
is inherited and included by each actual PK, lives in the “PKs” sublist of
“main”, and has all needed parameters.</p>
<div class="admonition-pk-spec admonition" id="pk-typed-spec">
<span id="pk-spec"></span><p class="admonition-title">pk-spec</p>
<ul class="simple">
<li><p><cite>“PK type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> One of the registered PK types.  Note this must
match the corresponding entry in the <code class="docutils literal notranslate"><span class="pre">[pk-typed-spec]</span></code></p></li>
<li><p><cite>“verbose object</cite>” <code class="docutils literal notranslate"><span class="pre">[verbose-object-spec]</span></code> <strong>optional</strong> See <a class="reference internal" href="#verbose-object">Verbose Object</a></p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK tree&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;my cool MPC PK&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;my cool MPC PK&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;sub PK 1&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;sub PK 2&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span>...
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="base-pks">
<h2><a class="toc-backref" href="#id53" role="doc-backlink">BASE PKs</a><a class="headerlink" href="#base-pks" title="Link to this heading">#</a></h2>
<p>There are several types of PKs, and each PK has its own valid input spec.
However, there are three main types of PKs, from which nearly all PKs derive.
Note that none of these are true PKs and cannot stand alone.</p>
<section id="pk-physical">
<h3><a class="toc-backref" href="#id54" role="doc-backlink">PK_Physical</a><a class="headerlink" href="#pk-physical" title="Link to this heading">#</a></h3>
<p>Physical PKs represent the physics capability implemented within Amanzi.</p>
<div class="admonition-pks-typed-spec admonition">
<p class="admonition-title">pks-typed-spec</p>
<ul class="simple">
<li><p><cite>“darcy</cite>” See <a class="reference internal" href="#pk-flow">PK: Flow</a></p></li>
<li><p><cite>“richards</cite>” See <a class="reference internal" href="#pk-flow">PK: Flow</a></p></li>
<li><p><cite>“transport</cite>” See <a class="reference internal" href="#pk-transport">PK: Transport</a></p></li>
<li><p><cite>“transport implicit</cite>” See <a class="reference internal" href="#pk-transport">PK: Transport</a></p></li>
<li><p><cite>“one-phase energy</cite>” See <a class="reference internal" href="#pk-energy">PK: Energy</a></p></li>
<li><p><cite>“chemistry alquimia</cite>” See <a class="reference internal" href="#pk-chemistry-alquimia">PK: Chemistry Alquimia</a></p></li>
<li><p><cite>“chemistry amanzi</cite>” See <a class="reference internal" href="#pk-chemistry-amanzi">PK: Chemistry Amanzi</a></p></li>
<li><p><cite>“shallow water</cite>” See <a class="reference internal" href="#pk-shallow-water">PK: Shallow Water</a></p></li>
<li><p><cite>“navier stokes</cite>” See <a class="reference internal" href="#pk-navier-stokes">PK: Navier-Stokes</a></p></li>
<li><p><cite>“multiphase</cite>” See <a class="reference internal" href="#pk-multiphase">PK: Multiphase</a></p></li>
<li><p><cite>“mechanics</cite>” See <a class="reference internal" href="#pk-mechanics">PK: Mechanics</a></p></li>
</ul>
</div>
</section>
<section id="pk-bdf">
<h3><a class="toc-backref" href="#id55" role="doc-backlink">PK_BDF</a><a class="headerlink" href="#pk-bdf" title="Link to this heading">#</a></h3>
<p>This is a base class from which PKs that want to use the <cite>BDF</cite> series
of implicit time integrators must derive.  It specifies both the
<cite>BDFFnBase</cite> interface and implements some basic functionality for <cite>BDF</cite> PKs.</p>
</section>
<section id="pk-physicalbdf">
<h3><a class="toc-backref" href="#id56" role="doc-backlink">PK_PhysicalBDF</a><a class="headerlink" href="#pk-physicalbdf" title="Link to this heading">#</a></h3>
<p>A base class for all PKs that are both physical, in the sense that they
implement an equation and are not couplers, and BDF, in the sense that they
support the implicit integration interface.  This largely just supplies a
default error norm based on error in conservation relative to the extent of the
conserved quantity.</p>
<p>By default, the error norm used by solvers is given by:</p>
<div class="math notranslate nohighlight">
\[ENORM(u, du) = |du| / ( a_{tol} + r_{tol} * |u| )\]</div>
<p>The defaults here are typically good, or else good defaults are set in the
code, so usually are not supplied by the user.</p>
</section>
<section id="pk-domainfunction">
<h3><a class="toc-backref" href="#id57" role="doc-backlink">PK_DomainFunction</a><a class="headerlink" href="#pk-domainfunction" title="Link to this heading">#</a></h3>
<p>Prototype class for computing boundary and source terms. PK’s classes
for source and boundary terms may inherit from this class or mimic
its functionality.</p>
<section id="simple-function">
<h4>Simple function<a class="headerlink" href="#simple-function" title="Link to this heading">#</a></h4>
<p>To be written.</p>
</section>
<section id="coupling-function">
<h4>Coupling function<a class="headerlink" href="#coupling-function" title="Link to this heading">#</a></h4>
<p>This provides coupling of fields located on conforming manifold and 3D meshes.
For the 3D mesh, the coupling generates a list of boundary conditions.
For the manifold mesh, the coupling creates a list of sources. The manifold
mesh has a child to parent map, e.g. a manifold cell to a 3D mesh face.
For the 3D mesh, we need the reverse map.
There are a few coupling submodels:</p>
<blockquote>
<div><ul>
<li><p><cite>“rate</cite>” computes data using the following formulas:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
  value[i][c] = value[i][c] + flux[f] * external\_field[i][cc] / V_c \\
  value[N][c] = value[N][c] - \Delta t * flux[f]
\end{array}\end{split}\]</div>
<p>where cc is a space cell incident to face f, and N is the auxiliary
value added to the result. Note that an internal face f (resp., boundary
face f) is shared by two (resp. one) space cells.</p>
</li>
<li><p><cite>“field</cite>” computes data using the following formula:</p>
<div class="math notranslate nohighlight">
\[value[i][f] = external\_field[i][c]\]</div>
</li>
<li><p><cite>“conserved quantity</cite>” is <strong>not</strong> used in Amanzi.</p></li>
</ul>
</div></blockquote>
</section>
<section id="weight-function">
<h4>Weight function<a class="headerlink" href="#weight-function" title="Link to this heading">#</a></h4>
<p>The total source Q is given for each domain. A weighted source
distribution model is employed. The cell-based source density is
calculated as (Q / W_D) * weight, where W_D is the weighted
domain volume. The weight is defined globally, for the whole
computational domain.</p>
</section>
<section id="field-function">
<h4>Field function<a class="headerlink" href="#field-function" title="Link to this heading">#</a></h4>
<p>This leverages the Arcos DAG to evaluate a user-provided field and use that in
the domain function.</p>
<div class="admonition-domain-function-field-spec admonition">
<p class="admonition-title">domain-function-field-spec</p>
<ul class="simple">
<li><p><cite>“field key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Field used in the domain function.</p></li>
<li><p><cite>“component</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Component of the field. Default is <cite>“cell</cite>”.</p></li>
<li><p><cite>“scaling factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Constant multiplication factor. Default is 1.</p></li>
</ul>
</div>
</section>
</section>
</section>
<section id="physics-pks">
<h2><a class="toc-backref" href="#id58" role="doc-backlink">PHYSICS PKs</a><a class="headerlink" href="#physics-pks" title="Link to this heading">#</a></h2>
<p>Each PK represents a single physical process implemented within Amanzi
such as mass transport, solute transport and dispersion, energy transport,
rock deformation, and chemical reactions.</p>
<section id="flow-pk">
<span id="pk-flow"></span><h3><a class="toc-backref" href="#id59" role="doc-backlink">Flow PK</a><a class="headerlink" href="#flow-pk" title="Link to this heading">#</a></h3>
<section id="mathematical-models">
<h4>Mathematical models<a class="headerlink" href="#mathematical-models" title="Link to this heading">#</a></h4>
<p>A few PDE models can be instantiated using the parameters described below.</p>
<section id="fully-saturated-flow">
<h5>Fully saturated flow<a class="headerlink" href="#fully-saturated-flow" title="Link to this heading">#</a></h5>
<p>The conceptual PDE model for the fully saturated flow is</p>
<div class="math notranslate nohighlight">
\[\left(\frac{S_s}{g} + \frac{S_y}{Lg}\right)\frac{\partial p_l}{\partial t}
=
-\boldsymbol{\nabla} \cdot (\rho_l \boldsymbol{q}_l) + Q,
\quad
\boldsymbol{q}_l
= -\frac{\boldsymbol{K}}{\mu}
(\boldsymbol{\nabla} p - \rho_l \boldsymbol{g}),\]</div>
<p>where
<span class="math notranslate nohighlight">\(S_s\)</span> and <span class="math notranslate nohighlight">\(S_y\)</span> are specific storage [1/m] and specific yield [-], respectively,
<span class="math notranslate nohighlight">\(L\)</span> is characteristic length [m],
<span class="math notranslate nohighlight">\(\rho_l\)</span> is fluid density [<span class="math notranslate nohighlight">\(kg / m^3\)</span>],
<span class="math notranslate nohighlight">\(Q\)</span> is source or sink term [<span class="math notranslate nohighlight">\(kg / m^3 / s\)</span>],
<span class="math notranslate nohighlight">\(\boldsymbol{q}_l\)</span> is the Darcy velocity [<span class="math notranslate nohighlight">\(m/s\)</span>],
and <span class="math notranslate nohighlight">\(\boldsymbol{g}\)</span> is gravity [<span class="math notranslate nohighlight">\(m/s^2\)</span>].
The specific storgae can be defined using</p>
<div class="math notranslate nohighlight">
\[S_s = \left(\phi\, \beta_f + \beta_m\right)\rho_l\,g\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta_f\)</span> [1/Pa] and <span class="math notranslate nohighlight">\(\beta_m\)</span> [1/Pa] are fluid and matrix compressibilities, respectively.</p>
</section>
<section id="partially-saturated-flow-with-water-vapor">
<h5>Partially saturated flow with water vapor<a class="headerlink" href="#partially-saturated-flow-with-water-vapor" title="Link to this heading">#</a></h5>
<p>The conceptual PDE model for the partially saturated flow with water vapor
includes liquid phase (liquid water) and gas phase (water vapor):</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \theta}{\partial t}
=
- \boldsymbol{\nabla} \cdot (\eta_l \boldsymbol{q}_l)
- \boldsymbol{\nabla} \cdot (\boldsymbol{K}_g \boldsymbol{\nabla} \big(\frac{p_v}{p_g}\big)) + Q,
\quad
\boldsymbol{q}_l
= -\frac{\boldsymbol{K} k_r}{\mu}
(\boldsymbol{\nabla} p - \rho_l \boldsymbol{g})\]</div>
<p>where
<span class="math notranslate nohighlight">\(\theta\)</span> is total water storage [<span class="math notranslate nohighlight">\(mol/m^3\)</span>],
<span class="math notranslate nohighlight">\(\eta_l\)</span> is molar density of liquid (water) [<span class="math notranslate nohighlight">\(mol/m^3\)</span>],
<span class="math notranslate nohighlight">\(\rho_l\)</span> is fluid density [<span class="math notranslate nohighlight">\(kg/m^3\)</span>],
<span class="math notranslate nohighlight">\(Q\)</span> is source or sink term [<span class="math notranslate nohighlight">\(mol/m^3/s\)</span>],
<span class="math notranslate nohighlight">\(\boldsymbol{q}_l\)</span> is the Darcy velocity [<span class="math notranslate nohighlight">\(m/s\)</span>],
<span class="math notranslate nohighlight">\(k_r\)</span> is relative permeability [-],
<span class="math notranslate nohighlight">\(\boldsymbol{g}\)</span> is gravity [<span class="math notranslate nohighlight">\(m/s^2\)</span>],
<span class="math notranslate nohighlight">\(p_v\)</span> is the vapor pressure [Pa],
<span class="math notranslate nohighlight">\(p_g\)</span> is the gas pressure [Pa],
and <span class="math notranslate nohighlight">\(\boldsymbol{K}_g\)</span> is the effective diffusion coefficient of the water vapor.
We define</p>
<div class="math notranslate nohighlight">
\[\theta = \phi \eta_l s_l + \phi \eta_g (1 - s_l) X_g\]</div>
<p>where <span class="math notranslate nohighlight">\(s_l\)</span> is liquid saturation [-],
<span class="math notranslate nohighlight">\(\phi\)</span> is porosity [-],
<span class="math notranslate nohighlight">\(\eta_g\)</span> is molar density of water vapor [<span class="math notranslate nohighlight">\(mol/m^3\)</span>],
and <span class="math notranslate nohighlight">\(X_g\)</span> is molar fraction of water vapor.
The effective diffusion coefficient of the water vapor is given by</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{K}_g = \phi s_g \tau_g \eta_g \boldsymbol{D}_g\]</div>
<p>where <span class="math notranslate nohighlight">\(s_g\)</span> is gas saturation [-],
<span class="math notranslate nohighlight">\(\tau_g\)</span> is the tortuosity of the gas phase [-],
<span class="math notranslate nohighlight">\(\eta_g\)</span> is the molar density of gas [<span class="math notranslate nohighlight">\(kg/m^3\)</span>],
and <span class="math notranslate nohighlight">\(\boldsymbol{D}_g\)</span> is the diffusion coefficient of the gas phase [<span class="math notranslate nohighlight">\(m^2/s\)</span>],
The gas pressure <span class="math notranslate nohighlight">\(p_g\)</span> is set to the atmosperic pressure and the vapor pressure
model assumes thermal equlibrium of liquid and gas phases:</p>
<div class="math notranslate nohighlight">
\[p_v = P_{sat}(T) \exp\left(\frac{P_{cgl}}{\eta_l R T}\right)\]</div>
<p>where
<span class="math notranslate nohighlight">\(R\)</span> is the ideal gas constant [<span class="math notranslate nohighlight">\(kg m^2/K/mol/s^2\)</span>],
<span class="math notranslate nohighlight">\(P_{cgl}\)</span> is the liquid-gas capillary pressure [Pa],
<span class="math notranslate nohighlight">\(P_{sat}\)</span> is the saturated vapor pressure [Pa],
and <span class="math notranslate nohighlight">\(T\)</span> is the temperature [K].
The diffusion coefficient is based of TOUGHT2 model</p>
<div class="math notranslate nohighlight">
\[D_g = D_0 \frac{P_{ref}}{p} \left(\frac{T}{273.15}\right)^a\]</div>
<p>where
<span class="math notranslate nohighlight">\(D_0 = 2.14 \cdot 10^{-5}\)</span>,
<span class="math notranslate nohighlight">\(P_{ref}\)</span> is atmospheric pressure,
and <span class="math notranslate nohighlight">\(a = 1.8\)</span>.
finally we need a model for the gas tortuosity. We use the Millington and Quirk model:</p>
<div class="math notranslate nohighlight">
\[\tau_g = \phi^\beta s_g^\gamma\]</div>
<p>where
<span class="math notranslate nohighlight">\(\beta = 1/3\)</span> and
<span class="math notranslate nohighlight">\(\gamma = 7/3\)</span>.</p>
</section>
<section id="isothermal-partially-saturated-flow-with-dual-porosity-model">
<h5>Isothermal partially saturated flow with dual porosity model<a class="headerlink" href="#isothermal-partially-saturated-flow-with-dual-porosity-model" title="Link to this heading">#</a></h5>
<p>The conceptual model for the partially saturated flow with dual porosity model
assumes that water flow is restricted to the fractures and the water in the matrix does not move.
The rock matrix represents immobile pockets that can exchange, retain and store water
but do not permit convective flow.
This leads to dual-porosity type flow and transport models that partition the liquid
phase into mobile and immobile regions.
The Richards equation in the mobile region is augmented by the water exchange
term <span class="math notranslate nohighlight">\(\Sigma_w\)</span>:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \theta_{lf}}{\partial t}
= -\boldsymbol{\nabla} \cdot (\eta_l \boldsymbol{q}_l)
  -\frac{K_m\,k_{rm}\,\eta_l}{\mu\,L_m}\, \nabla p_m + Q_f,
\qquad
\boldsymbol{q}_l
= -\frac{\boldsymbol{K}_f\, k_{rf}}{\mu}
(\boldsymbol{\nabla} p_f - \rho_l \boldsymbol{g})\]</div>
<p>where
<span class="math notranslate nohighlight">\(p_f\)</span> is fracture pressure [Pa],
<span class="math notranslate nohighlight">\(p_m\)</span> is matrix pressure [Pa],
<span class="math notranslate nohighlight">\(L_m\)</span> is the characteristic matrix depth defined typically as the ratio of a matrix block [m],
and <span class="math notranslate nohighlight">\(Q_f\)</span> is source or sink term [<span class="math notranslate nohighlight">\(kg \cdot m^{-3} \cdot s^{-1}\)</span>].
The equation for water balance in the matrix is</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \theta_{lm}}{\partial t}
= Q_m
  +\nabla\cdot \left(\frac{K_m\, k_{rm}\,\eta_l}{\mu}\, \nabla p_{m}\right),\]</div>
<p>where
<span class="math notranslate nohighlight">\(Q_m\)</span> is source or sink term [<span class="math notranslate nohighlight">\(kg / m^3 / s\)</span>].
The water storages are defined as</p>
<div class="math notranslate nohighlight">
\[\theta_f = \phi_f\, \eta_l\, s_{lf},\quad
\theta_m = \phi_m\, \eta_l\, s_{lm},\]</div>
<p>where saturations <span class="math notranslate nohighlight">\(s_{lf}\)</span> and <span class="math notranslate nohighlight">\(s_{lm}\)</span> may use different capillary
pressure - saturation models.
In the simplified model, the rate of water exchange between the fracture and matrix regions
is proportional to the difference in hydraulic heads:</p>
<div class="math notranslate nohighlight">
\[\frac{K_m\,k_{rm}\,\eta_l}{\mu\,L_m}\, \nabla p_m
\approx
\alpha_w (h_f - h_m),\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha_w\)</span> is the mass transfer coefficient.
Since hydraulic heads are needed for both regions, this equation requires
retention curves for both regions and therefore is nonlinear.</p>
</section>
</section>
<section id="physical-models-and-assumptions">
<h4>Physical models and assumptions<a class="headerlink" href="#physical-models-and-assumptions" title="Link to this heading">#</a></h4>
<p>This list is used to summarize physical models and assumptions, such as
coupling with other PKs.
This list is often generated or extended by a high-level MPC PK.
In the code development, this list plays a two-fold role.
First, it provides necessary information for coupling different PKs such
as flags for adding a vapor diffusion to Richards’ equation.
Second, the developers may use it instead of a factory of evaluators such as
creation of primary and secondary evaluators for rock porosity models.
Combination of both approaches may lead to a more efficient code.</p>
<div class="admonition-flow-assumptions-spec admonition">
<p class="admonition-title">flow_assumptions-spec</p>
<ul class="simple">
<li><p><cite>“vapor diffusion</cite>” [bool] is set up automatically by a high-level PK,
e.g. by EnergyFlow PK. The default value is <cite>“false</cite>”.</p></li>
<li><p><cite>“flow and transport in fractures</cite>” [bool] indicates that Darcy flow is calculated in fractures.
This option is ignored is mesh dimentionaly equals to manifold dimensionality.</p></li>
<li><p><cite>“multiscale model</cite>” [string] specifies a multiscale model.
Available options are <cite>“single porosity</cite>” (default) and <cite>“dual continuum discontinum matrix</cite>”.</p></li>
<li><p><cite>“viscosity model</cite>” [string] changes the evaluator for liquid viscosity.
Available options are <cite>“generic</cite>” and <cite>“constant viscosity</cite>” (default).</p></li>
<li><p><cite>“porosity model</cite>” [string] specifies an isothermal porosity model.
Available options are <cite>“compressible</cite>” and <cite>“constant</cite>” (default).</p></li>
<li><p><cite>“coupled matrix fracture flow</cite>” [string] specifies PK’s role in the strong
coupling of two flow PKs. The value is either <cite>“matrix</cite>” or <cite>“fracture</cite>”.</p></li>
<li><p><cite>“eos lookup table</cite>” [string] provides the name for optional EOS lookup table.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flow&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;physical models and assumptions&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;vapor diffusion&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;viscosity model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;constant viscosity&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;porosity model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;compressible&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;multiscale model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;single porosity&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;coupled matrix fracture flow&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;matrix&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;eos lookup table&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;h2o.eos&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="global-parameters">
<h4>Global parameters<a class="headerlink" href="#global-parameters" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><cite>“domain name</cite>” [string] specifies mesh name that defined domain of this PK.
Default is <cite>“domain</cite>”.</p></li>
</ul>
</section>
<section id="water-retention-models">
<h4>Water retention models<a class="headerlink" href="#water-retention-models" title="Link to this heading">#</a></h4>
<p>User defines water retention models in sublist <em>water retention models</em>.
It contains as many sublists, e.g. <em>SOIL_1</em>, <em>SOIL_2</em>, etc, as there are different soils.
This list is required for the Richards problem only.</p>
<p>The water retention models are associated with non-overlapping regions. Each of the sublists (e.g. <em>Soil 1</em>)
includes a few mandatory parameters: region name, model name, and parameters for the selected model.</p>
<div class="admonition-wrm-spec admonition">
<p class="admonition-title">wrm-spec</p>
<ul class="simple">
<li><p><cite>“water retention model</cite>” [string] specifies a model for the soil.
The available models are <cite>“van Genuchten</cite>”, <cite>“Brooks Corey</cite>”, and <cite>“fake</cite>”.
The later is used only to set up a simple analytic solution for convergence study.</p>
<ul>
<li><p>The model <cite>“van Genuchten</cite>” requires <cite>“van Genuchten alpha</cite>” [double],
<cite>“van Genuchten m</cite>” [double], <cite>“van Genuchten l</cite>” [double], <cite>“residual saturation liquid</cite>” [double],
and <cite>“relative permeability model</cite>” [string].</p></li>
<li><p>The model <cite>“Brooks-Corey</cite>” requires <cite>“Brooks Corey lambda</cite>” [double], <cite>“Brooks Corey alpha</cite>” [double],
<cite>“Brooks Corey l</cite>” [double], <cite>“residual saturation liquid</cite>” [double],
and <cite>“relative permeability model</cite>” [string].</p></li>
<li><p>The model <cite>“saturated</cite>” does not require any parameters. It is equaivalent to the Darcy model if
all other parameters (e.g. porosity) are constant</p></li>
<li><p>The model <cite>“linear</cite>” requires <cite>“alpha</cite>” [double] and <cite>“residual saturation liquid</cite>” [double].</p></li>
</ul>
</li>
<li><p><cite>“relative permeability model</cite>” [string] The available options are <cite>“Mualem</cite>” (default)
and <cite>“Burdine</cite>”.</p></li>
<li><p><cite>“regularization interval</cite>” [double] removes the kink in the water retention curve at the
saturation point using a cubic spline. The parameter specifies the regularization region [Pa].
Default value is 0.</p></li>
</ul>
</div>
<p>Amanzi performs rudimentary checks of validity of the provided parameters.
The relative permeability curves can be calculated and saved in an ASCI file
if the list <em>output</em> is provided. This list has two mandatory parameters:</p>
<ul class="simple">
<li><p><cite>“file</cite>” [string] is the user defined file name. It should be different for
each soil.</p></li>
<li><p><cite>“number of points</cite>” [int] is the number of data points.
Each file will contain a table with three columns: saturation, relative permeability, and
capillary pressure. The data points are equidistributed between the residual saturation
and 1.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flow&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;water retention models&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_SOIL_1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_TOP}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;water retention model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;van Genuchten&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;van Genuchten alpha&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.000194&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;van Genuchten m&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.28571&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;van Genuchten l&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.5&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;residual saturation liquid&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.103&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regularization interval&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;100.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;relative permeability model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Mualem&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;output&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;soil1.txt&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of points&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1000&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_SOIL_2&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_BOTTOM}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;water retention model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Brooks Corey&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Brooks Corey lambda&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0014&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Brooks Corey alpha&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.000194&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Brooks Corey l&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.51&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;residual saturation liquid&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.103&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regularization interval&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;relative permeability model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Burdine&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_SOIL_3&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_MIDDLE}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;alpha&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;5e-5&quot;</span><span class="nt">/&gt;</span><span class="w">  </span><span class="cm">&lt;!-- Pa^-1 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;residual saturation liquid&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.02&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, we define three different water retention models in three soils.</p>
</section>
<section id="porosity-models">
<h4>Porosity models<a class="headerlink" href="#porosity-models" title="Link to this heading">#</a></h4>
<p>User defines porosity models in sublist <em>porosity models</em>.
It contains as many sublists, e.g. _SOIL1 and _SOIL2, as there are different soils.
The porosity models are associated with non-overlapping regions. Each of the sublists (e.g. _SOIL1)
includes a few mandatory parameters: <em>regions names</em>, <em>model name</em>, and parameters for the selected model.</p>
<div class="admonition-porosity-model-spec admonition">
<p class="admonition-title">porosity_model-spec</p>
<ul>
<li><p><cite>“porosity model</cite>” [string] specifies a model for the soil.
The available models are <cite>“compressible</cite>” and <cite>“constant</cite>”.</p>
<ul>
<li><p>The model <cite>“compressible</cite>” requires mandatory parameters:</p>
<ul class="simple">
<li><p><cite>“underformed soil porosity”</cite>” [double]</p></li>
<li><p><cite>“reference pressure</cite>” [double]. Default value is 101325.0 Pa.</p></li>
<li><p><cite>“pore compressibility</cite>” [double] [Pa^-1]</p></li>
</ul>
<p>Additional physics introduces more parameters:</p>
<ul class="simple">
<li><p><cite>“Biot coefficient</cite>” [double] [-]</p></li>
<li><p><cite>“volumetric thermal dilation</cite>” [double] [K^-1]</p></li>
<li><p><cite>“reference temperature</cite>” [double] [K]. Default value is 20 C.</p></li>
</ul>
</li>
<li><p>The model <cite>“constant</cite>” requires <cite>“value</cite>” [double].</p></li>
</ul>
</li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flow&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;porosity models&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_SOIL1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_TOP HALF}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;porosity model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;constant&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.2&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_SOIL2&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_BOTTOM HALF}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;porosity model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;compressible&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;underformed soil porosity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.2&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reference pressure&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;101325.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pore compressibility&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-8&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, we define two different porosity models in two soils.</p>
</section>
<section id="multiscale-continuum-models">
<h4>Multiscale continuum models<a class="headerlink" href="#multiscale-continuum-models" title="Link to this heading">#</a></h4>
<p>The list <em>multiscale models</em> is the place for various multiscale models.
The list is extension of the list <em>water retention models</em>.
Its ordered by soil regions and includes parameters for the multiscale,
capillary pressure, and relative permebility models.
This list is optional.</p>
<div class="admonition-multiscale-porosity-spec admonition">
<p class="admonition-title">multiscale_porosity-spec</p>
<ul class="simple">
<li><p><cite>“multiscale model</cite>” [string] is the model name. Available options are <cite>“dual porosity</cite>”
and <cite>“generalized dual porosity</cite>”.</p></li>
<li><p><cite>“xxx parameters</cite>” [sublist] provides parameters for the model specified by variable <cite>“multiscale model</cite>”.</p></li>
<li><p><cite>“water retention model</cite>” [string] specifies a model for the soil.
The available models are <cite>“van Genuchten</cite>” and <cite>“Brooks Corey</cite>”.
Parameters for each model are described above.</p></li>
<li><p><cite>“relative permeability model</cite>” [string] The available options are <cite>“Mualem</cite>” (default)
and <cite>“Burdine</cite>”.</p></li>
</ul>
</div>
<section id="dual-porosity-model">
<h5>Dual porosity model<a class="headerlink" href="#dual-porosity-model" title="Link to this heading">#</a></h5>
<p>A two-scale porosity model (fracture + matrix) aka dual porosity
model. Current naming convention is that the fields used in the
single-porosity model correspond now to the fracture continuum.
Example: pressure = pressure in the fracture continuum;
pressure_msp = pressure in the matrix continuum.</p>
<div class="admonition-dual-porosity-spec admonition">
<p class="admonition-title">dual_porosity-spec</p>
<ul class="simple">
<li><p><cite>“mass transfer coefficient</cite>” [double] is the mass transfer coefficient.</p></li>
<li><p><cite>“tolerance</cite>” [double] defines tolerance for iterative methods used to solve
secondary equations. Default is 1e-8.</p></li>
</ul>
</div>
</section>
<section id="generalized-dual-porosity-model">
<h5>Generalized dual porosity model<a class="headerlink" href="#generalized-dual-porosity-model" title="Link to this heading">#</a></h5>
<p>A two-scale porosity model (fracture + matrix) aka dual porosity
model. Current naming convention is that the fields used in the
single-porosity model correspond now to the fracture continuum.
Example: pressure = pressure in the fracture continuum;
pressure_msp = pressure in the matrix continuum.</p>
<div class="admonition-generalized-dual-porosity-spec admonition">
<p class="admonition-title">generalized_dual_porosity-spec</p>
<ul class="simple">
<li><p><cite>“number of matrix nodes</cite>” [int] defines number of matrix layers.</p></li>
<li><p><cite>“matrix depth</cite>” [double] is the characteristic length for matrix continuum.</p></li>
<li><p><cite>“matrix volume fraction</cite>” [double] defines relative volume of matrix continuum.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flow&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;multiscale models&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_SOIL1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_TOP HALF}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;multiscale model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;dual porosity&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dual porosity parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Paramater</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mass transfer coefficient&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;4e-5&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Paramater</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-8&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;water retention model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;van Genuchten&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;van Genuchten alpha&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.000194&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;van Genuchten m&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.28571&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;van Genuchten l&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.5&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;residual saturation&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.103&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;relative permeability model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Mualem&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="permeability">
<h4>Permeability<a class="headerlink" href="#permeability" title="Link to this heading">#</a></h4>
<p>The available options are</p>
<div class="admonition-permeability-spec admonition">
<p class="admonition-title">permeability-spec</p>
<ul class="simple">
<li><p><cite>“coordinate system</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines coordinate system
for calculating absolute permeability. The available options are <cite>“cartesian</cite>”
and <cite>“layer</cite>”.</p></li>
<li><p><cite>“off-diagonal components</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> defines additional (typically off-diagonal)
components of the absolute permeability. Default is 0.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flow&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;absolute permeability&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;coordinate system&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cartesian&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;off-diagonal components&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>** DOC GENERATION ERROR: file not found ‘ Permeability ‘ **</p>
<section id="kozeny-carman">
<h5>Kozeny-Carman<a class="headerlink" href="#kozeny-carman" title="Link to this heading">#</a></h5>
<p>** DOC GENERATION ERROR: file not found ‘ Permeability_KozenyCarman ‘ **</p>
</section>
<section id="power-law">
<h5>Power law<a class="headerlink" href="#power-law" title="Link to this heading">#</a></h5>
<p>** DOC GENERATION ERROR: file not found ‘ Permeability_PowerLaw ‘ **</p>
</section>
</section>
<section id="relative-permeability">
<h4>Relative permeability<a class="headerlink" href="#relative-permeability" title="Link to this heading">#</a></h4>
<p>This section discusses interface treatment of cell-centered fields such as
relative permeability, density and viscosity.</p>
<div class="admonition-rel-perm-spec admonition">
<p class="admonition-title">rel_perm-spec</p>
<ul class="simple">
<li><p><cite>“relative permeability</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> collects information required for treatment of
relative permeability, density and viscosity on mesh faces.</p>
<ul>
<li><p><cite>“upwind method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines a method for calculating the <em>upwinded</em>
relative permeability. The available options are: <cite>“upwind: gravity</cite>”,
<cite>“upwind: darcy velocity</cite>” (default), <cite>“upwind: second-order</cite>”, <cite>“upwind: amanzi</cite>” (experimental),
<cite>“upwind: amanzi new</cite>” (experiemental), <cite>“other: harmonic average</cite>”, and <cite>“other: arithmetic average</cite>”.</p></li>
<li><p><cite>“upwind frequency</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines frequency of recalculating Darcy flux inside
nonlinear solver. The available options are <cite>“every timestep</cite>” and <cite>“every nonlinear iteration</cite>”.
The first option freezes the Darcy flux for the whole time step. The second option
updates it on each iteration of a nonlinear solver. The second option is recommended
for the Newton solver. It may impact significantly upwinding of the relative permeability
and convergence rate of this solver.</p></li>
<li><p><cite>“upwind parameters</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines parameters for upwind method specified by <cite>“relative permeability</cite>”.</p>
<ul>
<li><p><cite>“tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> specifies relative tolerance for almost zero local flux. In such
a case the flow is assumed to be parallel to a mesh face. Default value is 1e-12.</p></li>
<li><p><cite>“method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies a reconstruction method. Available option is
<cite>“cell-based</cite>” (default).</p></li>
<li><p><cite>“polynomial order</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> defines the polynomial order of a reconstructed function. Default is 1.</p></li>
<li><p><cite>“limiter</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies limiting method for a high-order reconstruction.
Available options are <cite>“Barth-Jespersen</cite>” (default), <cite>“Michalak-Gooch</cite>”, <cite>“tensorial</cite>”,
and <cite>“Kuzmin</cite>”.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flow&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;relative permeability&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;upwind method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;upwind: darcy velocity&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;upwind frequency&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;every timestep&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;upwind parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-12&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell-based&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;polynomial order&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limiter&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Barth-Jespersen&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="fracture-permeability-models">
<h4>Fracture permeability models<a class="headerlink" href="#fracture-permeability-models" title="Link to this heading">#</a></h4>
<p>A list of permeability models in a fracture network contains similar sublists
that must cover all network.
Each sublist has two paremeters.</p>
<ul class="simple">
<li><p><cite>“region</cite>” [string] defines region where model applies.</p></li>
<li><p><cite>“model</cite>” [string] specifies the model name. Currently only one parameter
is available, <cite>“cubic law</cite>”.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flow&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;fracture permeability models&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_ONE FRACTURE LEAVE&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;fracture&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cubic law&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="diffusion-operators">
<h4>Diffusion operators<a class="headerlink" href="#diffusion-operators" title="Link to this heading">#</a></h4>
<p>List <em>operators</em> describes the PDE structure of the flow, specifies a discretization
scheme, and selects assembling schemas for matrices and preconditioners.</p>
<div class="admonition-diffusion-operator-spec admonition">
<p class="admonition-title">diffusion_operator-spec</p>
<ul class="simple">
<li><p><cite>“operators</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code></p>
<ul>
<li><p><cite>“diffusion operator</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines parameters for generating and assembling diffusion matrix.</p>
<ul>
<li><p><cite>“matrix</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines parameters for generating and assembling diffusion matrix. See section
describing operators.
When the Richards problem is set up, Flow PK sets up proper value for parameter <cite>“upwind method</cite>” of
this sublist.</p></li>
<li><p><cite>“preconditioner</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines parameters for generating and assembling diffusion
matrix that is used to create preconditioner.
This sublist is ignored for the saturated problem.
Since update of preconditioner can be lagged, we need two objects called <cite>“matrix</cite>” and <cite>“preconditioner</cite>”.
When the Richards problem is set up, Flow PK sets up proper value for parameter <cite>“upwind method</cite>” of
this sublist.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flow&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;operators&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;diffusion operator&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;matrix&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization primary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: optimized for monotonicity&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization secondary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: optimized for sparsity&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face, cell}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioner schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gravity term discretization&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;hydraulic head&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioner&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization primary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: optimized for monotonicity&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization secondary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: optimized for sparsity&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face, cell}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioner schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face, cell}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Newton correction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;approximate Jacobian&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>This example creates a p-lambda system, i.e. the pressure is
discretized in mesh cells and on mesh faces.
The preconditioner is defined on faces only, i.e. cell-based unknowns
are eliminated explicitly and the preconditioner is applied to the
Schur complement.</p>
</section>
<section id="boundary-conditions">
<h4>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Link to this heading">#</a></h4>
<p>Boundary conditions are defined in sublist <em>boundary conditions</em>.
Four types of boundary conditions are supported.
Each type has a similar structure: a list of identical elements that contain
information about a part of the boundary where it is prescribed, a function
to calculate it, and optional parameters to modify it slightly.
This modification is referred to as a submodel and requires additional parameters as described below.</p>
<div class="admonition-boundary-conditions-spec admonition">
<p class="admonition-title">boundary_conditions-spec</p>
<ul class="simple">
<li><p><cite>“pressure</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> is the Dirichlet boundary condition where the pressure is prescribed on a part of the
boundary surface. No submodels is available.</p></li>
<li><p><cite>“mass flux</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> is the Neumann boundary condition where an outward mass flux is prescribed on a
part of the boundary surface.
This is the default boundary condition. If no condition is specified on a mesh face, the zero flux
boundary condition is used.</p>
<ul>
<li><p><cite>“rainfall</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> indicates the submodel where the mass flux is defined with respect to the gravity
vector and the actual flux depends on the boundary slope. Default is <cite>“false</cite>”.</p></li>
</ul>
</li>
<li><p><cite>“static head</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> is the Dirichlet boundary condition where the hydrostatic pressure is prescribed
on a part of the boundary.</p>
<ul>
<li><p><cite>“relative to top</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> indicates the submodel where the static head is defined with respect
to the top boundary (a curve in 3D) of the specified regions. Support of 2D is turned off.
Default value is <cite>“false</cite>”.</p></li>
<li><p><cite>“relative to bottom</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> indicates the submodel where the static head is defined with respect
to the bottom boundary (a curve in 3D) of the specified regions. Support of 2D is turned off.
Default value is <cite>“false</cite>”.</p></li>
<li><p><cite>“no flow above water table</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> indicates the submodel where the no-flow boundary condition
has to be used above the water table. This switch uses the pressure value at a face
centroid. Default is <cite>“false</cite>”.</p></li>
</ul>
</li>
<li><p><cite>“seepage face</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> is the seepage face boundary condition, a dynamic combination of the <cite>“pressure</cite>” and
<cite>“mass flux</cite>” boundary conditions over the specified region.
The atmospheric pressure is prescribed if internal pressure is higher it.
Otherwise, the outward mass flux is prescribed.</p>
<ul>
<li><p><cite>“reference pressure</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defaults to the atmospheric pressure.</p></li>
<li><p><cite>“rainfall</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> indicates the submodel where the mass flux is defined with respect to the gravity
vector and the actual influx depends on the boundary slope. Default is <cite>“false</cite>”.</p></li>
<li><p><cite>“submodel</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> indicates different models for the seepage face boundary condition.
It can take values <cite>“PFloTran</cite>” and <cite>“FACT</cite>”. The first option leads to a
discontinuous change of the boundary condition type from the infiltration to pressure.
The second option is described in the document on mathematical models.
It employs a smooth transition from the infiltration
to mixed boundary condition. The recommended value is <cite>“PFloTran</cite>”.</p></li>
<li><p><cite>“seepage flux threshold</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> sets up the threshold for switching from the pressure
to influx boundary condition in submodel <cite>“PFloTran</cite>”. The pressure condition remains
for a small influx value until it exceeds the certain fraction of the <cite>“mass flux</cite>” specified
by this parameter. The admissible range is from 0 to 0.1. Default value is 0.</p></li>
</ul>
</li>
</ul>
</div>
<p>Each boundary condition accepts three parameters: <cite>“regions</cite>”,
<cite>“use area fractions</cite>”, and <cite>“spatial distribution method</cite>”. Parameter <cite>“regions</cite>”
specifies the list of regions where the boundary condition is defined.
The boolean parameter <cite>“use area fractions</cite>” instructs the code to use all available volume fractions.
Default value is <em>false</em>, it corresponds to <span class="math notranslate nohighlight">\(f=1\)</span> in the formulas below.
Parameter <cite>“spatial distribution method</cite>” defines the method for distributing
data (e.g. the total mass flux) over the specified regions. The available options
are <cite>“volume</cite>”, <cite>“permeability</cite>”, <cite>“domain coupling</cite>”, <cite>“subgrid</cite>”, <cite>“simple well</cite>”, or <cite>“none</cite>”.
For instance, for a given boundary function <span class="math notranslate nohighlight">\(g(x)\)</span>, these options correspond to
different boundary conditions for the Darcy velocity in the original PDE:</p>
<div class="math notranslate nohighlight">
\[{\boldsymbol q} \cdot {\boldsymbol n} = g(x)\, f\, \frac{1}{|B|},\quad\mbox{and}\quad
{\boldsymbol q} \cdot {\boldsymbol n} = g(x)\, f,\]</div>
<p>where <span class="math notranslate nohighlight">\(f\)</span> is the volume fraction function, and <span class="math notranslate nohighlight">\(|B|\)</span> is the area of the
specified regions calculated using the volume fraction function.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flow&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pressure&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_BC 0&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_WEST_SIDE}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial distribution method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;boundary pressure&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;101325.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mass flux&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_BC 1&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_NORTH_SIDE, _SOUTH_SIDE}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial distribution method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;volume&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;rainfall&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;outward mass flux&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;static head&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_BC 2&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_EAST_SIDE_TOP}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial distribution method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;relative to top&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;relative to bottom&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;static head&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-static-head&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;p0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;101325.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;density&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1000.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;9.8&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;space dimension&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;water table elevation&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">              </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;10.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;seepage face&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_BC 3&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_EAST_SIDE_BOTTOM}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial distribution method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;rainfall&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;submodel&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;PFloTran&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reference pressure&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;101325.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;outward mass flux&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>This example includes all four types of boundary conditions. The boundary of a square domain
is split into six pieces. Constant function is used for simplicity and can be replaced by any
of the other available functions.</p>
</section>
<section id="sources-and-sinks">
<h4>Sources and sinks<a class="headerlink" href="#sources-and-sinks" title="Link to this heading">#</a></h4>
<p>The sources and sinks are typically associated with wells.
Negative source means a producing well.
Positive source means an injecting well.
The structure of list <em>source terms</em> mimics that of list <em>boundary conditions</em>.
Again, constant functions can be replaced by any of the available functions.</p>
<div class="admonition-flow-source-spec admonition">
<p class="admonition-title">flow_source-spec</p>
<ul>
<li><p><cite>“regions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> is the list of regions where the source is defined.</p></li>
<li><p><cite>“spatial distribution method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the method for distributing
source Q over the specified regions. The available options are <cite>“volume</cite>”,
<cite>“none</cite>”, <cite>“permeability</cite>” and <cite>“simple well</cite>”.
For option <cite>“none</cite>”, the source term function Q is measured in [kg/m^3/s].
For the other options, it is measured in [kg/s].
When the source function is defined over a few regions, Q is distributed over their union.
Option <cite>“volume fraction</cite>” can be used when the region geometric
model support volume fractions. Option <cite>“simple well</cite>” implements the Peaceman model.
The well flux is defined as <span class="math notranslate nohighlight">\(q_w = W (p - p_w)\)</span> [kg/s], where <span class="math notranslate nohighlight">\(W\)</span> is
the well index and <span class="math notranslate nohighlight">\(p_w\)</span> is the well pressure. The pressure in a well is assumed
to be hydrostatic.</p></li>
<li><p><cite>“use volume fractions</cite>” instructs the code to use all available volume fractions.
Note that the region geometric model supports volume fractions only for a few regions.</p></li>
<li><p><cite>“submodel</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> refines definition of the source. Available options are</p>
<ul class="simple">
<li><p><cite>“rate</cite>” defines the source in a natural way as the rate of change, <cite>Q</cite>.
It requires a rate function.</p></li>
<li><p><cite>“integrated source</cite>” defines the indefinite integral, <cite>I</cite>, of the rate of change,
i.e. the source term is calculated as <cite>Q = dI/dt</cite>.
It requires a function of <cite>I</cite>.</p></li>
<li><p><cite>“bhp”</cite> stands for the bottom hole pressure. It requires <cite>“depth”</cite>, <cite>“well radius</cite>”
and <cite>“bhp</cite>” function.</p></li>
</ul>
<p>Default submodel is <cite>“rate”</cite>.</p>
<p>For most distributions methods, two submodels are supported: <cite>“rate</cite>” and
<cite>“integrated source</cite>”. For distribution method <cite>“simple well</cite>”, the following two
submodels are supported: <cite>“rate</cite>” and <cite>“bhp</cite>”.</p>
</li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flow&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;source terms&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_SRC 0&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{{_WELL_EAST}}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial distribution method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;volume&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;submodel&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;rate&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;well&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;-0.1&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_SRC 1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{{_WELL_WEST}}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial distribution method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;permeability&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;well&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;-0.2&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_SRC 2&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{{_WELL_NORTH}}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial distribution method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;simple well&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;well&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;submodel&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;bhp&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;depth&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;-2.5&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;well radius&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.1&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;bhp&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;10.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_SRC 3&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{{_WELL_SOUTH}}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial distribution method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;simple well&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;well&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;submodel&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;rate&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;rate&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;100.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="time-integrator">
<h4>Time integrator<a class="headerlink" href="#time-integrator" title="Link to this heading">#</a></h4>
<p>The list <em>time integrator</em> defines a generic time integrator used
by the cycle driver.
This driver assumes that each PK has only one time integrator.
The list <em>time integrator</em> defines parameters controlling linear and
nonlinear solvers during a time integration period.
We break this long sublist into smaller parts.</p>
<section id="initialization-and-constraints">
<h5>Initialization and constraints<a class="headerlink" href="#initialization-and-constraints" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><cite>“error control options</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> lists various error control options.
A nonlinear solver is terminated when all listed options are passed.
The available options are <cite>“pressure</cite>”, <cite>“saturation</cite>”, and <cite>“residual</cite>”.
All errors are relative, i.e. dimensionless.
The error in pressure is compared with capillary pressure plus atmospheric pressure.
The other two errors are compared with 1.
The option <cite>“pressure</cite>” is always active during steady-state time integration.
The option  <cite>“saturation</cite>” is always active during transient time integration.</p></li>
<li><p><cite>“linear solver</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> refers to a generic linear solver from list <cite>“solvers</cite>”.
It is used in all cases except for <cite>“initialization</cite>” and <cite>“dae constraint</cite>”.
Currently, it is used by the Darcy PK only.</p></li>
<li><p><cite>“preconditioner</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies preconditioner for linear and nonlinear solvers.</p></li>
<li><p><cite>“preconditioner enhancement</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies a linear solver that binds
the above preconditioner to improve spectral properties. Default is <cite>“none</cite>”.</p></li>
<li><p><cite>“initialization</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines parameters for calculating initial pressure guess.
It can be used to obtain pressure field which is consistent with the boundary conditions.
Default is empty list.</p>
<ul>
<li><p><cite>“method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies an optional initialization methods. The available
options are <cite>“picard</cite>” and <cite>“saturated solver</cite>”. The latter option leads to solving
a Darcy problem. The former option uses sublist <cite>“picard parameters</cite>”.
<em>Picard works better if a bounded initial pressure guess is provided.</em></p></li>
<li><p><cite>“active wells</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> specifies if wells are active or turned off. Default is <em>false</em>.</p></li>
<li><p><cite>“picard parameters</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines control parameters for the Picard solver.</p>
<ul>
<li><p><cite>“convergence tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> specifies nonlinear convergence tolerance.
Default is 1e-8.</p></li>
<li><p><cite>“maximum number of iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> limits the number of iterations. Default is 400.</p></li>
</ul>
</li>
<li><p><cite>“linear solver</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> refers to a solver sublist of the list <cite>“solvers</cite>”.</p></li>
<li><p><cite>“clipping saturation value</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is an experimental option. It is used
after pressure initialization to cut-off small values of pressure.
The new pressure is calculated based of the provided saturation value. Default is 0.6.</p></li>
<li><p><cite>“clipping pressure value</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is an experimental option. It is used
after pressure initialization to cut-off small values of pressure below the provided
value.</p></li>
</ul>
</li>
<li><p><cite>“dae constraint</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> each time the time integrator is
restarted, we need to re-enforce the pressure-lambda relationship for new boundary conditions.
Default is empty list.</p>
<ul>
<li><p><cite>“method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is a placeholder for different algorithms. Now, the only
available option is <cite>“projection</cite>” which is default.</p></li>
<li><p><cite>“linear solver</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> refers to a solver sublist of the list <cite>“solvers</cite>”.</p></li>
<li><p><cite>“inflow krel correction</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> estimates relative permeability on inflow
mesh faces. This estimate is more reliable than the upwinded relative permeability
value, especially in steady-state calculations.</p></li>
</ul>
</li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flow&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time integrator&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;error control options&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{pressure, saturation}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;linear solver&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_GMRES_WITH_AMG&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioner&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_HYPRE_AMG&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioner enhancement&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>

<span class="w">   </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initialization&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- first method --&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;saturated solver&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;linear solver&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_PCG_WITH_AMG&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;clipping pressure value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;50000.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">   </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initialization&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- alternative method --&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;picard&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;linear solver&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_PCG_WITH_AMG&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;picard parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">       </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;convergence tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-8&quot;</span><span class="nt">/&gt;</span>
<span class="w">       </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;maximum number of iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;20&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">   </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">   </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dae constraint&quot;</span><span class="nt">&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;projection&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;inflow krel correction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;linear solver&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_PCG_WITH_AMG&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w"> </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w"> </span><span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="time-step-controller-and-nonlinear-solver">
<h5>Time step controller and nonlinear solver<a class="headerlink" href="#time-step-controller-and-nonlinear-solver" title="Link to this heading">#</a></h5>
<p>The time step is controlled by parameter <em>time step controller type</em>
and the related list of options, see section <a class="reference internal" href="#timestepcontroller">TimeStepController</a> for the list
of supported parameter.
Nonlinear solver is controlled by parameter <em>solver type</em>  and related list of options.
Amanzi supports a few nonlinear solvers described in details in a separate section.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flow&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time integrator&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time integration method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;BDF1&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;BDF1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max preconditioner lag iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;extrapolate initial guess&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;restart tolerance relaxation factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1000.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;restart tolerance relaxation factor damping&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.9&quot;</span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep controller type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;standard&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep controller standard parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;min iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;15&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time step increase factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.2&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time step reduction factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.5&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max time step&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e+9&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;min time step&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;solver type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;nka&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nka parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nonlinear tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-5&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limit iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;30&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;diverged tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e+10&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;diverged l2 tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e+10&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;diverged pc tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e+10&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max du growth factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e+5&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max divergent iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max nka vectors&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;modify correction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbose object&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbosity level&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;high&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- alternative solver</span>
<span class="cm">    &lt;Parameter name=&quot;solver type&quot; type=&quot;string&quot; value=&quot;aa&quot;/&gt;</span>
<span class="cm">    &lt;ParameterList name=&quot;aa parameters&quot;&gt;</span>
<span class="cm">      &lt;Parameter name=&quot;nonlinear tolerance&quot; type=&quot;double&quot; value=&quot;1e-5&quot;/&gt;</span>
<span class="cm">      &lt;Parameter name=&quot;limit iterations&quot; type=&quot;int&quot; value=&quot;30&quot;/&gt;</span>
<span class="cm">      &lt;Parameter name=&quot;diverged tolerance&quot; type=&quot;double&quot; value=&quot;1e+10&quot;/&gt;</span>
<span class="cm">      &lt;Parameter name=&quot;diverged l2 tolerance&quot; type=&quot;double&quot; value=&quot;1e+10&quot;/&gt;</span>
<span class="cm">      &lt;Parameter name=&quot;diverged pc tolerance&quot; type=&quot;double&quot; value=&quot;1e+10&quot;/&gt;</span>
<span class="cm">      &lt;Parameter name=&quot;max du growth factor&quot; type=&quot;double&quot; value=&quot;1e+5&quot;/&gt;</span>
<span class="cm">      &lt;Parameter name=&quot;max divergent iterations&quot; type=&quot;int&quot; value=&quot;3&quot;/&gt;</span>
<span class="cm">      &lt;Parameter name=&quot;max aa vectors&quot; type=&quot;int&quot; value=&quot;10&quot;/&gt;</span>
<span class="cm">      &lt;Parameter name=&quot;modify correction&quot; type=&quot;bool&quot; value=&quot;false&quot;/&gt;</span>
<span class="cm">      &lt;Parameter name=&quot;relaxation parameter&quot; type=&quot;double&quot; value=&quot;0.75&quot;/&gt;</span>
<span class="cm">    &lt;/ParameterList--&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, the time step is increased by factor 1.2 when the nonlinear
solver converges in 10 or less iterations.
The time step is not changed when the number of nonlinear iterations is
between 11 and 15.
The time step will be cut twice if the number of nonlinear iterations exceeds 15.</p>
</section>
</section>
<section id="other-parameters">
<h4>Other parameters<a class="headerlink" href="#other-parameters" title="Link to this heading">#</a></h4>
<p>The remaining <em>flow</em> parameters are</p>
<ul class="simple">
<li><p><cite>“clipping parameters</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines how solution increment calculated by a nonlinear
solver is modified e.g., clipped.</p>
<ul>
<li><p><cite>“maximum saturation change</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Default is 0.25.</p></li>
<li><p><cite>“pressure damping factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Default is 0.5.</p></li>
</ul>
</li>
<li><p><cite>“plot time history</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> produces an ASCII file with the time history. Default is <cite>“false</cite>”.</p></li>
<li><p><cite>“algebraic water storage balance</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> uses algebraic correction to enforce consistency of
water storage and Darcy fluxes. It leads to a monotone transport. Default is <em>false</em>.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flow&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;clipping parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;maximum saturation change&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.25&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pressure damping factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.5&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>

<span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;plot time history&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;algebraic water storage balance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="explanation-of-verbose-output">
<h4>Explanation of verbose output<a class="headerlink" href="#explanation-of-verbose-output" title="Link to this heading">#</a></h4>
<p>When verbosity is set to <em>high</em>, this PK reports information about
current status of the simulation.
Here after keyword <em>global</em> refers to the whole simulation including
all time periods, keyword <em>local</em> refers to the current time period.
The incomplete list is</p>
<blockquote>
<div><ul class="simple">
<li><p>[global] cycle number, time before the step, and time step dt (in years)</p></li>
<li><p>[local] step number, time T, and dT inside the time integrator (in seconds)</p></li>
<li><p>[local] frequency of preconditioner updates</p></li>
<li><p>[local] number of performed nonlinear steps and value of the nonlinear residual</p></li>
<li><p>[local] total number of successful time steps (TS), failed time steps (FS),
preconditioner updates (PC/1) and preconditioner applies (PC/2),
linear solves insides preconditioner (LS)</p></li>
<li><p>[local] amount of liquid (water) in the reservoir and amount of water entering
and living domain through its boundary (based on darcy flux).</p></li>
<li><p>[global] current simulation time (in years)</p></li>
</ul>
</div></blockquote>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span>CycleDriver<span class="w">      </span>|<span class="w">   </span>Cycle<span class="w"> </span>40:<span class="w"> </span>time(y)<span class="w"> </span>=<span class="w"> </span>0.953452,<span class="w"> </span>dt(y)<span class="w"> </span>=<span class="w"> </span>0.238395
TI::BDF1<span class="w">         </span>|<span class="w">    </span>step<span class="w"> </span>40<span class="w"> </span>T<span class="w"> </span>=<span class="w"> </span>3.00887e+07<span class="w"> </span>[sec]<span class="w">  </span>dT<span class="w"> </span>=<span class="w"> </span>7.52316e+06
TI::BDF1<span class="w">         </span>|<span class="w">    </span>preconditioner<span class="w"> </span>lag<span class="w"> </span>is<span class="w"> </span>20<span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span>20
TI::BDF1<span class="w">         </span>|<span class="w">    </span>success:<span class="w"> </span>4<span class="w"> </span>nonlinear<span class="w"> </span>itrs<span class="w"> </span>error=7.87642e-08
TI::BDF1<span class="w">         </span>|<span class="w">    </span>TS:40<span class="w"> </span>FS:0<span class="w"> </span>NS:64<span class="w"> </span>PC:42<span class="w"> </span>64<span class="w"> </span>LS:0<span class="w"> </span>dt:1.0000e+03<span class="w"> </span>7.5232e+06
FlowPK::Richards<span class="w"> </span>|<span class="w">    </span>reservoir<span class="w"> </span>water<span class="w"> </span>mass=1.36211e+06<span class="w"> </span>[kg],<span class="w"> </span>total<span class="w"> </span>influx=897.175<span class="w"> </span>[kg]
CycleDriver<span class="w">      </span>|<span class="w">   </span>New<span class="w"> </span>time(y)<span class="w"> </span>=<span class="w"> </span>1.19185
</pre></div>
</div>
</section>
</section>
<section id="transport-pk">
<span id="pk-transport"></span><h3><a class="toc-backref" href="#id60" role="doc-backlink">Transport PK</a><a class="headerlink" href="#transport-pk" title="Link to this heading">#</a></h3>
<section id="id1">
<h4>Mathematical models<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>A few PDE models can be instantiated using the parameters described below.</p>
<section id="single-phase-transport">
<h5>Single-phase transport<a class="headerlink" href="#single-phase-transport" title="Link to this heading">#</a></h5>
<p>The conceptual PDE model for the transport in partially saturated media is</p>
<div class="math notranslate nohighlight">
\[\frac{\partial (\phi s_l C)}{\partial t}
=
- \boldsymbol{\nabla} \cdot (\boldsymbol{q}_l C)
+ \boldsymbol{\nabla} \cdot (\phi_e s_l\, (\boldsymbol{D}_l + \tau \boldsymbol{M}_l) \boldsymbol{\nabla} C) + Q,\]</div>
<p>where
<span class="math notranslate nohighlight">\(\phi\)</span> is total porosity [-],
<span class="math notranslate nohighlight">\(\phi_e\)</span> is effective transport porosity [-],
<span class="math notranslate nohighlight">\(s_l\)</span> is liquid saturation [-],
<span class="math notranslate nohighlight">\(Q\)</span> is source or sink term,
<span class="math notranslate nohighlight">\(\boldsymbol{q}_l\)</span> is the Darcy velocity [m/s],
<span class="math notranslate nohighlight">\(\boldsymbol{D}_l\)</span> is dispersion tensor,
<span class="math notranslate nohighlight">\(\boldsymbol{M}_l\)</span> is diffusion coefficient,
and <span class="math notranslate nohighlight">\(\tau\)</span> is tortuosity [-].
For an isotropic medium with no preferred axis of symmetry the dispersion
tensor has the following form:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{D}_l
= \alpha_t \|\boldsymbol{v}\| \boldsymbol{I}
+ \left(\alpha_l-\alpha_t \right)
  \frac{\boldsymbol{v} \boldsymbol{v}}{\|\boldsymbol{v}\|}, \qquad
\boldsymbol{v} = \frac{\boldsymbol{q}}{\phi_e}\]</div>
<p>where
<span class="math notranslate nohighlight">\(\alpha_l\)</span> is longitudinal dispersivity [m],
<span class="math notranslate nohighlight">\(\alpha_t\)</span> is  transverse dispersivity [m],
and <span class="math notranslate nohighlight">\(\boldsymbol{v}\)</span> is average pore velocity [m/s].
Amanzi supports two additional models for dispersivity with 3 and 4 parameters.</p>
</section>
<section id="single-phase-transport-with-dual-porosity-model">
<h5>Single-phase transport with dual porosity model<a class="headerlink" href="#single-phase-transport-with-dual-porosity-model" title="Link to this heading">#</a></h5>
<p>The dual porosity formulation of the solute transport consists of two equations
for the fracture and matrix regions.
In the fracture region, we have citep{simunek-vangenuchten_2008}</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{rcl}
\frac{\partial (\phi_f\, s_{lf}\, C_f)}{\partial t}
&amp;=&amp;
- \boldsymbol{\nabla} \cdot (\boldsymbol{q}_l C_f)
+ \boldsymbol{\nabla} \cdot (\phi_f\, s_{lf}\, (\boldsymbol{D}_l + \tau_f M) \boldsymbol{\nabla} C_f)\\
&amp;&amp; - \displaystyle\frac{\phi_m\,\tau_m}{L_m}\, M \nabla C_m - \Sigma_w C^* + Q_f,
\end{array}\end{split}\]</div>
<p>where
<span class="math notranslate nohighlight">\(\phi_f\)</span> is fracture porosity [-],
<span class="math notranslate nohighlight">\(\phi_m\)</span> is matrix porosity [-],
<span class="math notranslate nohighlight">\(s_{lf}\)</span> is liquid saturation in fracture [-],
<span class="math notranslate nohighlight">\(\boldsymbol{q}_l\)</span> is the Darcy velocity [m/s],
<span class="math notranslate nohighlight">\(\boldsymbol{D}_l\)</span> is dispersion tensor,
<span class="math notranslate nohighlight">\(\tau_f\)</span> is fracture tortuosity [-],
<span class="math notranslate nohighlight">\(\tau_m\)</span> is matrix tortuosity [-],
<span class="math notranslate nohighlight">\(M\)</span> is molecular diffusion coefficient [<span class="math notranslate nohighlight">\(m^2/s\)</span>], and
<span class="math notranslate nohighlight">\(L_m\)</span> is the characteristic matrix depth defined typically as the ratio of a matrix block [m],
<span class="math notranslate nohighlight">\(\Sigma_w\)</span> is transfer rate due to flow from the matrix to the fracture,
<span class="math notranslate nohighlight">\(C^*\)</span> is equal to <span class="math notranslate nohighlight">\(C_f\)</span> if <span class="math notranslate nohighlight">\(\Sigma_w &gt; 0\)</span> and <span class="math notranslate nohighlight">\(C_m\)</span> is <span class="math notranslate nohighlight">\(\Sigma_w &lt; 0\)</span>,
and <span class="math notranslate nohighlight">\(Q_f\)</span> is source or sink term.
In the matrix region, we have</p>
<div class="math notranslate nohighlight">
\[\frac{\partial (\phi_m\, s_{lm}\, C_m)}{\partial t}
= \nabla\cdot (\phi_m\, \tau_m\, M_m \nabla C_m) + \Sigma_w C^* + Q_m,\]</div>
<p>where
<span class="math notranslate nohighlight">\(\phi_m\)</span> is matrix porosity [-],
<span class="math notranslate nohighlight">\(s_{lm}\)</span> is liquid saturation in matrix [-],
<span class="math notranslate nohighlight">\(Q_m\)</span> is source or sink term.
The simplified one-node dual porosity model uses a finite difference approximation of the
solute gradient:</p>
<div class="math notranslate nohighlight">
\[\nabla C_m \approx WR \, \frac{C_f - C_m}{L_m},\]</div>
<p>where
<span class="math notranslate nohighlight">\(WR\)</span> is the Warren-Root coefficient that estimates the poro-space geometry, [-]</p>
</section>
</section>
<section id="id2">
<h4>Physical models and assumptions<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>This list is used to summarize physical models and assumptions, such as
coupling with other PKs.
This list is often generated or extended by a high-level MPC PK.</p>
<div class="admonition-transport-spec admonition">
<p class="admonition-title">transport-spec</p>
<ul class="simple">
<li><p><cite>“gas diffusion</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> indicates that air-water partitioning coefficients
are used to distribute components between liquid and as phases. Default is <em>false</em>.</p></li>
<li><p><cite>“permeability field is required</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> indicates if some transport features
require absolute permeability. Default is <em>false</em>.</p></li>
<li><p><cite>“multiscale model</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies a multiscale model.
Available options are <cite>“single porosity</cite>” (default) and <cite>“dual porosity</cite>”.</p></li>
<li><p><cite>“effective transport porosity</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> If <em>true</em>, effective transport porosity
will be used by dispersive-diffusive fluxes instead of total porosity.
Default is <em>false</em>.</p></li>
<li><p><cite>“eos lookup table</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> provides the name for optional EOS lookup table.</p></li>
<li><p><cite>“use dispersion solver</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> instructs PK to instantiate a solver but do
not call it. It is used now by MPC to form a global solver. Default is <em>false</em>.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_TRANSPORT&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;physical models and assumptions&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gas diffusion&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;permeability field is required&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;multiscale model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;single porosity&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;effective transport porosity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;eos lookup table&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;h2o.eos&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;use dispersion solver&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="id3">
<h4>Global parameters<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p>The transport component of Amanzi performs advection of aqueous and gaseous
components and their dispersion and diffusion.
The main parameters control temporal stability, spatial
and temporal accuracy, and verbosity:</p>
<div class="admonition-transport-global-params-spec admonition">
<p class="admonition-title">transport_global_params-spec</p>
<ul class="simple">
<li><p><cite>“domain name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies mesh name that defined domain of this PK.
Default is <cite>“domain</cite>”.</p></li>
<li><p><cite>“cfl</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Time step limiter, a number less than 1. Default value is 1.</p></li>
<li><p><cite>“method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines flux method. Available options are <cite>“muscl</cite>” (default) and <cite>“fct</cite>”.</p></li>
<li><p><cite>“spatial discretization order</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> defines accuracy of spatial discretization.
It permits values 1 or 2. Default value is 1.</p></li>
<li><p><cite>“temporal discretization order</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> defines accuracy of temporal discretization.
It permits values 1 or 2 and values 3 or 4. Note that RK3 is not monotone.
Default value is 1.</p></li>
<li><p><cite>“reconstruction</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> collects reconstruction parameters. The available options are
describe in the separate section below.</p></li>
<li><p><cite>“solver</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Specifies the dispersion/diffusion solver.</p></li>
<li><p><cite>“preconditioner</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies preconditioner for dispersion solver.</p></li>
<li><p><cite>“number of aqueous components</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> The total number of aqueous components.
Default value is the total number of components.</p></li>
<li><p><cite>“number of gaseous components</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> The total number of gaseous components.
Default value is 0.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_TRANSPORT&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;domain name&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;domain&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cfl&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;muscl&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial discretization order&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;temporal discretization order&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;solver&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_PCG_SOLVER&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reconstruction&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell-based&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;polynomial order&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limiter&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;tensorial&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limiter extension for transport&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbose object&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbosity level&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;high&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="material-properties">
<h4>Material properties<a class="headerlink" href="#material-properties" title="Link to this heading">#</a></h4>
<p>The material properties include dispersivity model and diffusion parameters
for aqueous and gaseous phases.
The dispersivity is defined as a soil property.
The diffusivity is defined independently for each solute.</p>
<div class="admonition-mdm-spec admonition">
<p class="admonition-title">mdm-spec</p>
<ul>
<li><p>_SOIL <code class="docutils literal notranslate"><span class="pre">[list]</span></code> Defines material properties.</p>
<ul>
<li><p><cite>“region</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> Defines geometric regions for material SOIL.</p></li>
<li><p><cite>“model</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Defines dispersivity model, choose exactly one of the following: <cite>“scalar</cite>”, <cite>“Bear</cite>”,
<cite>“Burnett-Frind</cite>”, or <cite>“Lichtner-Kelkar-Robinson</cite>”.</p></li>
<li><p><cite>“parameters for MODEL</cite>” [list] where <cite>“MODEL</cite>” is the model name.
For model <cite>“scalar</cite>”, <em>only</em> one of the following options must be specified:</p>
<ul class="simple">
<li><p><cite>“alpha</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines dispersivity in all directions, [m].</p></li>
<li><p><cite>“dispersion coefficient</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines dispersion coefficient [m^2/s].</p></li>
</ul>
<p>For model <cite>“Bear</cite>”, the following options must be specified:</p>
<ul class="simple">
<li><p><cite>“alpha_l</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines dispersion in the direction of Darcy velocity, [m].</p></li>
<li><p><cite>“alpha_t</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines dispersion in the orthogonal direction, [m].</p></li>
</ul>
<p>For model <cite>“Burnett-Frind</cite>”, the following options must be specified:</p>
<ul class="simple">
<li><p><cite>“alphaL</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines the longitudinal dispersion in the direction of Darcy velocity, [m].</p></li>
<li><p><cite>“alpha_th</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Defines the transverse dispersion in the horizonla direction orthogonal directions, [m].</p></li>
<li><p><cite>“alpha_tv</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Defines dispersion in the orthogonal directions, [m].
When <cite>“alpha_th</cite>” equals to <cite>“alpha_tv</cite>”, we obtain dispersion in the direction of the Darcy velocity.
This and the above parameters must be defined for <cite>“Burnett-Frind</cite>” and <cite>“Lichtner-Kelkar-Robinson</cite>” models.</p></li>
</ul>
<p>For model <cite>“Lichtner-Kelker-Robinson</cite>”, the following options must be specified:</p>
<ul class="simple">
<li><p><cite>“alpha_lh</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines the longitudinal dispersion in the horizontal direction, [m].</p></li>
<li><p><cite>“alpha_lv</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Defines the longitudinal dispersion in the vertical direction, [m].
When <cite>“alpha_lh</cite>” equals to <cite>“alpha_lv</cite>”, we obtain dispersion in the direction of the Darcy velocity.
This and the above parameters must be defined for <cite>“Burnett-Frind</cite>” and <cite>“Lichtner-Kelker-Robinson</cite>” models.</p></li>
<li><p><cite>“alpha_th</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Defines the transverse dispersion in the horizontal direction orthogonal directions, [m].</p></li>
<li><p><cite>“alpha_tv” ``[double]`</cite> Defines dispersion in the orthogonal directions.
When <cite>“alpha_th</cite>” equals to <cite>“alpha_tv</cite>”, we obtain dispersion in the direction of the Darcy velocity.
This and the above parameters must be defined for <cite>“Burnett-Frind</cite>” and <cite>“Lichtner-Kelker-Robinson</cite>” models.</p></li>
</ul>
</li>
<li><p><cite>“aqueous tortuosity</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Defines tortuosity for calculating diffusivity of liquid solutes, [-].</p></li>
<li><p><cite>“gaseous tortuosity</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Defines tortuosity for calculating diffusivity of gas solutes, [-].</p></li>
</ul>
</li>
</ul>
</div>
<p>Three examples are below:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_TRANSPORT&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;material properties&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_WHITE SOIL&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_TOP_REGION, _BOTTOM_REGION}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Bear&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;parameters for Bear&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;alpha_l&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-2&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;alpha_t&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-5&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;aqueous tortuosity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gaseous tortuosity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_GREY SOIL&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_MIDDLE_REGION}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Burnett-Frind&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;parameters for Burnett-Frind&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;alpha_l&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-2&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;alpha_th&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-3&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;alpha_tv&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2e-3&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;aqueous tortuosity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.5&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gaseous tortuosity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="admonition-material-properties-spec admonition">
<p class="admonition-title">material_properties-spec</p>
<ul class="simple">
<li><p><cite>“molecular diffusion</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines names of solutes in aqueous and gaseous phases and related
diffusivity values.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_TRANSPORT&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;molecular diffusion&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;aqueous names&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{CO2(l),Tc-99}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;aqueous values&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1e-8,1e-9}&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gaseous names&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{CO2(g)}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gaseous values&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1e-8}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;air-water partitioning coefficient&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0.03}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="dispersion-operator">
<h4>Dispersion operator<a class="headerlink" href="#dispersion-operator" title="Link to this heading">#</a></h4>
<p>List <em>operators</em> describes the PDE structure of the flow, specifies a discretization
scheme, and selects assembling schemas for matrices and preconditioners.</p>
<div class="admonition-dispersion-spec admonition">
<p class="admonition-title">dispersion-spec</p>
<ul class="simple">
<li><p><cite>“operators</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code></p>
<ul>
<li><p><cite>“diffusion operator</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code></p>
<ul>
<li><p><cite>“matrix</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines parameters for generating and assembling dispersion matrix.
See section describing operators.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_TRANSPORT&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;operators&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;diffusion operator&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;matrix&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization primary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: optimized for monotonicity&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization secondary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: two-point flux approximation&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face, cell}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioner schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>This example creates a p-lambda system, i.e. the concentration is
discretized in mesh cells and on mesh faces. The later unknowns are auxiliary unknowns.</p>
</section>
<section id="id4">
<h4>Multiscale continuum models<a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<p>The list of multiscale models is the place for various subscale models that coul
be mixed and matched.
Its ordered by materials and includes parameters for the assigned multiscale model
This list is optional.</p>
<div class="admonition-transport-multiscale-spec admonition">
<p class="admonition-title">transport_multiscale-spec</p>
<ul class="simple">
<li><p><cite>“multiscale model</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the model name. Available option is <cite>“dual porosity</cite>”
and <cite>“generalized dual porosity</cite>”.</p></li>
<li><p><cite>“regions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> is the list of regions where this model should be applied.</p></li>
<li><p><cite>“xxx parameters</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> provides parameters for the model specified by variable
<cite>“multiscale model</cite>”.</p></li>
</ul>
</div>
<section id="id5">
<h5>Dual porosity model<a class="headerlink" href="#id5" title="Link to this heading">#</a></h5>
<p>A two-scale porosity model (fracture + matrix) aka dual porosity
model. Current naming convention is that the fields used in the
single-porosity model correspond now to the fracture continuum.
Example: tcc = total component concentration in the fracture continuum;
tcc_matrix = total component concentration in the matrix continuum.</p>
<div class="admonition-transport-dual-porosity-spec admonition">
<p class="admonition-title">transport_dual_porosity-spec</p>
<ul class="simple">
<li><p><cite>“Warren Root parameter</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> scales diffusive solute transport due to
concentration gradient.</p></li>
<li><p><cite>“tortousity</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines tortuosity to correct diffusivity of
a liquid solute.</p></li>
</ul>
</div>
</section>
<section id="id6">
<h5>Generalized dual porosity model<a class="headerlink" href="#id6" title="Link to this heading">#</a></h5>
<p>A generalized dual porosity model, fracture + multiple matrix nodes.
Current naming convention is that the fields used in the single-porosity
model correspond now to the fracture continuum.
Example: tcc = total component concentration in the fracture continuum;
tcc_matrix = total component concentration in the matrix continuum.</p>
<div class="admonition-transport-generalized-dual-porosity-spec admonition">
<p class="admonition-title">transport_generalized_dual_porosity-spec</p>
<ul class="simple">
<li><p><cite>“number of matrix nodes</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> defines number of matrix layers.</p></li>
<li><p><cite>“matrix depth</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the characteristic length for matrix continuum.</p></li>
<li><p><cite>“tortousity</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines tortuosity to correct diffusivity of a liquid solute.</p></li>
<li><p><cite>“matrix volume fraction</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines relative volume of matrix continuum.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_TRANSPORT&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;multiscale models&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_WHITE SOIL&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;multiscale model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;dual porosity&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_TOP_REGION, _BOTTOM_REGION}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dual porosity parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Paramater</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Warren Root parameter&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;4.0e-5&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Paramater</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;matrix tortuosity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.95&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Paramater</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;matrix volume fraction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.9999&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_GREY SOIL&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;multiscale model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;generalized dual porosity&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_MIDDLE_REGION}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;generalized dual porosity parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Paramater</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of matrix nodes&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Paramater</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;matrix depth&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.01&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Paramater</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;matrix tortuosity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="id7">
<h4>Boundary conditions<a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<p>For the advective transport, the boundary conditions must be specified on inflow parts of the
boundary. If no value is prescribed through the XML input, the zero influx boundary condition
is used. Note that the boundary condition is set up separately for each component.
The structure of boundary conditions is aligned with that used for flow and
allows us to define spatially variable boundary conditions.</p>
<div class="admonition-transport-boundary-conditions-spec admonition">
<p class="admonition-title">transport_boundary_conditions-spec</p>
<ul class="simple">
<li><p><cite>“boundary conditions</cite>” [list]</p>
<ul>
<li><p><cite>“concentration</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> This is a reserved keyword.</p>
<ul>
<li><p>“_SOLUTE” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> contains a few sublists (e.g. _EAST_CRIB) for boundary conditions.
The name _SOLUTE must be the name in the list of solutes.</p>
<ul>
<li><p>“_BC1” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines boundary conditions using arrays of boundary regions and attached
functions.</p></li>
<li><p><cite>“regions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> defines a list of boundary regions where a boundary condition
must be applied.</p></li>
<li><p><cite>“spatial distribution method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines the method for distributing
data  over the specified regions. The available options are <cite>“area</cite>” or <cite>“none</cite>”.</p></li>
<li><p><cite>“boundary concentration</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines a function for calculating boundary conditions.
The function specification is described in subsection Functions.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>The example below sets constant boundary condition 1e-5 for the duration of transient simulation.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_TRANSPORT&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;concentration&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;NO3-&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_EAST_CRIB&quot;</span><span class="nt">&gt;</span><span class="w">   </span><span class="cm">&lt;!-- user defined name --&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_TOP, _LEFT}&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial distribution method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;boundary concentration&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- any time function --&gt;</span>
<span class="w">            </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-5&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_WEST CRIB&quot;</span><span class="nt">&gt;</span><span class="w">   </span><span class="cm">&lt;!-- user defined name --&gt;</span>
<span class="w">        </span>...
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;CO2&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- Next component --&gt;</span>
<span class="w">      </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Geochemical boundary condition is the Dirichlet boundary condition
which requires calculation of a geochemical balance.
Note that the number of <em>time functions</em> below is one less than the number of times
and geochemical conditions.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;geochemical&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_EAST_CRIB&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;solutes&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">{H+,HCO3-,Ca++}&quot;/</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0.0, 100.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;geochemical conditions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{cond1, cond2}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time functions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{constant}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{EAST_CRIB}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="id8">
<h4>Sources and sinks<a class="headerlink" href="#id8" title="Link to this heading">#</a></h4>
<p>The sources and sinks are typically located at wells.
Stability condition requires to distinguish between injecting and producing wells.
A source function used for an injecting well specifies concentration of solute.
A source function used for a producing well specifies volumetric flow rate [m^3/s] of water.</p>
<p>The structure of list <em>source terms</em> includes only sublists named after components.
Again, constant functions can be replaced by any available time-function.
Note that the source values are set up separately for each component.</p>
<div class="admonition-transport-sources-spec admonition">
<p class="admonition-title">transport_sources-spec</p>
<ul class="simple">
<li><p><cite>“concentration</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> This is a reserved keyword.</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>“_SOLUTE” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> contains a few sublists (e.g. _SRC1 and _SRC2) for various sources
and sinks. The name _SOLUTE must exist in the list of solutes.</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>“_SRC1” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines a source using arrays of domain regions, a function, and
a distribution method.</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><cite>“regions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> defines a list of domain regions where a source term
must be applied.</p></li>
<li><p><cite>“spatial distribution method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> identifies a method for distributing
source Q over the specified regions. The available options are <cite>“volume</cite>”,
<cite>“none</cite>”, and <cite>“permeability</cite>”. For option <cite>“none</cite>” the source term Q is measured
in [mol/L/s] (if units for concentration is mol/L) or [mol/m^3/s] (otherwise).
For the other options, it is measured in [mol/s]. When the source function
is defined over a few regions, Q will be distributed over their union.</p></li>
<li><p><cite>“submodel</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> refines definition of source. Available options are <cite>“rate</cite>”
and <cite>“integrand</cite>”. The first option defines rate of change <cite>q</cite>, the second one
defines integrand <cite>Q</cite> of a rate <cite>Q = dq/dt</cite>. Default is <cite>“rate</cite>”.</p></li>
<li><p><cite>“sink</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> is a function for calculating a source term.
The function specification is described in subsection Functions.</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</div></blockquote>
</div>
<p>This example defines one well and one sink.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;source terms&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;concentration&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;H+&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_SOURCE: EAST WELL&quot;</span><span class="nt">&gt;</span><span class="w">   </span><span class="cm">&lt;!-- user defined name --&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_EAST_WELL}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial distribution method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;volume&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;submodel&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;rate&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;injector&quot;</span><span class="nt">&gt;</span><span class="w">   </span><span class="cm">&lt;!-- reserved keyword --&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.01&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_SOURCE: WEST_WELL&quot;</span><span class="nt">&gt;</span>
<span class="w">       </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;CO2(g)&quot;</span><span class="nt">&gt;</span><span class="w">   </span><span class="cm">&lt;!-- next component, a gas --&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_SOURCE: WEST WELL&quot;</span><span class="nt">&gt;</span><span class="w">   </span><span class="cm">&lt;!-- user defined name --&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_WEST_WELL}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial distribution method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;permeability&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;injector&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.02&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="developer-parameters">
<h4>Developer parameters<a class="headerlink" href="#developer-parameters" title="Link to this heading">#</a></h4>
<p>The remaining parameters that can be used by a developer include</p>
<ul class="simple">
<li><p><cite>“enable internal tests</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> turns on various internal tests during
run time. Default value is <cite>“false</cite>”.</p></li>
<li><p><cite>“internal tests tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> tolerance for internal tests such as the
divergence-free condition. The default value is 1e-6.</p></li>
<li><p><cite>“runtime diagnostics: solute names</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> defines solutes that will be
tracked closely each time step if verbosity <cite>“high</cite>”. Default value is the first
solute in the global list of <cite>“aqueous names</cite>” and the first gas in the global list
of <cite>“gaseous names</cite>”.</p></li>
<li><p><cite>“runtime diagnostics: regions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> defines a boundary region for
tracking solutes. Default value is a seepage face boundary, see Flow PK.</p></li>
</ul>
</section>
<section id="id9">
<h4>Explanation of verbose output<a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<p>When verbosity is set to <em>high</em>, this PK reports information about
current status of the simulation.
Here after keyword <em>global</em> refers to the whole simulation including
all time periods, keyword <em>local</em> refers to the current time period.
The incomplete list is</p>
<blockquote>
<div><ul class="simple">
<li><p>[global] cycle number, time before step, and time step dt (in years)</p></li>
<li><p>[local] cell id and position with the smallest time step</p></li>
<li><p>[local] convergence of a linear solver for dispersion, PCG here</p></li>
<li><p>[local] number of subcycles, stable time step, and global time step (in seconds)</p></li>
<li><p>[local] species’s name, concentration extrema, and total amount of it in the reservoir</p></li>
<li><p>[global] current simulation time (in years)</p></li>
</ul>
</div></blockquote>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span>CycleDriver<span class="w">      </span>|<span class="w">   </span>Cycle<span class="w"> </span>10:<span class="w"> </span>time(y)<span class="w"> </span>=<span class="w"> </span>0.803511,<span class="w"> </span>dt(y)<span class="w"> </span>=<span class="w"> </span>0.089279
TransportPK<span class="w">      </span>|<span class="w">    </span>cell<span class="w"> </span>0<span class="w"> </span>has<span class="w"> </span>smallest<span class="w"> </span>dt,<span class="w"> </span>(-270,<span class="w"> </span>-270)
TransportPK<span class="w">      </span>|<span class="w">    </span>dispersion<span class="w"> </span>solver<span class="w"> </span>(pcg)<span class="w"> </span>||r||=8.33085e-39<span class="w"> </span>itrs=2
TransportPK<span class="w">      </span>|<span class="w">    </span>1<span class="w"> </span>sub-cycles,<span class="w"> </span>dt_stable=2.81743e+06<span class="w"> </span>[sec]<span class="w">  </span>dt_MPC=2.81743e+06<span class="w"> </span>[sec]
TransportPK<span class="w">      </span>|<span class="w">    </span>Tc-99:<span class="w"> </span>min=8.08339e-06<span class="w"> </span>mol/L<span class="w"> </span>max=0.0952948<span class="w"> </span>mol/L,<span class="w"> </span>total=9.07795<span class="w"> </span>mol
CycleDriver<span class="w">      </span>|<span class="w">   </span>New<span class="w"> </span>time(y)<span class="w"> </span>=<span class="w"> </span>0.89279
</pre></div>
</div>
</section>
</section>
<section id="chemistry-pk">
<h3><a class="toc-backref" href="#id61" role="doc-backlink">Chemistry PK</a><a class="headerlink" href="#chemistry-pk" title="Link to this heading">#</a></h3>
<p>The chemistry header includes three parameters:</p>
<div class="admonition-chemistry-pk-spec admonition">
<p class="admonition-title">chemistry_pk-spec</p>
<ul class="simple">
<li><p><cite>“chemistry model</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines chemical model. The available options are <cite>“Alquimia</cite>”
and <cite>“Amanzi</cite>” (default).</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_CHEMISTRY&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;chemistry model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Amanzi&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<section id="geochemical-engines">
<h4>Geochemical engines<a class="headerlink" href="#geochemical-engines" title="Link to this heading">#</a></h4>
<p>Here we specify either the default or the third-party geochemical engine.</p>
<section id="common-parameters">
<h5>Common parameters<a class="headerlink" href="#common-parameters" title="Link to this heading">#</a></h5>
<p>The following parameters are common for all supported engines.</p>
<div class="admonition-chemistry-params-spec admonition">
<p class="admonition-title">chemistry_params-spec</p>
<ul class="simple">
<li><p><cite>“timestep control method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies timestep control method for chemistry subcycling.
Choose either “fixed” (default) or “simple”.  For option “fixed”, timestep is fixed.
For option “simple”, the timestep is adjusted in response to stiffness of system of equations
based on a simple scheme. This option require the following parameters: <cite>“timestep cut threshold</cite>”,
<cite>“timestep cut factor</cite>”, <cite>“timestep increase threshold</cite>”, and <cite>“timestep increase factor</cite>”.</p></li>
<li><p><cite>“timestep cut threshold</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> is the number of Newton iterations that if exceeded
will trigger a timestep cut. Default is 8.</p></li>
<li><p><cite>“max timestep (s)</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the maximum timestep that chemistry will allow the MPC to take.</p></li>
<li><p><cite>“initial timestep (s)</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the initial timestep that chemistry will ask the MPC to take.</p></li>
<li><p><cite>“timestep cut factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the factor by which the timestep is cut. Default is 2.0</p></li>
<li><p><cite>“timestep increase threshold</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> is the number of consecutive successful timesteps that
will trigger a timestep increase. Default is 4.</p></li>
<li><p><cite>“timestep increase factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the factor by which the timestep is increased. Default is 1.2</p></li>
<li><p><cite>“free ion initial guess</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> provides an estimate of the free ion concentration for solutes.
It used to help convergence of the initial solution of the chemistry. If this parameter is absent,
a fraction (10%) of the total component concentration is used.</p></li>
<li><p><cite>“initial conditions time</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> specifies time for applying initial conditions. This parameter
is useful for simulation restart. Default value is the state time when chemistry PK is instantiated.</p></li>
</ul>
</div>
</section>
<section id="alquimia">
<span id="pk-chemistry-alquimia"></span><h5>Alquimia<a class="headerlink" href="#alquimia" title="Link to this heading">#</a></h5>
<p>The Alquimia chemistry process kernel only requires the <em>Engine</em> and <em>Engine Input File</em>
entries, but will also accept and respect the value given for <em>max timestep (s)</em>.
Most details are provided in the trimmed PFloTran file <em>1d-tritium-trim.in</em>.</p>
<div class="admonition-alquimia-spec admonition">
<p class="admonition-title">alquimia-spec</p>
<ul class="simple">
<li><p><cite>“minerals</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> is the list of mineral names.</p></li>
<li><p><cite>“sorption sites</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> is the list of sorption sites.</p></li>
<li><p><cite>“auxiliary data</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> defines additional chemistry related data that the user
can request be saved to vis files.</p></li>
<li><p><cite>“min timestep (s)</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the minimum timestep that chemistry will allow
the MPC to take.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_CHEMISTRY&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;engine&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;PFloTran&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;engine input file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_TRITIUM.in&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;minerals&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{quartz, kaolinite, goethite, opal}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;min timestep (s)&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.5778463e-07&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max timestep (s)&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.5778463e+07&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial timestep (s)&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0e-02&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep control method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;simple&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep cut threshold&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;8&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep cut factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep increase threshold&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;4&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep increase factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.2&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="amanzi">
<span id="pk-chemistry-amanzi"></span><h5>Amanzi<a class="headerlink" href="#amanzi" title="Link to this heading">#</a></h5>
<p>The Amanzi chemistry process kernel uses the following parameters.</p>
<div class="admonition-chemistry-amanzi-spec admonition">
<p class="admonition-title">chemistry_amanzi-spec</p>
<ul class="simple">
<li><p><cite>“thermodynamic database</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code></p>
<ul>
<li><p><cite>“file</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the name of the chemistry database file, relative to the execution directory.</p></li>
<li><p><cite>“format</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the format of the database file. Actual database format is not XML and
is the same as described for the 2010 demo with additions for the new chemical processes.
Valid values: “simple”.</p></li>
</ul>
</li>
<li><p><cite>“minerals</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> is the list of mineral names.</p></li>
<li><p><cite>“sorption sites</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> is the list of sorption sites.</p></li>
<li><p><cite>“activity model</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the type of model used for activity corrections.
Valid options are <cite>“unit</cite>”, <cite>“debye-huckel</cite>”, and <cite>“pitzer-hwm</cite>”,</p></li>
<li><p><cite>“tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines tolerance in Newton solves inside the chemistry library.</p></li>
<li><p><cite>“maximum Newton iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> is the maximum number of iteration the chemistry
library can take.</p></li>
<li><p><cite>“auxiliary data</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> defines additional chemistry related data that the user
can request be saved to vis files. Currently <cite>“pH</cite>” is the only variable supported.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_CHEMISTRY&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;thermodynamic database&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_TRITIUM.bgd&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;format&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;simple&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;activity model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;unit&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.5e-12&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;maximum Newton iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;25&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max timestep (s)&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.5e+07&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;auxiliary data&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{pH}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of component concentrations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep control method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;simple&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="energy-pk">
<span id="pk-energy"></span><h3><a class="toc-backref" href="#id62" role="doc-backlink">Energy PK</a><a class="headerlink" href="#energy-pk" title="Link to this heading">#</a></h3>
<p>The conceptual PDE model for the energy equation is</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \varepsilon}{\partial t}
=
\boldsymbol{\nabla} \cdot (\kappa \nabla T) -
\boldsymbol{\nabla} \cdot (\eta_l H_l \boldsymbol{q}_l) + Q\]</div>
<p>where
<span class="math notranslate nohighlight">\(\varepsilon\)</span> is the energy density [<span class="math notranslate nohighlight">\(J/m^3\)</span>],
<span class="math notranslate nohighlight">\(\eta_l\)</span> is molar density of liquid [<span class="math notranslate nohighlight">\(mol/m^3\)</span>],
<span class="math notranslate nohighlight">\(Q\)</span> is heat source term,
<span class="math notranslate nohighlight">\(\boldsymbol{q}_l\)</span> is the Darcy velocity [m/s],
<span class="math notranslate nohighlight">\(\kappa\)</span> is thermal conductivity,
and <span class="math notranslate nohighlight">\(H_l\)</span> is molar enthalpy of liquid [J/mol].
We define</p>
<div class="math notranslate nohighlight">
\[\varepsilon = \phi (\eta_l s_l U_l + \eta_g s_g U_g) +
(1 - \phi) \rho_r c_r T\]</div>
<p>where
<span class="math notranslate nohighlight">\(s_l\)</span> is liquid saturation [-],
<span class="math notranslate nohighlight">\(s_g\)</span> is gas saturation (water vapor),
<span class="math notranslate nohighlight">\(\eta_l\)</span> is molar density of liquid [<span class="math notranslate nohighlight">\(mol/m^3\)</span>],
<span class="math notranslate nohighlight">\(\eta_g\)</span> is molar density of gas,
<span class="math notranslate nohighlight">\(U_l\)</span> is molar internal energy of liquid [J/mol],
<span class="math notranslate nohighlight">\(U_g\)</span> is molar internal energy of gas (water vapor) [J/mol],
<span class="math notranslate nohighlight">\(\phi\)</span> is porosity [-],
<span class="math notranslate nohighlight">\(\rho_r\)</span> is rock density [<span class="math notranslate nohighlight">\(kg/m^3\)</span>],
<span class="math notranslate nohighlight">\(c_r\)</span> is specific heat of rock [J/kg/K],
and <span class="math notranslate nohighlight">\(T\)</span> is temperature [K].</p>
<section id="id10">
<h4>Physical models and assumptions<a class="headerlink" href="#id10" title="Link to this heading">#</a></h4>
<p>This list is used to summarize physical models and assumptions, such as
coupling with other PKs.
This list is often generated on a fly by a high-level MPC PK.</p>
<div class="admonition-energy-pk-spec admonition">
<p class="admonition-title">energy_pk-spec</p>
<ul class="simple">
<li><p><cite>“vapor diffusion</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> is set up automatically by a high-level PK,
e.g. by EnergyFlow PK. The default value is <cite>“false</cite>”.</p></li>
<li><p><cite>“eos lookup table</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> provides the name for optional EOS lookup table.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_ENERGY&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;physical models and assumptions&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;vapor diffusion&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;eos lookup table&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;h2o.eos&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="internal-energy">
<h4>Internal energy<a class="headerlink" href="#internal-energy" title="Link to this heading">#</a></h4>
<p>Internal energy model is function of temperature only. Units are J/{mol/kg}.
Internal energy list has a few parameters that allows us to run this PK
in a variety of regimes, e.g. with or without gas phase.</p>
<div class="admonition-iem-spec admonition">
<p class="admonition-title">iem-spec</p>
<ul class="simple">
<li><p><cite>“energy key</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies name for the internal energy field.
The default value is <cite>“energy</cite>”.</p></li>
<li><p><cite>“evaluator type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> changes the evaluator for internal energy.
Available options are <cite>“generic</cite>” and <cite>“constant liquid density</cite>” (default).</p></li>
<li><p><cite>“vapor diffusion</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> specifies presence of a gas phase.
The default value is <cite>“true</cite>”.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_ENERGY&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;energy evaluator&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;energy key&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;energy&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;evaluator type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;constant liquid density&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;vapor diffusion&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbose object&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbosity level&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;high&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="molar-enthalpy">
<h4>Molar enthalpy<a class="headerlink" href="#molar-enthalpy" title="Link to this heading">#</a></h4>
<p>Field evaluator for specific molar enthalpy,</p>
<div class="math notranslate nohighlight">
\[h = u + \displaystyle\frac{p}{\rho}.\]</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_ENERGY&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;enthalpy evaluator&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;enthalpy key&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;enthalpy_liquid&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;internal energy key&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;internal_energy_liquid&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;include work term&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pressure key&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;pressure&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;molar density key&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;molar_density_liquid&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="thermal-conductivity">
<h4>Thermal conductivity<a class="headerlink" href="#thermal-conductivity" title="Link to this heading">#</a></h4>
<p>Evaluator for thermal conductivity allows us to select a proper model.
The variety of available models allows to run the energy PK by itself or in
coupling with flow PK.
The single-phase model accepts the following parameters:</p>
<div class="admonition-tcm-one-phase-spec admonition">
<p class="admonition-title">tcm_one_phase-spec</p>
<ul class="simple">
<li><p><cite>“TCM0</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines a reginal model and its parameters.</p></li>
<li><p><cite>“thermal conductivity type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the name of conductivity model for
a mixture of phases. Available two-phase models are <cite>“two-phase Peters-Lidard</cite>”,
and <cite>“two-phase wet/dry</cite>”. Available one-phase model is <cite>“one-phase polynomial</cite>”.</p></li>
<li><p><cite>“regions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> specifies regions where model is applied.</p></li>
<li><p><cite>“solid phase</cite>” [list] define a thermal conductivity model for solid phase.</p>
<ul>
<li><p><cite>“eos type</cite>” <code class="docutils literal notranslate"><span class="pre">[stirng]</span></code> defines EOS model. Available options are <cite>“constant</cite>”
and <cite>“salt</cite>”.</p></li>
<li><p><cite>“reference conductivity</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines constant or reference conductivity.</p></li>
<li><p><cite>“reference temperature</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines temperature at which reference
conductivity of liquid is calculated. Default value is 298.15 [K].</p></li>
<li><p><cite>“Sutherland constant</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines parameter in temperature dependence.</p></li>
</ul>
</li>
<li><p><cite>“gas phase</cite>” [list] define a thermal conductivity model for gas phase.</p>
<ul>
<li><p><cite>“eos type</cite>” <code class="docutils literal notranslate"><span class="pre">[stirng]</span></code> defines EOS model. Available options are <cite>“constant</cite>”
and <cite>“ideal gas</cite>”.</p></li>
<li><p><cite>“reference conductivity</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines constant or reference conductivity.</p></li>
<li><p><cite>“Sutherland constant</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines parameter in temperature dependence</p></li>
</ul>
</li>
<li><p><cite>“liquid phase</cite>” [list] define a thermal conductivity model for liquid phase.</p>
<ul>
<li><p><cite>“eos type</cite>” <code class="docutils literal notranslate"><span class="pre">[stirng]</span></code> defines EOS model. Available options are <cite>“constant</cite>”
and <cite>“liquid water</cite>”.</p></li>
<li><p><cite>“reference conductivity</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines constant or reference conductivity.
Default value is 0.6065 [W/m/K].</p></li>
<li><p><cite>“reference temperature</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines temperature at which reference
conductivity of liquid is calculated. Default value is 298.15 [K].</p></li>
<li><p><cite>“polynomial expansion</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> collect coefficients in the quadratic
representation of the thermal conductivity of liquid with respect to the dimensionless
parameter T/Tref.</p></li>
</ul>
</li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_ENERGY&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;thermal conductivity evaluator&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;TCM0&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{EntireDomain}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;thermal conductivity type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;one-phase polynomial&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;solid phase&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;eos type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;constant&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reference conductivity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.2&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reference temperature&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;298.15&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;liquid phase&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;eos type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;polynomial&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reference conductivity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.6&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;polynomial expansion&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{-1.48445, 4.12292, -1.63866}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gas phase&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="operators">
<h4>Operators<a class="headerlink" href="#operators" title="Link to this heading">#</a></h4>
<p>This section contains sublist for diffusion and advection operators.
It also has one global parameter.</p>
<div class="admonition-operators-spec admonition">
<p class="admonition-title">operators-spec</p>
<ul class="simple">
<li><p><cite>“operators</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code></p>
<ul>
<li><p><cite>“include enthalpy in preconditioner</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> allows us to study impact (usually positive)
of including enthalpy term in the preconditioner. Default value is <em>true</em>.</p></li>
<li><p><cite>“diagonal shift</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> allows for a constant shift to be applied to
the diagonal of the assembled operator, which can b useful for dealing
with singular or near-singular matrices.  Default is <em>0.0</em>.</p></li>
</ul>
</li>
</ul>
</div>
<section id="diffusion-operator">
<h5>Diffusion operator<a class="headerlink" href="#diffusion-operator" title="Link to this heading">#</a></h5>
<p>Operators sublist describes the PDE structure of the flow, specifies a discretization
scheme, and selects assembling schemas for matrices and preconditioners.</p>
<div class="admonition-diffusion-op-spec admonition">
<p class="admonition-title">diffusion_op-spec</p>
<ul class="simple">
<li><p><cite>“diffusion operator</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines parameters for generating and assembling diffusion matrix.</p>
<ul>
<li><p><cite>“matrix</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines parameters for generating and assembling diffusion matrix. See section
describing operators.</p></li>
<li><p><cite>“preconditioner</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines parameters for generating and assembling diffusion
matrix that is used to create preconditioner.
Since update of preconditioner can be lagged, we need two objects called <cite>“matrix</cite>” and <cite>“preconditioner</cite>”.</p></li>
</ul>
</li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;operators&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;include enthalpy in preconditioner&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;boll&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;diffusion operator&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;matrix&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization primary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: optimized for monotonicity&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization secondary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: optimized for sparsity&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face, cell}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioner schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;upwind method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;standard: cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioner&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization primary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: optimized for monotonicity&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization secondary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: optimized for sparsity&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face, cell}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioner schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Newton correction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;approximate Jacobian&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;upwind method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;standard: cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>This example uses cell-centered discretization for</p>
</section>
<section id="advection-operator">
<h5>Advection operator<a class="headerlink" href="#advection-operator" title="Link to this heading">#</a></h5>
<p>This section to be written.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;operators&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;advection operator&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;upwind&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="id11">
<h4>Sources and sinks<a class="headerlink" href="#id11" title="Link to this heading">#</a></h4>
<p>The sources and sinks for injecting and removing energy from the system.
Negative source removes energy.
Positive source inject energy.
The structure of list <em>source terms</em> mimics that of list <em>boundary conditions</em>.
Again, constant functions can be replaced by any of the available functions.</p>
<div class="admonition-sources-spec admonition">
<p class="admonition-title">sources-spec</p>
<ul class="simple">
<li><p><cite>“regions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> is the list of regions where the source is defined.</p></li>
<li><p><cite>“spatial distribution method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the method for distributing
source Q over the specified regions. The available options are <cite>“volume</cite>” and
<cite>“none</cite>”.
For option <cite>“none</cite>”, the source term function Q is measured in [J/m^3/s].
For option <cite>“volume</cite>”, it is measured in [J/s].
When the source function is defined over a few regions, Q is distributed over their union.
Option <cite>“volume fraction</cite>” can be used when the region geometric
model support volume fractions.</p></li>
<li><p><cite>“use volume fractions</cite>” instructs the code to use all available volume fractions.
Note that the region geometric model supports volume fractions only for a few regions.</p></li>
<li><p><cite>“submodel</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> refines definition of the source. Available options are <cite>“rate</cite>”,
<cite>“integrated source</cite>”. The first option defines the source
in a natural way as the rate of change <cite>q</cite>. The second option defines the indefinite
integral <cite>Q</cite> of the rate of change, i.e. the source term is calculated as <cite>q = dQ/dt</cite>.
Default is <cite>“rate</cite>”.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;energy&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;source terms&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_SRC 0&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_WELL_EAST}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial distribution method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;volume&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;submodel&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;rate&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;source&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;-0.1&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="navier-stokes-pk">
<span id="pk-navier-stokes"></span><h3><a class="toc-backref" href="#id63" role="doc-backlink">Navier Stokes PK</a><a class="headerlink" href="#navier-stokes-pk" title="Link to this heading">#</a></h3>
<p>The conceptual PDE model for the incompressible Navier Stokes equations are</p>
<div class="math notranslate nohighlight">
\[\frac{\partial (\rho \boldsymbol{u})}{\partial t}
+ \boldsymbol{\nabla} \cdot (\rho \boldsymbol{u} \otimes \boldsymbol{u})
=
- \boldsymbol{\nabla} p
+ \boldsymbol{\nabla} \cdot \boldsymbol{\sigma}
+ \rho \boldsymbol{g}\]</div>
<p>where
<span class="math notranslate nohighlight">\(\rho\)</span> is the fluid density [kg/m^3],
<span class="math notranslate nohighlight">\(p\)</span> is the pressure [Pa],
<span class="math notranslate nohighlight">\(\boldsymbol{\sigma}\)</span> is the deviatoric stress tensor,
<span class="math notranslate nohighlight">\(\boldsymbol{g}\)</span> is the gravity vector [<span class="math notranslate nohighlight">\(m/s^2\)</span>],
and <span class="math notranslate nohighlight">\(u \otimes v = u \times v^T\)</span>.
The Stokes stress contitutive law for incompressible viscous fluid is</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\sigma} =
\mu \left(\boldsymbol{\nabla} \boldsymbol{u} +
          \boldsymbol{\nabla} \boldsymbol{u}^{T}\right),\]</div>
<p>where
<span class="math notranslate nohighlight">\(\mu\)</span> is the dynamic viscosity [<span class="math notranslate nohighlight">\(Pa \cdot s\)</span>]. It can depend on density and pressure.</p>
<section id="id12">
<h4>Physical models and assumptions<a class="headerlink" href="#id12" title="Link to this heading">#</a></h4>
<p>This list is used to summarize physical models and assumptions, such as
coupling with other PKs.
This list is often generated on a fly by a high-level MPC PK.</p>
<ul class="simple">
<li><p><cite>“gravity</cite>” [bool] is set up automatically by a high-level PK.
The default value is <cite>“false</cite>”.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_NAVIER_STOKES&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;physical models and assumptions&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="id13">
<h4>Operators<a class="headerlink" href="#id13" title="Link to this heading">#</a></h4>
<p>This section contains sublist for diffusion and advection operators.
It also has one global parameter.</p>
<div class="admonition-ns-operators-spec admonition">
<p class="admonition-title">ns_operators-spec</p>
<ul class="simple">
<li><p><cite>“operators</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code></p></li>
</ul>
</div>
<section id="elasticity-operator">
<h5>Elasticity operator<a class="headerlink" href="#elasticity-operator" title="Link to this heading">#</a></h5>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;operators&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;elasticity operator&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;BernardiRaugel&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;base&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;location&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{node, face}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{vector, normal component}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="convection-operator">
<h5>Convection operator<a class="headerlink" href="#convection-operator" title="Link to this heading">#</a></h5>
<p>This section to be written.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;operators&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;convection operator&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flux formula&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Rusanov&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="divergence-operator">
<h5>Divergence operator<a class="headerlink" href="#divergence-operator" title="Link to this heading">#</a></h5>
<p>This section to be written.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;operators&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;divergence operator&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;BernardiRaugel&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema domain&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;base&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;location&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{node, face}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{scalar, normal component}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema range&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;base&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;location&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{cell}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{scalar}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="multiphase-pk">
<span id="pk-multiphase"></span><h3><a class="toc-backref" href="#id64" role="doc-backlink">Multiphase PK</a><a class="headerlink" href="#multiphase-pk" title="Link to this heading">#</a></h3>
<section id="id14">
<h4>Mathematical models<a class="headerlink" href="#id14" title="Link to this heading">#</a></h4>
<p>The conceptual PDE model for the isothermal multiphase flow include
transport equations for components and nonlinear algebraic constraints for the phase presence.
At the moment we consider two phases (liquid and gas), multiple components, and one
constraint.
Each transport equation has the following form:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \Theta}{\partial t}
+ \nabla \cdot \boldsymbol{\Psi} = Q,\]</div>
<p>where
<span class="math notranslate nohighlight">\(\Theta\)</span> is the storage and
<span class="math notranslate nohighlight">\(\boldsymbol{\Psi}\)</span> is the flux.
The storage term sums up component amount across two phases, <span class="math notranslate nohighlight">\(\alpha=l\)</span> for liquid
phase and <span class="math notranslate nohighlight">\(\alpha=g\)</span> for gas phase:</p>
<div class="math notranslate nohighlight">
\[\Theta = \phi \sum_\alpha \eta_\alpha x_\alpha s_\alpha\]</div>
<p>where
<span class="math notranslate nohighlight">\(\phi\)</span> is porosity [-],
<span class="math notranslate nohighlight">\(\eta\)</span> is molar density [mol/m^3],
<span class="math notranslate nohighlight">\(x\)</span> is molar fraction of component [-], and
<span class="math notranslate nohighlight">\(s\)</span> is phase saturation [-].</p>
<p>The flux includes advective (wrt volumetric flux) and diffusive terms:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\Psi}
= -\sum_\alpha \eta_\alpha \left(\boldsymbol{q}_\alpha + D_\alpha \nabla x \right)\]</div>
<p>where
<span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span> is Darcy phase velocity,
<span class="math notranslate nohighlight">\(D\)</span> is molecular duffusion coefficient.</p>
<p>The nonlinear algebraic constraint may have different forms. One of the available forms is</p>
<div class="math notranslate nohighlight">
\[min (s_g, 1 - \sum\limits_i x_g^i) = 0.\]</div>
<p>It implies that if gas compounent is present, then the sum of component
mole fractions on the gas phase must be equal to 1.</p>
<p>The test examples illustrate three choices of primary variables for various models.
The first one includes pressure liquid, mole gas fraction, and saturation liquid.
The second one includes pressure liquid, molar gas density, and saturation liquid.
The third one is based on the model in Jaffre’s paper.
This model describes the two-phase two-component system with water and hydrogen.</p>
<p>The structure of a system of multiphase equations is described by sublist <cite>“system</cite>” which
contains as many blocks as there are equations. The names of blocks are currently reserved
and cannot be changed. Each block except for the “constraint eqn” has the following parameters:</p>
<div class="admonition-multiphase-pk-spec admonition">
<p class="admonition-title">multiphase_pk-spec</p>
<ul class="simple">
<li><p><cite>“primary unknown</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines a name of the primary variable which goes into
a solution vector.</p></li>
<li><p><cite>“accumulation</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines an evaluator for the accumulattion (or storage) term
in this equation.</p></li>
<li><p><cite>“terms</cite>” [list] specifies details of underluing PDE operators. The list constains as
many sublists as there are operators. Some of the operators can be considered either as
diffusion operators with respect to particular fields or as advection operators associate
with a Darcy velocities. We input parameters follow the diffusion viewpoint for
all operators.</p>
<ul>
<li><p><cite>“coefficient</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defined the diffusion coefficient.</p></li>
<li><p><cite>“argument</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines a field for which the operator has the diffusion structure.</p></li>
<li><p><cite>“scaling factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines a scalar multiplier for the operator.</p></li>
<li><p><cite>“phase</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> specifies a phase accosiated with the operator. It is used to upwind
the diffusion coefficient w.r.t. to the corresponding Darcy velocity.</p></li>
</ul>
</li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;system&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pressure eqn&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;primary unknown&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;pressure_liquid&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;accumulation&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;total_water_storage&quot;</span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;terms&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;advection&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;coefficient&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;advection_water&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;argument&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;pressure_liquid&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;scaling factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;phase&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;diffusion&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;coefficient&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;diffusion_liquid&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;argument&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;molar_density_liquid&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;scaling factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;-0.2&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;phase&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;constraint eqn&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;primary unknown&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;saturation_liquid&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ncp evaluators&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{ ncp_f, ncp_g }&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>The available boundary conditions include the prescibed pressure, total influx, and saturation.</p>
</section>
</section>
<section id="shallow-water-pk">
<span id="pk-shallow-water"></span><h3><a class="toc-backref" href="#id65" role="doc-backlink">Shallow water PK</a><a class="headerlink" href="#shallow-water-pk" title="Link to this heading">#</a></h3>
<section id="reconstruction-and-limiters">
<h4>Reconstruction and limiters<a class="headerlink" href="#reconstruction-and-limiters" title="Link to this heading">#</a></h4>
<p>The control of the second-order numerical scheme is done via <cite>“reconstruction</cite>”
sublist, described in <a class="reference internal" href="#reconstruction">Reconstruction</a>. Here is the example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;shallow water&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reconstruction&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell-based&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;polynomial order&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;weight&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;constant&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limiter&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Barth-Jespersen&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limiter stencil&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell to closest cells&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limiter location&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;node&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limiter points&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limiter cfl&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.1&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="mechanics-pk">
<span id="pk-mechanics"></span><h3><a class="toc-backref" href="#id66" role="doc-backlink">Mechanics PK</a><a class="headerlink" href="#mechanics-pk" title="Link to this heading">#</a></h3>
<p>The conceptual PDE model for the quasi-static elastic deformation is</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\nabla} \cdot (C \varepsilon(\boldsymbol{d}))
=
\rho \boldsymbol{g}\]</div>
<p>where
<span class="math notranslate nohighlight">\(\boldsymbol{d}\)</span> is the displacement [m],
<span class="math notranslate nohighlight">\(\rho\)</span> is the rock density [kg/m^3],
<span class="math notranslate nohighlight">\(\boldsymbol{\varepsilon}\)</span> is the strain tensor,
and
<span class="math notranslate nohighlight">\(\boldsymbol{g}\)</span> is the gravity vector [<span class="math notranslate nohighlight">\(m/s^2\)</span>].</p>
<p>For a linear elasticity problem, the stress tensor <span class="math notranslate nohighlight">\(C\)</span> is a linear operator
acting on the strain tensor.
In general, the stress tensor is a nonlinear operator.</p>
<section id="id15">
<h4>Global parameters<a class="headerlink" href="#id15" title="Link to this heading">#</a></h4>
<p>Global parameters are placed in the sublist <cite>“mechanics</cite>”.
The list of global parameters include:</p>
<div class="admonition-mechanics-pk-spec admonition">
<p class="admonition-title">mechanics_pk-spec</p>
<ul class="simple">
<li><p><cite>“domain name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies mesh name that defined domain of this PK.
Default is <cite>“domain</cite>”.</p></li>
</ul>
</div>
</section>
<section id="id16">
<h4>Physical models and assumptions<a class="headerlink" href="#id16" title="Link to this heading">#</a></h4>
<p>This list is used to summarize physical models and assumptions, such as
coupling with other PKs.
This list is often generated or extended by a high-level MPC PK.</p>
<div class="admonition-mechanics-assumptions-spec admonition">
<p class="admonition-title">mechanics_assumptions-spec</p>
<ul class="simple">
<li><p><cite>“use gravity</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> defines non-zero source term. Default is <em>false</em>.</p></li>
<li><p><cite>“biot scheme: undrained split</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> defines iterative coupling with
a flow PK where mechanics is solved first.</p></li>
<li><p><cite>“biot scheme: fixed-stress split</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> defines iterative coupling with
a flow PK where flow is solved first.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mechanics&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;physical models and assumptions&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;use gravity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;biot scheme: undrained split&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;biot scheme: fixed stress split&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="main-sublists">
<h4>Main sublists<a class="headerlink" href="#main-sublists" title="Link to this heading">#</a></h4>
<p>The following sublists are needed to create and control this PK:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mechanics&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time integrator&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;operators&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;physical models and assumptions&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
</section>
<section id="nonlinear-material-models">
<h4>Nonlinear material models<a class="headerlink" href="#nonlinear-material-models" title="Link to this heading">#</a></h4>
<p>Currently, the only available option is the Hardin-Drnevich hyperbolic model.
Recall that</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\sigma} = 2 G {\rm dev}(\varepsilon) + K {\rm trace}(\varepsilon) \boldsymbol{I}\]</div>
<p>where <span class="math notranslate nohighlight">\(K\)</span> is the bulk modulus and <span class="math notranslate nohighlight">\(G\)</span> is the shear modulus.
The shear modulus is a nonlinear function of shear strain <span class="math notranslate nohighlight">\(\gamma\)</span>:</p>
<div class="math notranslate nohighlight">
\[G = G_{max} \left(1 + \displaystyle\frac{\gamma}{\gamma_{ref}}\right)^{-1}\]</div>
<p>where <span class="math notranslate nohighlight">\(G_{max}\)</span> is the maximum shear modulus and <span class="math notranslate nohighlight">\(\gamma_{ref}\)</span> is the
reference shear strain.
The model parameters are placed in the following sublist:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;small strain models&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;All&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{All}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Hardin Drnevich&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reference shear strain&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.8&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;maximum shear stress&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;70.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="id17">
<h4>Boundary conditions<a class="headerlink" href="#id17" title="Link to this heading">#</a></h4>
<p>Boundary conditions are defined in sublist <em>boundary conditions</em>.
Two types of boundary conditions are supported.
Each type has a similar structure: a list of identical elements that contain
information about a part of the boundary where it is prescribed and a function
to calculate it.</p>
<div class="admonition-mechanics-boundary-conditions-spec admonition">
<p class="admonition-title">mechanics_boundary_conditions-spec</p>
<ul class="simple">
<li><p><cite>“displacement</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> is the Dirichlet boundary condition where the displacement
is prescribed on a part of the boundary surface.</p></li>
<li><p><cite>“traction</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> is the Neumann boundary condition where an outward traction
is prescribed on a part of the boundary surface.
This is the default boundary condition.</p></li>
<li><p><cite>“kinematic</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> is the kinematic boundary condition, the essential condition
for the normal velocity.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mechanics&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;displacement&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;BC_0&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_SURFACE_0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial distribution method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;no slip&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of dofs&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;composite function&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dof 1 function&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">        </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dof 2 function&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">          </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">        </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;traction&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;BC_1&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_SURFACE_1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial distribution method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;traction&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- similar to the displacement boundary condition --&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="coupled-pks-mpcs">
<h2><a class="toc-backref" href="#id67" role="doc-backlink">COUPLED PKs (MPCs)</a><a class="headerlink" href="#coupled-pks-mpcs" title="Link to this heading">#</a></h2>
<p>Coupling of process kernels requires additional parameters for PK
described above.</p>
<div class="admonition-mpcs-typed-spec admonition">
<p class="admonition-title">mpcs-typed-spec</p>
<ul class="simple">
<li><p><cite>“reactive transport</cite>” See <a class="reference internal" href="#mpc-reactive-transport">MPC: Reactive Transport</a></p></li>
<li><p><cite>“flow reactive transport</cite>” See <a class="reference internal" href="#mpc-flow-and-reactive-transport">MPC: Flow and Reactive Transport</a></p></li>
<li><p><cite>“thermal flow</cite>” See <a class="reference internal" href="#mpc-thermal-flow">MPC: Thermal Flow</a></p></li>
<li><p><cite>“darcy matrix fracture</cite>” See <a class="reference internal" href="#mpc-flow-in-fractured-rock">MPC: Flow in Fractured Rock</a></p></li>
</ul>
</div>
<section id="reactive-transport-pk">
<span id="mpc-reactive-transport"></span><h3><a class="toc-backref" href="#id68" role="doc-backlink">Reactive transport PK</a><a class="headerlink" href="#reactive-transport-pk" title="Link to this heading">#</a></h3>
<p>Process kernel for coupling of Transport_PK and Chemistry_PK.
Reactive transport can be setup using a steady-state flow.
The two PKs are executed consequitively.
The input spec requires new keyword <em>reactive transport</em>.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK tree&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_REACTIVE TRANSPORT&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;reactive transport&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_TRANSPORT&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;transport&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_CHEMISTRY&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;chemistry amanzi&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="flow-and-reactive-transport-pk">
<span id="mpc-flow-and-reactive-transport"></span><h3><a class="toc-backref" href="#id69" role="doc-backlink">Flow and reactive transport PK</a><a class="headerlink" href="#flow-and-reactive-transport-pk" title="Link to this heading">#</a></h3>
<p>PK for coupling of Flow PK with Transport_PK and Chemistry_PK
Amanzi uses operator splitting approach for coupled physical kernels.
The coupling of PKs is described as a tree where flow and reactive
transport are executed consequitively.
The input spec requires new keyword <em>flow reactive transport</em>.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK tree&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_FLOW and REACTIVE TRANSPORT&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;flow reactive transport&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_FLOW&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;darcy&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_REACTIVE TRANSPORT&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;reactive transport&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_TRANSPORT&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;transport&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_CHEMISTRY&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;chemistry amanzi&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>This example describe four PKs identified by keywords <em>darcy</em>, <em>reactive transport</em>,
<em>transport</em>, and <em>chemistry amanzi</em>.
The flow is fully saturated.
The transport of reactive chemicals is based on the native chemistry package <em>chemistry amanzi</em>.</p>
<p>Details of PKs are organized as a plain list of ParameterLists.
Note that <em>reactive transport</em> is MPC-PK and hence its description is short.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PKs&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_FLOW and REACTIVE TRANSPORT&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;flow reactive transport&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PKs order&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_FLOW, _REACTIVE TRANSPORT}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;master PK index&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>

<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_REACTIVE TRANSPORT&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PK type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;reactive transport&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PKs order&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_CHEMISTRY, _TRANSPORT}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>

<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_FLOW&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span>...
<span class="nt">&lt;/ParameterList&gt;</span>

<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_TRANSPORT&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span>...
<span class="nt">&lt;/ParameterList&gt;</span>

<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_CHEMISTRY&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span>...
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="thermal-flow-pk">
<span id="mpc-thermal-flow"></span><h3><a class="toc-backref" href="#id70" role="doc-backlink">Thermal flow PK</a><a class="headerlink" href="#thermal-flow-pk" title="Link to this heading">#</a></h3>
<p>Process kernel that strongly couples Flow PK with Energy PK.
The conceptual PDE model of the coupled flow and energy equations is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\frac{\partial \theta}{\partial t}
=
- \boldsymbol{\nabla} \cdot (\eta_l \boldsymbol{q}_l)
- \boldsymbol{\nabla} \cdot (\phi s_g \tau_g D_g \boldsymbol{\nabla} X_g) + Q_1,
\quad
\boldsymbol{q}_l
= -\frac{\boldsymbol{K} k_r}{\mu}
(\boldsymbol{\nabla} p - \rho_l \boldsymbol{g}) \\
%
\frac{\partial \varepsilon}{\partial t}
=
\boldsymbol{\nabla} \cdot (\kappa \nabla T) -
\boldsymbol{\nabla} \cdot (\eta_l H_l \boldsymbol{q}_l) + Q_2
\end{array}\end{split}\]</div>
<p>In the first equation,
<span class="math notranslate nohighlight">\(\theta\)</span> is total water storage (we use non-conventional definition) [<span class="math notranslate nohighlight">\(mol/m^3\)</span>],
<span class="math notranslate nohighlight">\(\eta_l\)</span> is molar density of liquid [<span class="math notranslate nohighlight">\(mol/m^3\)</span>],
<span class="math notranslate nohighlight">\(\rho_l\)</span> is fluid density [<span class="math notranslate nohighlight">\(kg/m^3\)</span>],
<span class="math notranslate nohighlight">\(Q_1\)</span> is source or sink term,
<span class="math notranslate nohighlight">\(\boldsymbol{q}_l\)</span> is the Darcy velocity [m/s],
<span class="math notranslate nohighlight">\(k_r\)</span> is relative permeability [-],
<span class="math notranslate nohighlight">\(\boldsymbol{g}\)</span> is gravity [<span class="math notranslate nohighlight">\(m/s^2\)</span>],
<span class="math notranslate nohighlight">\(\phi\)</span> is porosity [-],
<span class="math notranslate nohighlight">\(s_g\)</span> is gas saturation (water vapor) [-],
<span class="math notranslate nohighlight">\(\tau_g\)</span> is tortuosity of gas [-],
<span class="math notranslate nohighlight">\(D_g\)</span> is diffusion coefficient,
and <span class="math notranslate nohighlight">\(X_g\)</span> is molar fraction of water in the gas phase [-].
We define</p>
<div class="math notranslate nohighlight">
\[\theta = \phi (s_g \eta_g X_g + s_l \eta_l)\]</div>
<p>where
<span class="math notranslate nohighlight">\(s_l\)</span> is liquid saturation [-],
and <span class="math notranslate nohighlight">\(\eta_g\)</span> is molar density of gas.</p>
<p>In the second equation,
<span class="math notranslate nohighlight">\(\varepsilon\)</span> is the energy density [<span class="math notranslate nohighlight">\(J/mol^3\)</span>],
<span class="math notranslate nohighlight">\(Q_2\)</span> is source or sink term,
<span class="math notranslate nohighlight">\(\kappa\)</span> is thermal conductivity [W/m/K],
<span class="math notranslate nohighlight">\(H_l\)</span> is molar enthalphy of liquid [J/mol],
and <span class="math notranslate nohighlight">\(T\)</span> is temperature [K].
We define</p>
<div class="math notranslate nohighlight">
\[\varepsilon = \phi (\eta_l s_l U_l + \eta_g s_g U_g) +
(1 - \phi) \rho_r c_r T\]</div>
<p>where
<span class="math notranslate nohighlight">\(U_l\)</span> is molar internal energy of liquid [J/mol],
<span class="math notranslate nohighlight">\(U_g\)</span> is molar internal energy of gas (water vapor) [J/mol],
<span class="math notranslate nohighlight">\(\rho_r\)</span> is rock density [kg/m^3],
and <span class="math notranslate nohighlight">\(c_r\)</span> is specific heat of rock [J/kg/K].</p>
<section id="id18">
<h4>Diffusion operator<a class="headerlink" href="#id18" title="Link to this heading">#</a></h4>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_NAVIER_STOKES&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent lists --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;operator&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;diffusion operator&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;vapor matrix&quot;</span><span class="nt">&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization primary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: optimized for sparsity&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization secondary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: optimized for sparsity&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face, cell}&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nonlinear coefficient&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;standard: cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;exclude primary terms&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;scaled constraint equation&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Newton correction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w"> </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w"> </span><span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="coupled-matrix-fracture-darcy-flow-pk">
<span id="mpc-flow-in-fractured-rock"></span><h3><a class="toc-backref" href="#id71" role="doc-backlink">Coupled matrix-fracture Darcy flow PK</a><a class="headerlink" href="#coupled-matrix-fracture-darcy-flow-pk" title="Link to this heading">#</a></h3>
<p>The process kernel that couples Darcy flow in matrix and fracture network.</p>
<section id="id19">
<h4>Mathematical models<a class="headerlink" href="#id19" title="Link to this heading">#</a></h4>
<p>Let subscripts <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(f\)</span> correspond to matrix and fracture, respectively.
The conceptual PDE model of the stationary coupled matrix-fracture flow is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\phi_m \frac{S_{s,m}}{g} \frac{\partial p_m}{\partial t}
+ \boldsymbol{\nabla} \cdot (\rho_l \boldsymbol{q}_m) = Q_m,
\quad
\boldsymbol{q}_m = -\frac{\boldsymbol{K}_m}{\mu}
(\boldsymbol{\nabla} p_m - \rho_l \boldsymbol{g}) \\
%
\phi_f \frac{S_{s,f}}{g} \frac{\partial p_f}{\partial t}
+ \boldsymbol{\nabla} \cdot (\rho_l \boldsymbol{q}_f) =
  -\rho_l [[ \tilde{\boldsymbol{q}}_m \cdot \boldsymbol{n} ]],
\quad
\boldsymbol{q}_f = -\frac{\boldsymbol{K}_f}{\mu}
(\boldsymbol{\nabla} p_f - \rho_l \boldsymbol{g}) \\
%
\tilde{\boldsymbol{q}}_m \cdot \boldsymbol{n} = \frac{k}{g} (p_f - p_m)
\end{array}\end{split}\]</div>
<p>subject to convential boundary conditions for both matrix and fracture domains expect for
the matrix-fracture boundary where the boundary condition is</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{q}_m \cdot \boldsymbol{n} = \tilde{\boldsymbol{q}}_m \cdot \boldsymbol{n}\]</div>
<p>Here
<span class="math notranslate nohighlight">\(\rho_l\)</span> is fluid density [kg/m^3],
<span class="math notranslate nohighlight">\(\phi\)</span> is porosity [-],
<span class="math notranslate nohighlight">\(S_s\)</span> is ispecific storage [m],
<span class="math notranslate nohighlight">\(p\)</span> is aqueous pressure [Pa],
<span class="math notranslate nohighlight">\(\boldsymbol{K}\)</span> is absolute permeability [m^2] for matrix domain and [m^3] for fracture domain,
<span class="math notranslate nohighlight">\(Q_m\)</span> is source or sink term,
<span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span> is the Darcy velocity [m/s] for matrix domain and [m^2/s] for fracture domain,
<span class="math notranslate nohighlight">\(k\)</span> is effective normal premeability [s^-1],
and
<span class="math notranslate nohighlight">\(\boldsymbol{g}\)</span> is gravity [<span class="math notranslate nohighlight">\(m/s^2\)</span>].</p>
</section>
<section id="main-parameters-and-sublists">
<h4>Main parameters and sublists<a class="headerlink" href="#main-parameters-and-sublists" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><cite>“PKs order</cite>” [array(string)] defines user names for two flow PKs. The matrix PK should be
defined <em>first</em>.</p></li>
<li><p><cite>“time integrator</cite>” [list] defines a generic time integrator used by the cycle driver.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PKs&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_COUPLED DARCY FLOW&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;PKs order&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_FLOW MATRIX, _FLOW FRACTURE}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;master PK index&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time integrator&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>...
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="aperture-models">
<h4>Aperture models<a class="headerlink" href="#aperture-models" title="Link to this heading">#</a></h4>
<p>The Barton-Bandis aperture-stress relationship is defined by initial aperture
<span class="math notranslate nohighlight">\(a_0\)</span>, overbuden pressure/normal stress <span class="math notranslate nohighlight">\(p_{ov}\)</span>, fluid pressure
<span class="math notranslate nohighlight">\(p_f\)</span>, and two fitting parameters A and B:</p>
<div class="math notranslate nohighlight">
\[a = a_0 - \frac{A (p_{ov} - p_f)}{1 + B (p_{ov} - p_f)}\]</div>
<ul class="simple">
<li><p><cite>“undeformed aperture</cite>” [double] aperture at zero effective normal stress</p></li>
<li><p><cite>“overburden pressure</cite>” [double] overburden pressure/total normal stress</p></li>
<li><p><cite>“BartonBandis A</cite>” [double] fitting parameter, <span class="math notranslate nohighlight">\([m / Pa]\)</span></p></li>
<li><p><cite>“BartonBandis B</cite>” [double] fitting parameter, <span class="math notranslate nohighlight">\([Pa^{-1}]\)</span></p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;fracture aperture models&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;FAM 0&quot;</span><span class="nt">&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;fracture aperture model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Barton Bandis&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{RegionBottom}&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;undeformed aperture&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-5&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;overburden pressure&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e+10&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;BartonBandis A&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2.22e-5&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;BartonBandis B&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3.47e-2&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>The exponential aperture-stress relationship is defined by initial aperture
<span class="math notranslate nohighlight">\(a_0\)</span>, overbuden pressure/normal stress <span class="math notranslate nohighlight">\(p_{ov}\)</span>, fluid pressure
<span class="math notranslate nohighlight">\(p_f\)</span>, and fracture compressibility (fitting parameter) <span class="math notranslate nohighlight">\(alpha\)</span>:</p>
<div class="math notranslate nohighlight">
\[a = a_0 \exp{\alpha (p_{ov} - p_f)}\]</div>
<ul class="simple">
<li><p><cite>“undeformed aperture</cite>” [double] aperture at zero effective normal stress</p></li>
<li><p><cite>“overburden pressure</cite>” [double] overburden pressure/total normal stress</p></li>
<li><p><cite>“compressibility</cite>” [double] fracture compressibility, <span class="math notranslate nohighlight">\([Pa^{-1}]\)</span></p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;fracture aperture models&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;FAM 0&quot;</span><span class="nt">&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;fracture aperture model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;exponential law&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{RegionBottom}&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;undeformed aperture&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-5&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;overburden pressure&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e+10&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;compressibility&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0e-11&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="thermoporoelasticty-pk">
<h3><a class="toc-backref" href="#id72" role="doc-backlink">Thermoporoelasticty PK</a><a class="headerlink" href="#thermoporoelasticty-pk" title="Link to this heading">#</a></h3>
<p>Sequential coupling of fully flow and mechanics PKs via the fixed stress
split algorithm.
The conceptual PDE model of the coupled flow and mechanics equations is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
-\boldsymbol{\nabla} \cdot (C \varepsilon(\boldsymbol{d})) + \alpha \nabla p + \beta_r \nabla T
=
\rho \boldsymbol{g} \\[1ex]
%
\displaystyle\frac{\partial (\eta \phi)}{\partial t}
=
- \boldsymbol{\nabla} \cdot (\eta \boldsymbol{q}) + Q_1\\[1ex]
%
\displaystyle\frac{\partial (\phi\, \eta\, U_l + (1 - \phi) \rho_r U_r)}{\partial t}
=
\boldsymbol{\nabla} \cdot (\kappa \nabla T) -
\boldsymbol{\nabla} \cdot (\eta\, H\, \boldsymbol{q}) + Q_2.
\end{array}\end{split}\]</div>
<p>In the first equation,
<span class="math notranslate nohighlight">\(C\)</span> is elasticity tensor [Pa],
<span class="math notranslate nohighlight">\(\varepsilon\)</span> is stain tensor [-],
<span class="math notranslate nohighlight">\(\boldsymbol{d}\)</span> is displacement [m],
<span class="math notranslate nohighlight">\(\rho\)</span> is density of liquid [<span class="math notranslate nohighlight">\(kg/m^3\)</span>],
<span class="math notranslate nohighlight">\(\alpha\)</span> is Biot coefficient [-],
<span class="math notranslate nohighlight">\(\beta_r\)</span> is thermal stress coefficient [<span class="math notranslate nohighlight">\(Pa/K\)</span>],
<span class="math notranslate nohighlight">\(\boldsymbol{g}\)</span> is gravity [<span class="math notranslate nohighlight">\(m/s^2\)</span>],
<span class="math notranslate nohighlight">\(p\)</span> is pressure [Pa],
and
<span class="math notranslate nohighlight">\(T\)</span> is temperature [K].</p>
<p>In the second equation,
<span class="math notranslate nohighlight">\(\eta\)</span> is molar density of liquid [<span class="math notranslate nohighlight">\(mol/m^3\)</span>],
<span class="math notranslate nohighlight">\(\phi\)</span> is porosity [-],
<span class="math notranslate nohighlight">\(Q_1\)</span> is source or sink term,
and
<span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span> is Darcy velocity [m/s].
The porosity model is</p>
<div class="math notranslate nohighlight">
\[\phi = \phi_0 + \alpha\, {\rm div}\, \varepsilon + c_0\,(p - p_0) - \beta_l (T - T_0).\]</div>
<p>where
<span class="math notranslate nohighlight">\(\beta_l\)</span> is thermal dilation coefficient [<span class="math notranslate nohighlight">\(Pa/K\)</span>],
<span class="math notranslate nohighlight">\(c_0\)</span> is pore compressibility [<span class="math notranslate nohighlight">\(Pa^{-1}\)</span>],
<span class="math notranslate nohighlight">\(p_0\)</span> is reference pressure [<span class="math notranslate nohighlight">\(Pa\)</span>],
and
<span class="math notranslate nohighlight">\(T_0\)</span> is reference temperature [<span class="math notranslate nohighlight">\(K\)</span>].
Currently <span class="math notranslate nohighlight">\(T_0 = 0^\circ C\)</span>.</p>
<p>In the third equation,
<span class="math notranslate nohighlight">\(\kappa\)</span> is thermal conductivity,
<span class="math notranslate nohighlight">\(U_l\)</span> is internal energy of liquid [J/mol],
<span class="math notranslate nohighlight">\(U_r\)</span> is internal energy of rock [J/kg],
<span class="math notranslate nohighlight">\(H\)</span> is molar enthalpy of liquid [J/mol],
<span class="math notranslate nohighlight">\(\rho_r\)</span> is rock density [<span class="math notranslate nohighlight">\(kg/m^3\)</span>],
and
<span class="math notranslate nohighlight">\(Q_2\)</span> is heat source term.
The internal energies are based on linear models:</p>
<div class="math notranslate nohighlight">
\[U_i = c_i\,(T - T_0),\quad i=l,r,\]</div>
<p>where <span class="math notranslate nohighlight">\(c_i\)</span> are specific heat capacities.</p>
</section>
</section>
<section id="generic-capabilities">
<h2><a class="toc-backref" href="#id73" role="doc-backlink">GENERIC CAPABILITIES</a><a class="headerlink" href="#generic-capabilities" title="Link to this heading">#</a></h2>
<p>Collection of generic tools used by PKs.</p>
<section id="id20">
<h3><a class="toc-backref" href="#id74" role="doc-backlink">Operators</a><a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
<p>Operators are discrete forms of linearized PDEs operators.
They form a layer between physical process kernels and solvers
and include accumulation, diffusion, advection, elasticity, reaction,
and source operators.
The residual associated with an operator <span class="math notranslate nohighlight">\(L_h\)</span> helps to
understand the employed sign convention:</p>
<div class="math notranslate nohighlight">
\[r = f - L_h u.\]</div>
<p>Operator represents a map from linear space X to linear space Y.  Typically,
this map is a linear map, and encapsulates much of the discretization involved
in moving from continuous to discrete equations. The spaces X and Y are described
by CompositeVectors (CV). A few maps X-&gt;Y are supported.</p>
<p>An operator provides an interface for applying both the forward and inverse
linear map (assuming the map is invertible).</p>
<p>Typically the Operator is never seen by the user; instead the user provides
input information for helper classes based on the continuous mathematical
operator and the desired discretization.  These helpers build the needed
<code class="docutils literal notranslate"><span class="pre">Operator</span></code>, which may include information from multiple helpers (i.e. in the
case of Jacobian Operators for a PDE).</p>
<p>However, one option may be provided by the user, which is related to dealing
with nearly singular operators:</p>
<div class="admonition-operators-spec admonition">
<p class="admonition-title">operators-spec</p>
<ul class="simple">
<li><p><cite>“diagonal shift</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>0.0</strong> Adds a scalar shift to the diagonal
of the <code class="docutils literal notranslate"><span class="pre">Operator</span></code>, which can be useful if the <code class="docutils literal notranslate"><span class="pre">Operator</span></code> is singular or
near-singular.</p></li>
</ul>
</div>
<p>A PK decides how to bundle operators in a collection of operators.
For example, an advection-diffusion problem may benefit from using
a single operator that combines two operators representing diffusion and advection process.
Collection of operators must be used for implicit solvers and for building preconditioners.
In such a case, the collections acts as a single operator.</p>
<p>Operators use a few tools that are generic in nature and can be used independently by PKs.
The list includes reconstruction and limiting algorithms.</p>
</section>
<section id="schema">
<h3><a class="toc-backref" href="#id75" role="doc-backlink">Schema</a><a class="headerlink" href="#schema" title="Link to this heading">#</a></h3>
<p>The operators use notion of schema to describe operator’s abstract structure.
Old operators use a simple schema which is simply the list of geometric objects where
scalar degrees of freedom are defined.
New operators use a list to define location, type, and number of degrees of freedom.
In addition, the base of local stencil is either <em>face</em> or <em>cell</em>.
A rectangular operator needs two schemas do describe its domain (called <cite>“schema domain</cite>”)
and its range (called <cite>“schema range</cite>”).
A square operator may use either two identical schema lists or a single list called <cite>“schema</cite>”.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pks operator name&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list--&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema domain&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;base&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;location&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{node, face}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{scalar, normal component}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 1}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema domain&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;base&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;location&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{node, face}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{scalar, normal component}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 1}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>This example describes a square operator with two degrees of freedom per mesh node and one
degree of freedom per mesh face.
The face-based degree of freedom is the normal component of a vector field.
Such set of degrees of freedom is used in the Bernardi-Raugel element for discretizing
Stokes equations.
Parameter <cite>“base</cite>” indicates that local matrices are associated with mesh cells.</p>
<section id="id21">
<h4>Diffusion operator<a class="headerlink" href="#id21" title="Link to this heading">#</a></h4>
<p>Diffusion is the most frequently used operator. It employs the old schema.</p>
<div class="admonition-diffusion-op-spec admonition">
<p class="admonition-title">diffusion_op-spec</p>
<ul class="simple">
<li><p><cite>“pks operator name</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> a PK specific name for the diffusion operator.</p>
<ul>
<li><p><cite>“discretization primary</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies an advanced discretization method that
has useful properties under some a priori conditions on the mesh and/or permeability tensor.
The available options are <cite>“mfd: optimized for sparsity</cite>”, <cite>“mfd: optimized for monotonicity</cite>”,
<cite>“mfd: default</cite>”, <cite>“mfd: support operator</cite>”, <cite>“mfd: two-point flux approximation</cite>”,
<cite>“fv: default</cite>”, and <cite>“nlfv: default</cite>”.
The first option is recommended for general meshes.
The second option is recommended for orthogonal meshes and diagonal absolute
permeability tensor.</p></li>
<li><p><cite>“discretization secondary</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies the most robust discretization method
that is used when the primary selection fails to satisfy all a priori conditions.
Default value is equal to that for the primary discretization.</p></li>
<li><p><cite>“diffusion tensor</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies additional properties of the diffusion tensor.
It allows us to solve problems with non-symmetric but positive definite tensors.
Available options are <em>symmetric</em> (default) and <em>nonsymmetric</em>.</p></li>
<li><p><cite>“nonlinear coefficient</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies a method for treating nonlinear diffusion
coefficient, if any. Available options are <cite>“none</cite>”, <cite>“upwind: face</cite>”, <cite>“divk: cell-face</cite>” (default),
<cite>“divk: face</cite>”, <cite>“standard: cell</cite>”, and <cite>“divk: cell-face-twin</cite>”.
Symmetry preserving methods are the divk-family of methods and the classical cell-centered
method (<cite>“standard: cell</cite>”). The first part of the name indicates the base scheme.
The second part (after the semi-column) indicates required components of the composite vector
that must be provided by a physical PK.
Default is <cite>“none</cite>”.</p></li>
<li><p><cite>“schema</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> defines the operator stencil. It is a collection of
geometric objects. It equals to <cite>“{cell}</cite>” for finite volume schemes.
It is typically <cite>“{face, cell}</cite>” for mimetic discretizations.</p></li>
<li><p><cite>“preconditioner schema</cite>” [Array(string)] defines the preconditioner stencil.
It is needed only when the default assembling procedure is not desirable.
If skipped, the <cite>“schema</cite>” is used instead.</p></li>
<li><p><cite>“gravity</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> specifies if flow is driven also by the gravity.</p></li>
<li><p><cite>“gravity term discretization</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> selects a model for discretizing the
gravity term. Available options are <cite>“hydraulic head</cite>” [default] and <cite>“finite volume</cite>”.
The first option starts with equation for the shifted solution, i.e. the hydraulic head,
and derives gravity discretization by the reserve shifting.
The second option is based on the divergence formula.</p></li>
<li><p><cite>“gravity magnitude</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defined magnitude of the gravity vector.</p></li>
<li><p><cite>“Newton correction</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies a model for correction (non-physical) terms
that must be added to the preconditioner. These terms approximate some Jacobian terms.
Available options are <cite>“true Jacobian</cite>” and <cite>“approximate Jacobian</cite>”.
The FV scheme accepts only the first options. The othre schemes accept only the second option.</p></li>
<li><p><cite>“scaled constraint equation</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> rescales flux continuity equations on mesh faces.
These equations are divided by the nonlinear coefficient. This option allows us to
treat the case of zero nonlinear coefficient. At moment this feature does not work
with non-zero gravity term. Default is <em>false</em>.</p></li>
<li><p><cite>“constraint equation scaling cutoff”</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> specifies the cutoff value for
applying rescaling strategy described above.</p></li>
<li><p><cite>“consistent faces</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> may contain a <cite>“preconditioner</cite>” and
<cite>“linear operator</cite>” list (see sections <a class="reference internal" href="#preconditioners">Preconditioners</a> and <a class="reference internal" href="#linearsolvers">LinearSolvers</a>
respectively).  If these lists are provided, and the <cite>“discretization
primary</cite>” is of type <cite>“mfd: *</cite>”, then the diffusion method
UpdateConsistentFaces() can be used.  This method, given a set of cell
values, determines the faces constraints that satisfy the constraint
equation in MFD by assembling and inverting the face-only system.  This is
not currently used by any Amanzi PKs.</p></li>
<li><p><cite>“fracture</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> provides list of regions that defines a fracture network.
This parameter is used only by the coupled flow PK.</p></li>
</ul>
</li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pks operator name&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization primary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: optimized for monotonicity&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization secondary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: two-point flux approximation&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face, cell}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioner schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gravity term discretization&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;hydraulic head&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gravity magnitude&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;9.81&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nonlinear coefficient&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;upwind: face&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Newton correction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true Jacobian&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;consistent faces&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;linear solver&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioner&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>This example creates a p-lambda system, i.e. the pressure is
discretized in mesh cells and on mesh faces.
The preconditioner is defined on faces only, i.e. cell-based unknowns
are eliminated explicitly and the preconditioner is applied to the
Schur complement.</p>
<p>Additional options available only for the MFD family of discretizations include:</p>
<div class="admonition-diffusion-op-addon-spec admonition">
<p class="admonition-title">diffusion_op_addon-spec</p>
<ul class="simple">
<li><p><cite>“nonlinear coefficient</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies a method for treating nonlinear
diffusion coefficient, if any. Available options are <cite>“none</cite>”, <cite>“upwind:
face</cite>”, <cite>“divk: cell-face</cite>” (default), <cite>“divk: face</cite>”, <cite>“standard: cell</cite>”,
<cite>“divk: cell-face-twin</cite>” and <cite>“divk: cell-grad-face-twin</cite>”.  Symmetry
preserving methods are the divk-family of methods and the classical
cell-centered method (<cite>“standard: cell</cite>”). The first part of the name
indicates the base scheme.  The second part (after the semi-column)
indicates required components of the composite vector that must be provided
by a physical PK.</p></li>
<li><p><cite>“discretization secondary</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies the most robust
discretization method that is used when the primary selection fails to
satisfy all a priori conditions.  This is typically <cite>“mfd: default</cite>”, and is
used only when an MFD <cite>“discretization primary</cite>” is used.</p></li>
<li><p><cite>“schema</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> defines the operator stencil. It is a collection of
geometric objects.  Typically this is set by the implementation and is not provided.</p></li>
<li><p><cite>“preconditioner schema</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> <strong>{face,cell}</strong> Defines the
preconditioner stencil.  It is needed only when the default assembling
procedure is not desirable. If skipped, the <cite>“schema</cite>” is used instead.
In addition to the default, <strong>{face}</strong> may be used, which forms the Schur
complement.</p></li>
<li><p><cite>“consistent faces</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> may contain a <cite>“preconditioner</cite>” and
<cite>“linear operator</cite>” list (see sections <a class="reference internal" href="#preconditioners">Preconditioners</a> and <a class="reference internal" href="#linearsolvers">LinearSolvers</a>
respectively).  If these lists are provided, and the <cite>“discretization
primary</cite>” is of type <cite>“mfd: *</cite>”, then the diffusion method
UpdateConsistentFaces() can be used.  This method, given a set of cell
values, determines the faces constraints that satisfy the constraint
equation in MFD by assembling and inverting the face-only system.  This is
not currently used by any Amanzi PKs.</p></li>
<li><p><cite>“diffusion tensor</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> allows us to solve problems with symmetric and
non-symmetric (but positive definite) tensors. Available options are <em>symmetric</em>
(default) and <em>nonsymmetric</em>.</p></li>
<li><p><cite>“use manifold flux</cite>”  <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> Computes the flux using algorithms
and data structures for manifolds or fracture networks.</p></li>
</ul>
</div>
</section>
<section id="id22">
<h4>Advection operator<a class="headerlink" href="#id22" title="Link to this heading">#</a></h4>
<p>A high-order advection operator may have different domain and range and therefore requires two schemas.
The structure of the new schema is described in the previous section.
A high-order advection operator has two terms in a weak formulation, corresponding to
volume and surface integrals. These two terms are discretixed using two operators with
matrix of types <em>advection</em> and <em>flux</em>, respectively.</p>
<div class="admonition-advection-op-spec admonition">
<p class="admonition-title">advection_op-spec</p>
<ul class="simple">
<li><p><cite>“pks operator name</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> a PK specific name for the advection operator.</p>
<ul>
<li><p><cite>“method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines a discretization method. The available option is <cite>“dg modal</cite>”.</p></li>
<li><p><cite>“method order</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> defines method order. For example, the classical low-order finite
volume scheme is equivalent to DG of order 0.</p></li>
<li><p><cite>“matrix type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines matrix type. The supported options are <cite>“advection</cite>”
and <cite>“flux</cite>”.</p></li>
<li><p><cite>“dg basis</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines bases for DG schemes. The available options are
<cite>“regularized</cite>” (recommended), <cite>“normalized</cite>”, <cite>“orthonormalized</cite>”, and <cite>“natural</cite>”
(not recommended).</p></li>
<li><p><cite>“gradient operator on test function</cite>” [bool] defines place of the gradient operator.
For integration by parts schemes, the gradient is transfered to a test function.
This option is needed for discretizing volumetric integrals.</p></li>
<li><p><cite>“jump operator on test function</cite>” [bool] defines place of the jump operator.
For integration by parts schemes, the jump operator is applied to a test function.
This option is needed for discretizing surface fluxes.</p></li>
<li><p><cite>“flux formula</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines type of the flux. The available options
are <cite>“Rusanov</cite>” (default), <cite>“upwind</cite>”, <cite>“downwind</cite>”, and <cite>“NavierStokes</cite>”.</p></li>
<li><p><cite>“schema domain</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines a discretization schema for the operator domain.</p></li>
<li><p><cite>“schema range</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines a discretization schema for the operator range.</p></li>
</ul>
</li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pks operator name&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;dg modal&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method order&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;flux formula&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Rusanov&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;matrix type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;flux&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;jump operator on test function&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema domain&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;base&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;location&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{node, face}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{scalar, normal component}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema range&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;base&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;location&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{cell}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{scalar}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, we construct an operator for volumetric integrals in a weak formulation
of advection problem.</p>
<p>The only low-order advection operator in Amanzi is the upwind operator.
It employes the old schema.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pks operator name&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;base&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;face&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{cell}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method order&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;matrix type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;advection&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="reaction-operator">
<h4>Reaction operator<a class="headerlink" href="#reaction-operator" title="Link to this heading">#</a></h4>
<p>A reaction operator may represent either reaction of identity operator.
It is symmetric so far and requires one schema.
The structure of the schema is described in the previous section.</p>
<div class="admonition-reaction-op-spec admonition">
<p class="admonition-title">reaction_op-spec</p>
<ul class="simple">
<li><p><cite>“pks operator name</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> a PK specific name for the advection operator.</p>
<ul>
<li><p><cite>“method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines a discretization method. The only supported
option is <cite>“dg nodal</cite>”.</p></li>
<li><p><cite>“schema</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines a discretization schema for the operator domain.</p></li>
</ul>
</li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pks operator name&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;dg modal&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method order&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;matrix type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mass&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;base&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;location&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{cell}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{scalar}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{3}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="id23">
<h4>Elasticity operator<a class="headerlink" href="#id23" title="Link to this heading">#</a></h4>
<p>Elasticity operator is used for describing soil deformation or fluid flow (Stokes
and Navier-Stokes).</p>
<div class="admonition-elasticity-op-spec admonition">
<p class="admonition-title">elasticity_op-spec</p>
<ul class="simple">
<li><p><cite>“method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines a discretization method. The available
options are <cite>“BernardiRaugel</cite>”.</p></li>
<li><p><cite>“schema</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> defines a discretization schema.</p>
<ul>
<li><p><cite>“location</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> defines geometric location of degrees of freedom.</p></li>
<li><p><cite>“type</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> defines type of degrees of freedom. The available options
are <cite>“scalar</cite>” and <cite>“normal component</cite>”.</p></li>
<li><p><cite>“number</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> indicates how many time this degree of freedom is repeated.</p></li>
</ul>
</li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;elasticity operator&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;BernardiRaugel&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;base&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;location&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{node, face}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{scalar, normal component}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="abstract-operator">
<h4>Abstract operator<a class="headerlink" href="#abstract-operator" title="Link to this heading">#</a></h4>
<p>An abstract operator is designed for testing new discretization methods.
It uses the factory of discretization methods and a few control parameters
required by this factory and/or particular method in it.</p>
<div class="admonition-abstract-op-spec admonition">
<p class="admonition-title">abstract_op-spec</p>
<ul class="simple">
<li><p><cite>“method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines a discretization method. The available
options are <cite>“diffusion</cite>”, <cite>“diffusion generalized</cite>”, <cite>“BernardiRaugel</cite>”,
<cite>“CrouzeixRaviart</cite>”, <cite>“CrouzeixRaviart serendipity</cite>”, <cite>“Lagrange</cite>”,
<cite>“Lagrange serendipity</cite>”, and <cite>“dg modal</cite>”.</p></li>
<li><p><cite>“method order</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> defines disretization order. It is used by
high-order discretization methods such as the discontinuous Galerkin.</p></li>
<li><p><cite>“matrix type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines type of local matrix. Available options are
<cite>“mass</cite>”, <cite>“mass inverse</cite>”, <cite>“stiffness</cite>”, <cite>“divergence</cite>”, and <cite>“advection</cite>”.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_ABSTRACT OPERATOR&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;dg modal&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method order&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dg basis&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;regularized&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;matrix type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;flux&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema domain&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>...
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema range&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>...
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Diffusion is the most frequently used operator.
Examples of usage this operator are in test/operators_stokes.cc
and test/operators_diffusion_curved.cc
In the first example, we set up a discrete divergence operator
that corersponds to a rectangular matrix. In the second example,
we set up an elliptic operator when Hermite-type degrees of
freedom are used on curved faces.</p>
</section>
<section id="reconstruction">
<span id="id24"></span><h4>Reconstruction and limiters<a class="headerlink" href="#reconstruction" title="Link to this heading">#</a></h4>
<p>A reconstruction of discrete fields is used to increase accuracy of discrete models.
The reconstruction can be either unconstrained or limited.
Amanzi supports a variety of state-of-the-art reconstruction and limiting algorithms
and their extensions for various PKs.</p>
<div class="admonition-reconstruction-spec admonition">
<p class="admonition-title">reconstruction-spec</p>
<ul class="simple">
<li><p><cite>“reconstruction</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> describes parameters used by reconstruction algorithms.</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><cite>“method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies a reconstruction method. Available option is
<cite>“cell-based</cite>” (default).</p></li>
<li><p><cite>“polynomial order</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> defines the polynomial order of the reconstructed function.
Default is 1.</p></li>
<li><p><cite>“weight</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines weight for reconstruction. Available options are
<cite>“constant</cite>” (default) and <cite>“inverse distance</cite>”.</p></li>
<li><p><cite>“limiter</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies limiting method. Available options are
<cite>“Barth-Jespersen</cite>” (default), <cite>“Michalak-Gooch</cite>”, <cite>“tensorial</cite>”, and <cite>“Kuzmin</cite>”.</p></li>
<li><p><cite>“limiter stencil</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies stencil for calculating local bounds. Available
options are <cite>“face to cells</cite>”, <cite>“cell to closets cells</cite>”, <cite>“cell to all cells</cite>”,
and <cite>“node to cells</cite>”.
For a square mesh, the above options define stencils of size 2, 5, 9, and 4,
respectively.
Option <cite>“face to cells</cite>” is default for <cite>“Barth-Jespersen</cite>”, <cite>“Michalak-Gooch</cite>”,
and <cite>“tensorial</cite>”.  Option <cite>“node to cells</cite>” is default for <cite>“Kuzmin</cite>”.</p></li>
<li><p><cite>“limiter points</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> specifies the number of integration points (Gauss points in 2D)
on face where limiting occurs. Default is 1. Limited to 2D.</p></li>
<li><p><cite>“limiter location</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines geometry entity where the <em>limiter points</em>
are located. Available options are <cite>“node</cite>”, <cite>“face</cite>”, and <cite>“cell</cite>”.
Option <cite>“node</cite>” is default for <cite>“node to cells</cite>” stencil.
Option <cite>“face</cite>” is default for other stencils.</p></li>
<li><p><cite>“limiter cfl</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is a safety factor (less than 1) applied to the limiter.
Default value is 1.</p></li>
<li><p><cite>“use external bounds</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> specifies if bounds for limiters are provided by
the hosting application. Default is <cite>“false</cite>”.`</p></li>
<li><p><cite>“limiter extension for transport</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> adds additional corrections to
limiters required by the transport PK. Default value is <em>false</em>.</p></li>
</ul>
</div></blockquote>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reconstruction&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell-based&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;polynomial order&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;weight&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;inverse distance&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limiter&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;tensorial&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limiter extension for transport&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limiter stencil&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;face to cells&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limiter points&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="id25">
<h3><a class="toc-backref" href="#id76" role="doc-backlink">Time integrator</a><a class="headerlink" href="#id25" title="Link to this heading">#</a></h3>
<p>Backward Euler is the simplest of the implicit methods.  It solves time
integration schemes by evaluating all time derivatives at the new time.  This
makes it unconditionally stable, though potentially not very accurate.  This
unconditional stability tends to make it the workhorse of the types of stiff,
nonlinear parabolic equations such as Richards equation and the diffusion wave
approximation.</p>
<p>In this method, we look to solve:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \mathbf{u}}{\partial t} = f(\mathbf{u},\mathbf{x},t)\]</div>
<p>via the time discretization scheme:</p>
<div class="math notranslate nohighlight">
\[\frac{\mathbf{u}^{t + \Delta t} - \mathbf{u}^{t}}{\Delta t} = f(\mathbf{u}^{t + \Delta t}, \mathbf{x}, t + \Delta t)\]</div>
<div class="admonition-bdf1-ti-spec admonition" id="bdf1-ti-spec">
<p class="admonition-title">bdf1-ti-spec</p>
<ul class="simple">
<li><p><cite>“verbose object</cite>” <code class="docutils literal notranslate"><span class="pre">[verbose-object-spec]</span></code> A <a class="reference internal" href="#verbose-object">Verbose Object</a></p></li>
<li><p><cite>“residual debugger</cite>” <code class="docutils literal notranslate"><span class="pre">[residual-debugger-spec]</span></code> A <a class="reference internal" href="#residual-debugger">Residual Debugger</a> object.</p></li>
<li><p><cite>“max preconditioner lag iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>0</strong> specifies frequency
of preconditioner recalculation.</p></li>
<li><p><cite>“freeze preconditioner</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> enforces preconditioner to
be updated only once per non-linear solver. When set to true, the above
parameter is ignored.</p></li>
<li><p><cite>“extrapolate initial guess</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>true</strong> identifies forward time
extrapolation of the initial guess.</p></li>
<li><p><cite>“nonlinear iteration initial guess extrapolation order</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>1</strong>
defines extrapolation algorithm. Zero value implies no extrapolation.</p></li>
<li><p><cite>“restart tolerance relaxation factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1</strong> Changes the
nonlinear tolerance on restart. The time integrator is usually restarted
when a boundary condition changes drastically. It may be beneficial to
loosen the nonlinear tolerance on the first several timesteps after the
time integrator restart. The default value is 1, while a reasonable value
may be as large as 1000.</p></li>
<li><p><cite>“restart tolerance relaxation factor damping</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1</strong>
Controls how fast the loosened nonlinear tolerance will revert back to
the one specified in <cite>“nonlinear tolerance</cite>”. If the nonlinear tolerance
is “tol”, the relaxation factor is “factor”, and the damping is “d”, and
the timestep count is “n” then the actual nonlinear tolerance is “tol *
max(1.0, factor * d ** n)”. Reasonable values are between 0 and 1.</p></li>
</ul>
<p>INCLUDES
- <code class="docutils literal notranslate"><span class="pre">[solver-typed-spec]</span></code> <em>Uses a</em> <a class="reference internal" href="#solver">Solver</a>.
- <code class="docutils literal notranslate"><span class="pre">[timestep-controller-typed-spec]</span></code> <em>Uses a</em> <a class="reference internal" href="#timestep-controller">Timestep Controller</a></p>
</div>
<p>Note this also accepts an object that provides the <a class="reference internal" href="#bdf1-solver-interface">BDF1 Solver Interface</a>.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time integrator&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time integration method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;BDF1&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;BDF1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max preconditioner lag iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;freeze preconditioner&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;extrapolate initial guess&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nonlinear iteration initial guess extrapolation order&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;restart tolerance relaxation factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;restart tolerance relaxation factor damping&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep controller type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;standard&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep controller standard parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;solver type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;nka&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nka parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="time-step-controller">
<span id="timestep-controller"></span><span id="timestepcontroller"></span><h3><a class="toc-backref" href="#id77" role="doc-backlink">Time step controller</a><a class="headerlink" href="#time-step-controller" title="Link to this heading">#</a></h3>
<p>A timestep controller is used to abstract across PKs algorithms for computing a
<em>physical</em> timestep size that is valid for that PK.  Several controller types
are available which implement common choices.</p>
<p>The timestep controller <em>fixed</em> provides a single, uniform dt.</p>
<p>The timestep controller <em>standard</em> is a simple timestep control mechanism
which sets the next timestep based upon the previous timestep and how many
nonlinear iterations the previous timestep took to converge.
The next timestep is given by the following rule:</p>
<ul class="simple">
<li><p>if <span class="math notranslate nohighlight">\(N_k &gt; N^{max}\)</span> then <span class="math notranslate nohighlight">\(\Delta t_{k+1} = f_{reduction} \Delta t_{k}\)</span></p></li>
<li><p>if <span class="math notranslate nohighlight">\(N_k &lt; N^{min}\)</span> then <span class="math notranslate nohighlight">\(\Delta t_{k+1} = f_{increase} \Delta t_{k}\)</span></p></li>
<li><p>otherwise <span class="math notranslate nohighlight">\(\Delta t_{k+1} = \Delta t_{k}\)</span></p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(\Delta t_{k}\)</span> is the previous timestep and <span class="math notranslate nohighlight">\(N_k\)</span> is the number of nonlinear
iterations required to solve step <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>The timestep controller <em>smart</em> is based on <em>standard</em>, but also tries to be a bit
smarter to avoid repeated increase/decrease loops where the step size decreases,
converges in few iterations, increases, but then fails again.  It also tries to grow
the timestep geometrically to more quickly recover from tricky nonlinearities.</p>
<p>The timestep controller <em>from file</em> loads a timestep history from a file, then
advances the step size with those values.  This is mostly used for testing
purposes, where we need to force the same timestep history as previous runs to
do regression testing.  Otherwise roundoff errors can eventually alter
number of iterations enough to alter the timestep history, resulting in
solutions which are enough different to cause doubt over their correctness.</p>
<p>Note, the timestep controller is also responsible for throwing an error if the
timestep becomes invalid.</p>
<section id="standard-controller">
<span id="timestep-controller-standard"></span><h4>Standard controller<a class="headerlink" href="#standard-controller" title="Link to this heading">#</a></h4>
<p>This is a simple timestep control mechanism
which sets the next timestep based upon the previous timestep and how many
nonlinear iterations the previous timestep took to converge.</p>
<p>The timestep for step <span class="math notranslate nohighlight">\(k+1\)</span>, <span class="math notranslate nohighlight">\(\Delta t_{k+1}\)</span>, is given by:</p>
<ul class="simple">
<li><p>if <span class="math notranslate nohighlight">\(N_k &gt; N^{max}\)</span> then <span class="math notranslate nohighlight">\(\Delta t_{k+1} = f_{reduction} * \Delta t_{k}\)</span></p></li>
<li><p>if <span class="math notranslate nohighlight">\(N_k &lt; N^{min}\)</span> then <span class="math notranslate nohighlight">\(\Delta t_{k+1} = f_{increase} * \Delta t_{k}\)</span></p></li>
<li><p>otherwise <span class="math notranslate nohighlight">\(\Delta t_{k+1} = \Delta t_{k}\)</span></p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(\Delta t_{k}\)</span> is the previous timestep and <span class="math notranslate nohighlight">\(N_k\)</span> is the number of
nonlinear iterations required to solve step <span class="math notranslate nohighlight">\(k\)</span>:.</p>
<div class="admonition-timestep-controller-standard-spec admonition" id="timestep-controller-standard-spec">
<p class="admonition-title">timestep-controller-standard-spec</p>
<ul class="simple">
<li><p><cite>“max iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <span class="math notranslate nohighlight">\(N^{max}\)</span>, decrease the timestep if the previous step took more than this.</p></li>
<li><p><cite>“min iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <span class="math notranslate nohighlight">\(N^{min}\)</span>, increase the timestep if the previous step took less than this.</p></li>
<li><p><cite>“timestep reduction factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <span class="math notranslate nohighlight">\(f_{reduction}\)</span>, reduce the previous timestep by this multiple.</p></li>
<li><p><cite>“timestep increase factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <span class="math notranslate nohighlight">\(f_{increase}\)</span>, increase the previous timestep by this multiple.</p></li>
</ul>
<p>INCLUDES:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[timestep-controller-recoverable-spec]</span></code></p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;BDF1&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep controller type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;standard&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep controller standard parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;min iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;15&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep increase factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.2&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep reduction factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.5&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max timestep [s]&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e+9&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;min timestep [s]&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;initial timestep [s]&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;86400&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, the timestep is increased by factor 1.2 when the nonlinear
solver converges in 10 or less iterations.
The timestep is not changed when the number of nonlinear iterations is
between 11 and 15.
The timestep will be cut twice if the number of nonlinear iterations exceeds 15.</p>
</section>
<section id="smarter-controller">
<h4>Smarter controller<a class="headerlink" href="#smarter-controller" title="Link to this heading">#</a></h4>
<p>This is based on <a class="reference internal" href="#timestep-controller-standard">Timestep Controller Standard</a>, but also tries to be a bit
smarter to avoid repeated increase/decrease loops where the step size
decreases, converges in few iterations, increases, but then fails again.  It
also tries to grow the step geometrically to more quickly recover from tricky
nonlinearities.</p>
<div class="admonition-timestep-controller-smarter-spec admonition" id="timestep-controller-smarter-spec">
<p class="admonition-title">timestep-controller-smarter-spec</p>
<ul class="simple">
<li><dl class="simple">
<dt><cite>“max iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <span class="math notranslate nohighlight">\(N^{max}\)</span>, decrease the timestep if the</dt><dd><p>previous step took more than this.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>“min iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <span class="math notranslate nohighlight">\(N^{min}\)</span>, increase the timestep if the</dt><dd><p>previous step took less than this.</p>
</dd>
</dl>
</li>
<li><p><cite>“timestep reduction factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <span class="math notranslate nohighlight">\(f_{reduction}\)</span>, reduce
the previous timestep by this multiple.</p></li>
<li><p><cite>“timestep increase factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <span class="math notranslate nohighlight">\(f_{increase}\)</span>, increase
the previous timestep by this multiple.  Note that this can be modified
geometrically in the case of repeated successful steps.</p></li>
<li><p><cite>“max timestep increase factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>10.</strong> The max
<span class="math notranslate nohighlight">\(f_{increase}\)</span> will ever get.</p></li>
<li><p><cite>“growth wait after fail</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> Wait at least this many timesteps
before attempting to grow the timestep after a failed timestep.</p></li>
<li><p><cite>“count before increasing increase factor</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> Require this many
successive increasions before multiplying <span class="math notranslate nohighlight">\(f_{increase}\)</span> by itself.</p></li>
</ul>
</div>
</section>
<section id="adaptive-controller">
<h4>Adaptive controller<a class="headerlink" href="#adaptive-controller" title="Link to this heading">#</a></h4>
<p>This is under development and is based on a posteriori error estimates.</p>
</section>
<section id="fixed-controller">
<h4>Fixed controller<a class="headerlink" href="#fixed-controller" title="Link to this heading">#</a></h4>
<p>A fixed timestep controller simply sets a constant timestep size.</p>
<p><cite>“timestep controller type</cite>” = <cite>“fixed</cite>”</p>
<div class="admonition-timestep-controller-fixed-spec admonition" id="timestep-controller-fixed-spec">
<p class="admonition-title">timestep-controller-fixed-spec</p>
<ul class="simple">
<li><p><cite>“initial timestep [s]</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> The fixed timestep size.</p></li>
</ul>
</div>
</section>
<section id="file-based-controller">
<h4>File-based controller<a class="headerlink" href="#file-based-controller" title="Link to this heading">#</a></h4>
<p>This loads a timestep history from a file, then advances the step size with
those values.  This is mostly used for testing purposes, where we need to force
the same timestep history as previous runs to do regression testing.  Otherwise
even machine roundoff can eventually alter number of iterations enough to alter
the timestep history, resulting in solutions which are enough different to
cause doubt over their correctness.</p>
<div class="admonition-timestep-controller-from-file-spec admonition" id="timestep-controller-from-file-spec">
<p class="admonition-title">timestep-controller-from-file-spec</p>
<ul class="simple">
<li><p><cite>“file name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Path to hdf5 file containing timestep information.</p></li>
<li><p><cite>“timestep header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Name of the dataset containing the history of timestep sizes.</p></li>
</ul>
</div>
</section>
</section>
<section id="functions">
<span id="id26"></span><h3><a class="toc-backref" href="#id78" role="doc-backlink">Functions</a><a class="headerlink" href="#functions" title="Link to this heading">#</a></h3>
<p>To set up non-trivial boundary conditions and/or initial fields, Amanzi
supports a few mathematical functions.
New function types can added easily.
Each function is defined by a list:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function name&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span>function-specification
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>The parameter list name string NAME is arbitrary and meaningful only to the
parent parameter list.
This list is given as input to the Amanzi::FunctionFactory::Create
method which instantiates a new Amanzi::Function object.
The function-specification is one of the following parameter lists.</p>
<p>Analytic, algabraic functions of space and time are used for a variety of
purposes, including boundary conditions, initial conditions, and independent
variables.</p>
<p>For initial conditions, functions are prescribed of space only, i.e.</p>
<div class="math notranslate nohighlight">
\[u = f(x,y,z)\]</div>
<p>For boundary conditions and independent variables, functions are also a
function of time:</p>
<div class="math notranslate nohighlight">
\[u = f(t,x,y,z)\]</div>
<section id="additive-function">
<h4>Additive function<a class="headerlink" href="#additive-function" title="Link to this heading">#</a></h4>
<p>An additive function simply adds two other function results together.</p>
<div class="math notranslate nohighlight">
\[f(x) = f_1(x) + f_2(x)\]</div>
<p>where <span class="math notranslate nohighlight">\(f_1\)</span> is defined by the <cite>“function1</cite>” sublist, and
<span class="math notranslate nohighlight">\(f_2\)</span> by the <cite>“function2</cite>” sublist.</p>
<div class="admonition-function-additive-spec admonition" id="function-additive-spec">
<p class="admonition-title">function-additive-spec</p>
<ul class="simple">
<li><p><cite>“function1</cite>” <code class="docutils literal notranslate"><span class="pre">[function-typedinline-spec]</span></code> <span class="math notranslate nohighlight">\(f_1\)</span> in <span class="math notranslate nohighlight">\(f(x) = f_1(x) + f_2(x)\)</span></p></li>
<li><p><cite>“function2</cite>” <code class="docutils literal notranslate"><span class="pre">[function-typedinline-spec]</span></code> <span class="math notranslate nohighlight">\(f_2\)</span> in <span class="math notranslate nohighlight">\(f(x) = f_1(x) + f_2(x)\)</span></p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-additive&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>function-specification
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function2&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>function-specification
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="bilinear-function">
<h4>Bilinear function<a class="headerlink" href="#bilinear-function" title="Link to this heading">#</a></h4>
<p>A piecewise bilinear function extends the linear form of the tabular function to two variables.</p>
<p>Define <span class="math notranslate nohighlight">\(i(x) = i : x_i &lt; x &lt;= x_{{i+1}}\)</span> and similarly <span class="math notranslate nohighlight">\(j(y) = j : y_j &lt; y &lt;= y_{{j+1}}\)</span> for monotonically increasing <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_j\)</span>.</p>
<p>Given a two-dimensional array <span class="math notranslate nohighlight">\(u_{i,j}\)</span>, <span class="math notranslate nohighlight">\(f\)</span> is then defined by
bilinear interpolation on <span class="math notranslate nohighlight">\(u_{i(x),j(y)}, u_{i(x)+1,j(y)}, u_{i(x),j(y)+1}, u_{i(x)+1,j(y)+1}\)</span>,
if <span class="math notranslate nohighlight">\((x,y)\)</span> is in <span class="math notranslate nohighlight">\([x_0,x_n] \times [y_0,y_m]\)</span>, linear interpolation if one of <span class="math notranslate nohighlight">\(x,y\)</span>
are out of those bounds, and constant at the corner value if both are out of
bounds.</p>
<div class="admonition-function-bilinear-spec admonition" id="function-bilinear-spec">
<p class="admonition-title">function-bilinear-spec</p>
<ul class="simple">
<li><p><cite>“file</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> HDF5 or NetCDF filename of the data</p></li>
<li><p><cite>“row header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> name of the row dataset, the <span class="math notranslate nohighlight">\(x_i\)</span></p></li>
<li><p><cite>“row coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> one of <cite>“t</cite>”,`”x`”,`”y`”,`”z`”</p></li>
<li><p><cite>“column header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> name of the column dataset, the <span class="math notranslate nohighlight">\(y_i\)</span></p></li>
<li><p><cite>“column coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> one of <cite>“t</cite>”,`”x`”,`”y`”,`”z`”</p></li>
<li><p><cite>“value header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> name of the values dataset, the <span class="math notranslate nohighlight">\(u_{{i,j}}\)</span></p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-bilinear&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;pressure.h5&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;row header&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;/time&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;row coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;t&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;column header&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;/x&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;column coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;x&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value header&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;/pressure&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="bilinear-is-space-time-function">
<h4>Bilinear is space-time function<a class="headerlink" href="#bilinear-is-space-time-function" title="Link to this heading">#</a></h4>
<p>Define <span class="math notranslate nohighlight">\(i(x) = i : x_i &lt; x &lt;= x_{{i+1}}\)</span> and similarly <span class="math notranslate nohighlight">\(j(y) = j : y_j &lt; y &lt;= y_{{j+1}}\)</span>
for monotonically increasing <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_j\)</span>.</p>
<p>Given a two-dimensional array <span class="math notranslate nohighlight">\(u_{{i,j}}\)</span>, <span class="math notranslate nohighlight">\(f\)</span> is then defined by
bilinear interpolation on
<span class="math notranslate nohighlight">\(u_{i(x),j(y)}, u_{i(x)+1,j(y)}, u_{i(x),j(y)+1}, u_{i(x)+1,j(y)+1}\)</span>, if <span class="math notranslate nohighlight">\((x,y)\)</span> is in
<span class="math notranslate nohighlight">\([x_0,x_n] \times [y_0,y_m]\)</span>, linear interpolation if one of <span class="math notranslate nohighlight">\(x,y\)</span>
are out of those bounds, and constant at the corner value if both are out of
bounds.</p>
<div class="admonition-function-bilinear-and-time-spec admonition" id="function-bilinear-and-time-spec">
<p class="admonition-title">function-bilinear-and-time-spec</p>
<ul class="simple">
<li><p><cite>“file</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> HDF5 or NetCDF filename of the data</p></li>
<li><p><cite>“time header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>time</strong> Name of the temporal dimension indices, the <span class="math notranslate nohighlight">\(t_i\)</span>.</p></li>
<li><p><cite>“row header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>x</strong> name of the row dataset, the <span class="math notranslate nohighlight">\(x_i\)</span></p></li>
<li><p><cite>“row coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>x</strong> one of <cite>“x</cite>”,`”y`”,`”z`”</p></li>
<li><p><cite>“column header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>y</strong> name of the column dataset, the <span class="math notranslate nohighlight">\(y_i\)</span></p></li>
<li><p><cite>“column coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>y</strong> one of <cite>“x</cite>”,`”y`”,`”z`”</p></li>
<li><p><cite>“value header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> name of the values dataset, the <span class="math notranslate nohighlight">\(u_{{i,j}}\)</span></p></li>
<li><p><cite>“forms</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>linear</strong> Describes the temporal interpolant, one
of <cite>“linear</cite>” or <cite>“constant</cite>”, where <cite>“linear</cite>” is therefore trilinear
interpolation (2x space and time) and <cite>“constant</cite>” indicates that the value
on an interval is provided by the left point’s (earlier in time) value.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-bilinear-and-time&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;head.h5&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time header&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;time&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;row header&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;x&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;column header&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;y&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value header&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;rain&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>An example HDF5 file, called head.h5, might then look like:</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line">time: array(4) = [0, 60, 120, 180]</div>
<div class="line">x: array(3) = [0, 1, 2]</div>
<div class="line">y: array(2) = [0, 1]</div>
<div class="line">rain: (group)</div>
<div class="line-block">
<div class="line">| 0: array(3,2) = …   # values at time 0</div>
<div class="line">| 1: array(3,2) = …   # values at time 60</div>
<div class="line">| 2: array(3,2) = …   # values at time 120</div>
<div class="line">| 3: array(3,2) = …   # values at time 180</div>
</div>
</div>
<p>An example NetCDF file, called head.nc, might look like:</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line">time: array(4) = [0, 60, 120, 180]</div>
<div class="line">x: array(3) = [0, 1, 2]</div>
<div class="line">y: array(2) = [0, 1]</div>
<div class="line">rain: array(NTIMES, NX, NY) = …</div>
</div>
</section>
<section id="composition-function">
<h4>Composition function<a class="headerlink" href="#composition-function" title="Link to this heading">#</a></h4>
<p>Function composition simply applies one function to the result of another.</p>
<div class="math notranslate nohighlight">
\[f(x) = f_1( f_2(x) )\]</div>
<p>where <span class="math notranslate nohighlight">\(f_1\)</span> is defined by the <cite>“function1</cite>” sublist, and
<span class="math notranslate nohighlight">\(f_2\)</span> by the <cite>“function2</cite>” sublist.</p>
<div class="admonition-function-composition-spec admonition" id="function-composition-spec">
<p class="admonition-title">function-composition-spec</p>
<ul class="simple">
<li><p><cite>“function1</cite>” <code class="docutils literal notranslate"><span class="pre">[function-typedinline-spec]</span></code> <span class="math notranslate nohighlight">\(f_1\)</span> in <span class="math notranslate nohighlight">\(f(x) = f_1(f_2(x))\)</span></p></li>
<li><p><cite>“function2</cite>” <code class="docutils literal notranslate"><span class="pre">[function-typedinline-spec]</span></code> <span class="math notranslate nohighlight">\(f_2\)</span> in <span class="math notranslate nohighlight">\(f(x) = f_1(f_2(x))\)</span></p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-composition&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>function-specification
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function2&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>function-specification
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="constant-function">
<h4>Constant function<a class="headerlink" href="#constant-function" title="Link to this heading">#</a></h4>
<p>Constant function is defined as <span class="math notranslate nohighlight">\(f(x) = a\)</span>, for all <span class="math notranslate nohighlight">\(x\)</span>.</p>
<div class="admonition-function-constant-spec admonition">
<p class="admonition-title">function_constant-spec</p>
<ul class="simple">
<li><p><cite>“value</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> The constant to be applied.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="distance-function">
<h4>Distance function<a class="headerlink" href="#distance-function" title="Link to this heading">#</a></h4>
<p>A distance function calculates distance from reference point <span class="math notranslate nohighlight">\(x_0\)</span>
using by the following expression:</p>
<div class="math notranslate nohighlight">
\[f(x) = \sqrt( \sum_{j=0}^{n} m_j (x_j - x_{0,j})^2 )\]</div>
<p>Note that the first parameter in <span class="math notranslate nohighlight">\(x\)</span> can be time.</p>
<div class="admonition-function-distance-spec admonition" id="function-distance-spec">
<p class="admonition-title">function-distance-spec</p>
<ul class="simple">
<li><p><cite>“x0</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Point from which distance is measured.</p></li>
<li><p><cite>“metric</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Linear scaling metric, typically all 1s.</p></li>
</ul>
</div>
<p>Here is an example of a distance function using isotropic metric:</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-distance&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;x0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1.0, 3.0, 0.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;metric&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1.0, 1.0, 1.0}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="expression-function">
<h4>Expression function<a class="headerlink" href="#expression-function" title="Link to this heading">#</a></h4>
<p>This function parses a string expression. The function has min(N, D + 1)
arguments t, x, y, and z. The argument t is required. D is the space dimension,
and N is the user specified number of arguments which could be less than D + 1.</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-exprtk&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of arguments&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;formula&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;t + x + 2 * y&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="multiplicative-function">
<h4>Multiplicative function<a class="headerlink" href="#multiplicative-function" title="Link to this heading">#</a></h4>
<p>A multiplicative function simply multiplies two other function results together.</p>
<div class="math notranslate nohighlight">
\[f(x) = f_1(x) * f_2(x)\]</div>
<p>where <span class="math notranslate nohighlight">\(f_1\)</span> is defined by the <cite>“function1</cite>” sublist, and
<span class="math notranslate nohighlight">\(f_2\)</span> by the <cite>“function2</cite>” sublist.</p>
<div class="admonition-function-multiplicative-spec admonition" id="function-multiplicative-spec">
<p class="admonition-title">function-multiplicative-spec</p>
<ul class="simple">
<li><p><cite>“function1</cite>” <code class="docutils literal notranslate"><span class="pre">[function-typedinline-spec]</span></code> <span class="math notranslate nohighlight">\(f_1\)</span> in <span class="math notranslate nohighlight">\(f(x) = f_1(x) * f_2(x)\)</span></p></li>
<li><p><cite>“function2</cite>” <code class="docutils literal notranslate"><span class="pre">[function-typedinline-spec]</span></code> <span class="math notranslate nohighlight">\(f_2\)</span> in <span class="math notranslate nohighlight">\(f(x) = f_1(x) * f_2(x)\)</span></p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-multiplicative&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>function-specification
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function2&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>function-specification
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="multi-variable-linear-function">
<h4>Multi-variable linear function<a class="headerlink" href="#multi-variable-linear-function" title="Link to this heading">#</a></h4>
<p>A multi-variable linear function is formally defined by</p>
<div class="math notranslate nohighlight">
\[f(x) = y_0 + \sum_{{j=0}}^{{n-1}} g_j (x_j - x_{{0,j}})\]</div>
<p>with the constant term “math:<cite>y_0</cite> and gradient <span class="math notranslate nohighlight">\(g_0,\, g_1\,..., g_{{n-1}}\)</span>.
If the reference point <span class="math notranslate nohighlight">\(x_0\)</span> is specified, it must have the same
number of values as the gradient.  Otherwise, it defaults to zero.
Note that one of the parameters in a multi-valued linear function can be time.</p>
<div class="admonition-function-linear-spec admonition" id="function-linear-spec">
<p class="admonition-title">function-linear-spec</p>
<ul class="simple">
<li><p><cite>“y0</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> y_0 in f = y0 + g * (x - x0)</p></li>
<li><p><cite>“gradient</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> g in f = y0 + g * (x - x0)</p></li>
<li><p><cite>“x0</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> x0 in f = y0 + g * (x - x0)</p></li>
</ul>
</div>
<p>Conditions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">gradient</span><span class="p">)</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-linear&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;y0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gradient&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1.0, 2.0, 3.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;x0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2.0, 3.0, 1.0}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="multi-variable-monomial-function">
<h4>Multi-variable monomial function<a class="headerlink" href="#multi-variable-monomial-function" title="Link to this heading">#</a></h4>
<p>A multi-variable monomial function is given by the following expression:</p>
<div class="math notranslate nohighlight">
\[f(x) = c \prod_{j=0}^{n} (x_j - x_{0,j})^{p_j}\]</div>
<p>with the constant factor <span class="math notranslate nohighlight">\(c\)</span>, the reference point <span class="math notranslate nohighlight">\(x_0\)</span>, and
integer exponents <span class="math notranslate nohighlight">\(p_j\)</span>.
Note that the first parameter in <span class="math notranslate nohighlight">\(x\)</span> can be time.</p>
<div class="admonition-function-monomial-spec admonition" id="function-monomial-spec">
<p class="admonition-title">function-monomial-spec</p>
<ul class="simple">
<li><p><cite>“c</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> c in <span class="math notranslate nohighlight">\(f = c \prod_{j=0}^{n} (x_j - x_{0,j})^{p_j}\)</span></p></li>
<li><p><cite>“x0</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> x0 in <span class="math notranslate nohighlight">\(f = c \prod_{j=0}^{n} (x_j - x_{0,j})^{p_j}\)</span></p></li>
<li><p><cite>“exponents</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> p in <span class="math notranslate nohighlight">\(f = c \prod_{j=0}^{n} (x_j - x_{0,j})^{p_j}\)</span></p></li>
</ul>
</div>
<p>Conditions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">exponents</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is an example of monomial of degree 6 in three variables:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-monomial&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;c&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;x0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1.0, 3.0, 0.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;exponents&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 3, 1}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="polynomial-function">
<h4>Polynomial function<a class="headerlink" href="#polynomial-function" title="Link to this heading">#</a></h4>
<p>A generic polynomial function is given by the following expression:</p>
<div class="math notranslate nohighlight">
\[f(x) = \sum_{{j=0}}^n c_j (x - x_0)^{{p_j}}\]</div>
<p>where <span class="math notranslate nohighlight">\(c_j\)</span> are coefficients of monomials,
<span class="math notranslate nohighlight">\(p_j\)</span> are integer exponents, and <span class="math notranslate nohighlight">\(x_0\)</span> is the reference point.</p>
<div class="admonition-function-polynomial-spec admonition" id="function-polynomial-spec">
<p class="admonition-title">function-polynomial-spec</p>
<ul class="simple">
<li><p><cite>“coefficients</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> c_j polynomial coefficients</p></li>
<li><p><cite>“exponents</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> p_j polynomail exponents</p></li>
<li><p><cite>“reference point</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> x0 to which polynomial argument is normalized.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-polynomial&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;coefficients&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1.0, 1.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;exponents&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 4}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reference point&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="separable-function">
<h4>Separable function<a class="headerlink" href="#separable-function" title="Link to this heading">#</a></h4>
<p>A separable function is defined as the product of other functions such as</p>
<div class="math notranslate nohighlight">
\[f(x_0, x_1,...,x_{{n-1}}) = f_1(x_0)\, f_2(x_1,...,x_{{n-1}})\]</div>
<p>where <span class="math notranslate nohighlight">\(f_1\)</span> is defined by the <cite>“function1</cite>” sublist, and
<span class="math notranslate nohighlight">\(f_2\)</span> by the <cite>“function2</cite>” sublist.</p>
<div class="admonition-function-separable-spec admonition" id="function-separable-spec">
<p class="admonition-title">function-separable-spec</p>
<ul class="simple">
<li><p><cite>“function1</cite>” <code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code> <span class="math notranslate nohighlight">\(f_1\)</span> in <span class="math notranslate nohighlight">\(f(x) = f_1(x0) * f_2(x1...)\)</span></p></li>
<li><p><cite>“function2</cite>” <code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code> <span class="math notranslate nohighlight">\(f_2\)</span> in <span class="math notranslate nohighlight">\(f(x) = f_1(x0) * f_2(x1...)\)</span></p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-separable&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>function-specification
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function2&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>function-specification
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="smooth-step-function">
<h4>Smooth step function<a class="headerlink" href="#smooth-step-function" title="Link to this heading">#</a></h4>
<p>A smooth <span class="math notranslate nohighlight">\(C^2\)</span> function <cite>f(x)</cite> on interval <span class="math notranslate nohighlight">\([x_0,\,x_1]\)</span> is
defined such that <cite>f(x) = y_0</cite> for <cite>x &lt; x0</cite>, <cite>f(x) = y_1</cite> for <cite>x &gt; x_1</cite>, and
monotonically increasing for <span class="math notranslate nohighlight">\(x \in [x_0, x_1]\)</span> through cubic
interpolation.</p>
<div class="admonition-function-smooth-step-spec admonition" id="function-smooth-step-spec">
<p class="admonition-title">function-smooth-step-spec</p>
<ul class="simple">
<li><p><cite>“x0</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> First fitting point</p></li>
<li><p><cite>“y0</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> First fitting value</p></li>
<li><p><cite>“x1</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Second fitting point</p></li>
<li><p><cite>“y1</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Second fitting value</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-smooth-step&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;x0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;y0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;x1&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;y1&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2.0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="standard-math-functions">
<h4>Standard math functions<a class="headerlink" href="#standard-math-functions" title="Link to this heading">#</a></h4>
<p>These functions allow to set up non-trivial time-dependent boundary conditions
which increases a set of analytic solutions that can be used in convergence
analysis tests.</p>
<div class="math notranslate nohighlight">
\[f(x) = A * operator( p * (x - s) )\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[f(x) = A * operator(x-s, p)\]</div>
<p>Note that these operate only on the first coordinate, which is often time.
Function composition can be used to apply these to other coordinates (or
better yet a dimension could/should be added upon request).</p>
<div class="admonition-function-standard-math-spec admonition" id="function-standard-math-spec">
<p class="admonition-title">function-standard-math-spec</p>
<ul class="simple">
<li><p><cite>“operator</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies the name of a standard mathematical
function.  Available options are:</p>
<ul>
<li><p>trigonometric operators: <cite>“cos</cite>”, <cite>“sin</cite>”, <cite>“tan</cite>”, <cite>“acos</cite>”, <cite>“asin</cite>”,
<cite>“atan</cite>”</p></li>
<li><p>hyperbolic trig operators: <cite>“cosh</cite>”, <cite>“sinh</cite>”, <cite>“tanh</cite>”</p></li>
<li><p>power/log operators: <cite>“pow</cite>”, <cite>“exp</cite>”, <cite>“log</cite>”, <cite>“log10</cite>”, <cite>“sqrt</cite>”,</p></li>
<li><p>integral operators: <cite>“ceil</cite>”, <cite>“floor</cite>”, <cite>“mod</cite>”,</p></li>
<li><p><cite>“abs</cite>”, <cite>“fabs</cite>”, <cite>“positive</cite>” (0 for negative values), <cite>“negative</cite>” (0
for positive values), <cite>“heaviside</cite>”, <cite>“sign</cite>”</p></li>
</ul>
</li>
<li><p><cite>“amplitude</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> specifies a multiplication factor <cite>a</cite> in
formula <cite>a f(x)</cite>.  The multiplication factor is ignored by function
<cite>mod</cite>. Default value is 1.</p></li>
<li><p><cite>“parameter</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.0</strong> specifies additional parameter <cite>p</cite> for
math functions with two arguments. These functions are <cite>“a pow(x[0], p)</cite>”
and <cite>“a mod(x[0], p)</cite>”.  Alternative, scales the argument before
application, for use in changing the period of trig functions.</p></li>
<li><p><cite>“shift</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> specifies a shift of the function argument. Default
is 0.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-standard-math&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;operator&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;sqrt&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;amplitude&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-7&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;shift&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.1&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>This example defines function <cite>1e-7 sqrt(t-0.1)</cite>.</p>
</section>
<section id="static-head-function">
<h4>Static head function<a class="headerlink" href="#static-head-function" title="Link to this heading">#</a></h4>
<p><span class="math notranslate nohighlight">\(f(z) = p0 + rho * g * (z0 - z)\)</span></p>
<p>Note that dimension 0 is usually time.</p>
<div class="admonition-static-head-spec admonition">
<p class="admonition-title">static_head-spec</p>
<ul class="simple">
<li><p><cite>“p0</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Pressure at z0</p></li>
<li><p><cite>“density</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Density of water</p></li>
<li><p><cite>“gravity</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Gravity</p></li>
<li><p><cite>“space dimension</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> Dimensionality, usually 3</p></li>
<li><p><cite>“water table elevation</cite>” <code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code> Water table elevation function.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-static-head&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;p0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;101325.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;density&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1000.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;9.8&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;space dimension&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;water table elevation&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="tabular-function">
<span id="id27"></span><h4>Tabular function<a class="headerlink" href="#tabular-function" title="Link to this heading">#</a></h4>
<p>A piecewise function of one variable.</p>
<p>A tabular function is tabulated on a series of intervals; given values
<span class="math notranslate nohighlight">\({{x_i}}, {{y_i}},, i=0, ... n-1\)</span> and functional forms <span class="math notranslate nohighlight">\({{f_j}},,
j=0, ... n-2\)</span> a tabular function <span class="math notranslate nohighlight">\(f(x)\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{matrix}
f(x) &amp;=&amp; y_0, &amp; x \le x_0,\\
f(x) &amp;=&amp; f_{{i-1}}(x)  &amp; x \in (x_{{i-1}}, x_i],\\
f(x) &amp;=&amp; y_{{n-1}}, &amp; x &gt; x_{{n-1}}.
\end{matrix}\end{split}\]</div>
<p>The functional forms <span class="math notranslate nohighlight">\({f_j}\)</span> may be constant, which uses the left
endpoint, i.e.</p>
<p><span class="math notranslate nohighlight">\(f_i(x) = y_i\)</span>,</p>
<p>linear, i.e.</p>
<p><span class="math notranslate nohighlight">\(f_i(x) = ( y_i * (x - x_i) + y_{{i+1}} * (x_{{i+1}} - x) ) / (x_{{i+1}} - x_i)\)</span></p>
<p>or arbitrary, in which the <span class="math notranslate nohighlight">\(f_j\)</span> must be provided.</p>
<p>The <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_i\)</span> may be provided in one of two ways –
explicitly in the input spec or from an HDF5 file.  The length of these must be
equal, and the <span class="math notranslate nohighlight">\(x_i\)</span> must be monotonically increasing.  Forms, as defined
on intervals, must be of length equal to the length of the <span class="math notranslate nohighlight">\(x_i\)</span> less
one.</p>
<p>Explicitly specifying the data:</p>
<div class="admonition-function-tabular-spec admonition" id="function-tabular-spec">
<p class="admonition-title">function-tabular-spec</p>
<ul class="simple">
<li><p><cite>“x values</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> the <span class="math notranslate nohighlight">\(x_i\)</span></p></li>
<li><p><cite>“y values</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> the <span class="math notranslate nohighlight">\(y_i\)</span></p></li>
<li><p><cite>“forms</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> <strong>optional</strong> Form of the interpolant, either
<cite>“constant</cite>”, <cite>“linear</cite>”, or <cite>“USER_DEFINED</cite>” Default is linear for each *
interval.  Note the length of this array should be one per interval, or
one less than len of x and y values.</p></li>
<li><p><cite>“USER_DEFINED</cite>” <code class="docutils literal notranslate"><span class="pre">[function-spec]</span></code> <strong>optional</strong> user-provided functional
forms on the interval</p></li>
<li><p><cite>“x coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>t</strong>, <cite>“x</cite>”, <cite>“y</cite>”, <cite>“z</cite>” defines which
coordinate direction the <span class="math notranslate nohighlight">\(x_i\)</span> are formed, defaulting to time.</p></li>
</ul>
</div>
<p>The below example defines a function that is zero on interval <span class="math notranslate nohighlight">\((-\infty,\,0]\)</span>,
linear on interval <span class="math notranslate nohighlight">\((0,\,1]\)</span>, constant (<cite>f(x)=1</cite>) on interval <span class="math notranslate nohighlight">\((1,\,2]\)</span>,
square root of <cite>t</cite> on interval <span class="math notranslate nohighlight">\((2,\,3]\)</span>,
and constant (<cite>f(x)=2</cite>) on interval <span class="math notranslate nohighlight">\((3,\,\infty]\)</span>.</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-tabular&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;x values&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0.0, 1.0, 2.0, 3.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;x coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;t&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;y values&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0.0, 1.0, 2.0, 2.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;forms&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{linear, constant, USER_FUNC}&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;USER_FUNC&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-standard-math&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;operator&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;sqrt&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Loading table from file.  (Note that <cite>“USER_DEFINED</cite>” is not an option here,
but could be made so if requested).</p>
<div class="admonition-function-tabular-fromfile-spec admonition" id="function-tabular-fromfile-spec">
<p class="admonition-title">function-tabular-fromfile-spec</p>
<ul class="simple">
<li><p><cite>“file</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> filename of either HDF5 or NetCDF file.</p></li>
<li><p><cite>“x header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> name of the dataset for the <span class="math notranslate nohighlight">\(x_i\)</span> in the file</p></li>
<li><p><cite>“y header</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> name of the dataset for the <span class="math notranslate nohighlight">\(y_i\)</span> in the file</p></li>
<li><p><cite>“forms</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>optional</strong>, Form of the interpolant, either
<cite>“constant</cite>” or <cite>“linear</cite>”</p></li>
</ul>
</div>
<p>The example below would perform linear-interpolation on the intervals provided
by data within an hdf5 file <cite>“my_data.h5</cite>”.</p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;function-tabular&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;my_data.h5&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;x coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;t&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;x header&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;/time&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;y header&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;/data&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="time-functions">
<h3><a class="toc-backref" href="#id79" role="doc-backlink">Time functions</a><a class="headerlink" href="#time-functions" title="Link to this heading">#</a></h3>
<p>Boundary condition functions utilize a parameterized model for time variations that
is either piecewise constant or piecewise linear.  For example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1, 2, 3}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time values&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{10, 20, 30}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time functions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{constant, linear}&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>This defines four time intervals: (-inf,1), (1,2), (2,3), (3,+inf).
By assumption the function is constant over the first and last intervals.
The remaining two intervals are specified by the parameter <em>time functions</em>.
Thus, the value here is 10 anytime prior to <cite>t=2</cite>. The value increases linearly from 10 to
20 over the interval <cite>t=2</cite> to <cite>t=3</cite>, and then is constant at 30 for <cite>t&gt;3</cite>.</p>
</section>
</section>
<section id="solvers">
<span id="bdf1-solver-interface"></span><span id="solver"></span><h2><a class="toc-backref" href="#id80" role="doc-backlink">SOLVERS</a><a class="headerlink" href="#solvers" title="Link to this heading">#</a></h2>
<p>Nonlinear solvers are used within implicit time integration schemes to drive
the residual to zero and thereby solve for the primary variable at the new
time.</p>
<div class="admonition-solver-typed-spec admonition" id="solver-typed-spec">
<p class="admonition-title">solver-typed-spec</p>
<ul class="simple">
<li><p><cite>“solver type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Type of the solver.  One of:</p>
<ul>
<li><p><cite>“Newton</cite>” See <a class="reference internal" href="#solver-newton-and-inexact-newton">Solver: Newton and Inexact Newton</a></p></li>
<li><p><cite>“JFNK</cite>” See <a class="reference internal" href="#solver-jacobian-free-newton-krylov">Solver: Jacobian-Free Newton Krylov</a></p></li>
<li><p><cite>“line search</cite>” See <a class="reference internal" href="#solver-newton-with-line-search">Solver: Newton with Line Search</a></p></li>
<li><p><cite>“continuation</cite>” See <a class="reference internal" href="#solver-nonlinear-continuation">Solver: Nonlinear Continuation</a></p></li>
<li><p><cite>“nka</cite>” See <a class="reference internal" href="#solver-nonlinear-krylov-acceleration">Solver: Nonlinear Krylov Acceleration</a></p></li>
<li><p><cite>“aa</cite>” See <a class="reference internal" href="#solver-anderson-acceleration">Solver: Anderson Acceleration</a></p></li>
<li><p><cite>“nka line search</cite>” See <cite>Solver: NKA with Line Search</cite>”</p></li>
<li><p><cite>“nka_ls_ats</cite>” See <a class="reference internal" href="#solver-nka-with-line-search-ats">Solver: NKA with Line Search, ATS</a></p></li>
<li><p><cite>“nka_bt_ats</cite>” See <a class="reference internal" href="#solver-nka-with-backtracking-ats">Solver: NKA with backtracking, ATS</a></p></li>
<li><p><cite>“nox</cite>” See <a class="reference internal" href="#solver-nox">Solver: NOX</a></p></li>
</ul>
</li>
<li><p><cite>“_solver_type_ parameters</cite>” <code class="docutils literal notranslate"><span class="pre">[_solver_type_-spec]</span></code> A sublist containing
parameters specific to the type.</p></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><cite>“JFNK</cite>”, <cite>“line search</cite>”, and <cite>“continuation</cite>” methods have not been
beaten on as much as other methods.  <cite>“nka_ls_ats</cite>” is somewhat deprecated
and probably shouldn’t be used.  Prefer <cite>“nka</cite>” for simple problems,
<cite>“nka_bt_ats</cite>” for freeze-thaw problems or other problems with strong
nonlinearities, and <cite>“Newton</cite>” when you have a good Jacobian.  While
<cite>“nox</cite>” hasn’t been used extensively, it may be quite useful.</p>
</div>
<section id="iterative-solvers">
<span id="inverse"></span><span id="linearoperator"></span><span id="linearsolvers"></span><h3><a class="toc-backref" href="#id81" role="doc-backlink">Iterative solvers</a><a class="headerlink" href="#iterative-solvers" title="Link to this heading">#</a></h3>
<p>This list contains sublists for various linear algebra solvers such as PCG, GMRES, and NKA.
Note that only PK can provide a preconditioner for a linear solver; hence, we cannot
specify it here.</p>
<ul class="simple">
<li><p><cite>“iterative method</cite>” [string] defines a Krylov-based method. The available options
include <cite>“pcg</cite>” and <cite>“gmres</cite>”.</p></li>
<li><p><cite>“direct method</cite>” [string] defines a direct method. The available option is <cite>“amesos</cite>”.</p></li>
<li><p><cite>“xxx parameters</cite>” [list] provides parameters for the iterative method specified
by variable <cite>“iterative method</cite>”.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;solvers&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_GMRES WITH HYPRE AMG&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;iterative method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;gmres&quot;</span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gmres parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_PCG with HYPRE AMG&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;iterative method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;pcg&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pcg parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<section id="generalized-minimal-residuals-gmres">
<h4>Generalized minimal residuals (GMRES)<a class="headerlink" href="#generalized-minimal-residuals-gmres" title="Link to this heading">#</a></h4>
<p>Based on the methods of Yu. Kuznetsov, 1968; Y.Saad, 1986.  Deflated version of
GMRES is due to R.Morgan, GMRES with deflated restarting, 2002 SISC; S.Rollin,
W.Fichtner, Improving accuracy of GMRES with deflated restarting, 2007 SISC.</p>
<div class="admonition-iterative-method-gmres-spec admonition" id="iterative-method-gmres-spec">
<p class="admonition-title">iterative-method-gmres-spec</p>
<ul class="simple">
<li><p><cite>“error tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e-6</strong> Tolerance on which to declare success.</p></li>
<li><p><cite>“maximum number of iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>100</strong> Maximum iterations before declaring failure.</p></li>
<li><p><cite>“overflow tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>3.e50</strong> Error above this value results in failure.</p></li>
<li><p><cite>“convergence criterial</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> <strong>{relative rhs}</strong> A list of
criteria, any of which can be applied.  Valid include:</p>
<ul>
<li><p><cite>“relative rhs</cite>” : measure error relative to the norm of the RHS vector</p></li>
<li><p><cite>“relative residual</cite>” : measure error relative to the norm of the residual</p></li>
<li><p><cite>“absolute residual</cite>” : measure error directly, norm of error</p></li>
<li><p><cite>“make one iteration</cite>” : require at least one iteration to be performed before declaring success</p></li>
</ul>
</li>
<li><p><cite>“size of Krylov space</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>10</strong> Size of the Krylov space used to span the residual.</p></li>
<li><p><cite>“controller training start</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>0</strong> Start iteration for determining
convergence rates. (Add more please!)</p></li>
<li><p><cite>“controller training end</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>3</strong> Start iteration for determining
convergence rates. (Add more please!)</p></li>
<li><p><cite>“preconditioning strategy</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>left</strong> Valid are “left” and
“right”-type preconditioning (see Saad 1986)</p></li>
<li><p><cite>“maximum size of deflation space</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>0</strong> Size of the deflation space, see Rollin et al.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_GMRES with HYPRE AMG&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gmres parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;error tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-12&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;maximum number of iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;400&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;convergence criteria&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{relative residual}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;size of Krylov space&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;overflow tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3.0e+50&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;maximum size of deflation space&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioning strategy`&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;left&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;release Krylov vectors&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbose object&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbosity level&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;high&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>

<span class="cm">&lt;!-- Alternative implementation</span>
<span class="cm">&lt;ParameterList name=&quot;belos gmres parameters&quot;&gt;</span>
<span class="cm">  &lt;Parameter name=&quot;error tolerance&quot; type=&quot;double&quot; value=&quot;1e-12&quot;/&gt;</span>
<span class="cm">  &lt;Parameter name=&quot;maximum number of iterations&quot; type=&quot;int&quot; value=&quot;400&quot;/&gt;</span>
<span class="cm">  &lt;Parameter name=&quot;convergence criteria&quot; type=&quot;Array(string)&quot; value=&quot;{relative residual}&quot;/&gt;</span>
<span class="cm">  &lt;Parameter name=&quot;size of Krylov space&quot; type=&quot;int&quot; value=&quot;10&quot;/&gt;</span>
<span class="cm">  &lt;Parameter name=&quot;overflow tolerance&quot; type=&quot;double&quot; value=&quot;3.0e+50&quot;/&gt;</span>
<span class="cm">&lt;/ParameterList--&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="preconditioner-conjugate-gradient-pcg">
<h4>Preconditioner conjugate gradient (PCG)<a class="headerlink" href="#preconditioner-conjugate-gradient-pcg" title="Link to this heading">#</a></h4>
<div class="admonition-iterative-method-pcg-spec admonition" id="iterative-method-pcg-spec">
<p class="admonition-title">iterative-method-pcg-spec</p>
<ul class="simple">
<li><p><cite>“error tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e-6</strong> Tolerance on which to declare success.</p></li>
<li><p><cite>“maximum number of iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>100</strong> Maximum iterations before declaring failure.</p></li>
<li><p><cite>“overflow tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>3.e50</strong> Error above this value results in failure.</p></li>
<li><p><cite>“convergence criterial</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> <strong>{relative rhs}</strong> A list of
criteria, any of which can be applied.  Valid include:</p>
<ul>
<li><p><cite>“relative rhs</cite>” : measure error relative to the norm of the RHS vector</p></li>
<li><p><cite>“relative residual</cite>” : measure error relative to the norm of the residual</p></li>
<li><p><cite>“absolute residual</cite>” : measure error directly, norm of error</p></li>
<li><p><cite>“make one iteration</cite>” : require at least one iteration to be performed before declaring success</p></li>
</ul>
</li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_PCG with HYPRE AMG&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pcg parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;error tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-12&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;maximum number of iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;400&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;convergence criteria&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{relative residual,make one iteration}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;overflow tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3.0e+50&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbose object&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbosity level&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;high&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="newton-krylov-acceleration-nka">
<h4>Newton-Krylov acceleration (NKA)<a class="headerlink" href="#newton-krylov-acceleration-nka" title="Link to this heading">#</a></h4>
<p>This is effectively equivalent to GMRES with a rolling restart, where vectors
fall off the end of the space.</p>
<div class="admonition-iterative-method-nka-spec admonition" id="iterative-method-nka-spec">
<p class="admonition-title">iterative-method-nka-spec</p>
<ul class="simple">
<li><p><cite>“error tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e-6</strong> Tolerance on which to declare success.</p></li>
<li><p><cite>“maximum number of iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>100</strong> Maximum iterations before declaring failure.</p></li>
<li><p><cite>“overflow tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>3.e50</strong> Error above this value results in failure.</p></li>
<li><p><cite>“convergence criterial</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> <strong>{relative rhs}</strong> A list of
criteria, any of which can be applied.  Valid include:</p>
<ul>
<li><p><cite>“relative rhs</cite>” : measure error relative to the norm of the RHS vector</p></li>
<li><p><cite>“relative residual</cite>” : measure error relative to the norm of the residual</p></li>
<li><p><cite>“absolute residual</cite>” : measure error directly, norm of error</p></li>
<li><p><cite>“make one iteration</cite>” : require at least one iteration to be performed before declaring success</p></li>
</ul>
</li>
<li><p><cite>“max nka vectors</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>10</strong> Size of the NKA space used to span the residual, conceptually equivalent to the size of the Krylov space.</p></li>
<li><p><cite>“nka vector tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>0.05</strong> Vectors whose dot product are within this tolerance are considered parallel, and therefore the old vector is thrown out.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_NKA&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nka parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;error tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1e-12&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;maximum number of iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;400&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;convergence criteria&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{relative residual}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;overflow tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3.0e+50&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max nka vectors&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nka vector tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.05&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbose object&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbosity level&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;high&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="direct-solvers-from-amesos-library">
<h3><a class="toc-backref" href="#id82" role="doc-backlink">Direct solvers from Amesos library</a><a class="headerlink" href="#direct-solvers-from-amesos-library" title="Link to this heading">#</a></h3>
<p>Amesos library of Trilinos package provides interfaces to a few direct solvers.
List <cite>“amesos parameters</cite>” contains parameters that understood by this library.
These parameters may violate the camel-case convention employed by this spec.
Additional parameters are:</p>
<div class="admonition-solvers-amesos-spec admonition">
<p class="admonition-title">solvers_amesos-spec</p>
<ul class="simple">
<li><p><cite>“solver name</cite>” [string] declares name of one of the supported direct solvers.
Available options are <cite>“klu</cite>”, <cite>“superludist</cite>”, <cite>“basker</cite>”, etc, see Amesos and
Amesos2 manuals for details. The default value is serial solver <cite>“klu</cite>”.</p></li>
<li><p><cite>“amesos version</cite>” [int] specifies version of Amesos. Available options are 1 and 2.
The default value is 1.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_AMESOS KLU&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;direct method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;amesos&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;amesos parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;solver name&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;klu&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;amesos version&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="nonlinear-solvers">
<span id="solver-nka-with-backtracking-ats"></span><span id="solver-nka-with-line-search-ats"></span><h3><a class="toc-backref" href="#id83" role="doc-backlink">Nonlinear solvers</a><a class="headerlink" href="#nonlinear-solvers" title="Link to this heading">#</a></h3>
<p>Amanzi supports a few nonlinear solvers.
Typically, a process kernel uses a factory to select a nonlinear solver.
This factory uses parameter <em>solver type</em> to find parameters for
the selected solver.</p>
<section id="solver-nonlinear-krylov-acceleration">
<span id="id28"></span><h4>Newton-Krylov acceleration (NKA)<a class="headerlink" href="#solver-nonlinear-krylov-acceleration" title="Link to this heading">#</a></h4>
<p>Uses the Nonlinear Krylov acceleration method of Carlson and Miller to do
effectively a multivariant secant method, accelerating the solution of a
nonlinear solve.  This method can be significantly faster than Newton,
especially with an approximate Jacobian.</p>
<blockquote>
<div><p>Calef et al. “Nonlinear Krylov acceleration applied to a discrete ordinates
formulation of the k-eigenvalue problem.” JCP 238 (2013): 188-209.</p>
<p>N. N. Carlson, K. Miller, Design and application of a gradient-weighted
moving finite element code II: In two dimensions, SIAM J. Sci.  Comput. 19
(3) (1998) 766–798.</p>
</div></blockquote>
<div class="admonition-solver-nka-spec admonition" id="solver-nka-spec">
<p class="admonition-title">solver-nka-spec</p>
<ul class="simple">
<li><p><cite>“nonlinear tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e-6</strong> Defines the required error
tolerance. The error is calculated by a PK.</p></li>
<li><p><cite>“monitor</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>monitor update</strong> Specifies control of the
nonlinear residual. The available options are <cite>“monitor update</cite>”,
<cite>“monitor residual</cite>”, <cite>“monitor preconditioned residual</cite>”, <cite>“monitor l2
residual</cite>”, and <cite>“monitor preconditioned l2 residual</cite>”.</p></li>
<li><p><cite>“limit iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>20</strong> Defines the maximum allowed number
of iterations.</p></li>
<li><p><cite>“diverged tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e10</strong> Defines the error level
indicating divergence of the solver. The error is calculated by a PK.
Set to a negative value to ignore this check.</p></li>
<li><p><cite>“diverged l2 tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e10</strong> Defines another way to
identify divergence of the solver. If the relative l2 (little l) norm of
the solution increment is above this value, the solver is terminated.
Set to a negative value to ignore this check.</p></li>
<li><p><cite>“diverged pc tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1e10</strong> Defines another way to
identify divergence of the solver. If the relative maximum norm of the
solution increment (with respect to the initial increment) is above this
value, the solver is terminated.
Set to a negative value to ignore this check.</p></li>
<li><p><cite>“diverged residual tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1e10</strong> Defines another way
to identify divergence of the solver. If the relative l2 norm of the
residual (with respect to the initial residual) is above this value, the
solver is terminated.  Set to a negative value to ignore this check.</p></li>
<li><p><cite>“max du growth factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1e5</strong> Allows the solver to
identify divergence pattern on earlier iterations. If the maximum norm of
the solution increment changes drastically on two consecutive iterations,
the solver is terminated.</p></li>
<li><p><cite>“max error growth factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1e5</strong> Defines another way to
identify divergence pattern on earlier iterations. If the PK-specific
error changes drastically on two consecutive iterations, the solver is
terminated.</p></li>
<li><p><cite>“max divergent iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>3</strong> Defines another way to
identify divergence pattern on earlier iterations. If the maximum norm of
the solution increment grows on too many consecutive iterations, the
solver is terminated.</p></li>
<li><p><cite>“make one iteration</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> require at least one iteration
to be performed before declaring success. This options makes any effect
only when <cite>“monitor residual</cite>” is choose.</p></li>
<li><p><cite>“modify correction</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> Allows a PK to modify the
solution increment. One example is a physics-based clipping of extreme
solution values.</p></li>
<li><p><cite>“lag iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>0</strong> Delays the NKA acceleration, but
updates the Krylov space.</p></li>
<li><p><cite>“max nka vectors</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>10</strong> Defines the maximum number of
consecutive vectors used for a local space.</p></li>
<li><p><cite>“nka vector tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>0.05</strong> Defines the minimum
allowed orthogonality between vectors in the local space. If a new vector
does not satisfy this requirement, the space is modified.</p></li>
</ul>
</div>
</section>
<section id="anderson-acceleration-aa">
<span id="solver-anderson-acceleration"></span><h4>Anderson acceleration (AA)<a class="headerlink" href="#anderson-acceleration-aa" title="Link to this heading">#</a></h4>
<p>This is a variation of the GMRES solver for nonlinear problems.</p>
<div class="admonition-solver-aa-spec admonition" id="solver-aa-spec">
<p class="admonition-title">solver-aa-spec</p>
<ul class="simple">
<li><p><cite>“nonlinear tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e-6</strong> Defines the required error
tolerance. The error is calculated by a PK.</p></li>
<li><p><cite>“limit iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>20</strong> Defines the maximum allowed number
of iterations.</p></li>
<li><p><cite>“diverged tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e10</strong> Defines the error level
indicating divergence of the solver. The error is calculated by a PK.
Set to a negative value to ignore this check.</p></li>
<li><p><cite>“diverged l2 tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e10</strong> Defines another way to
identify divergence of the solver. If the relative L2 norm of the
solution increment is above this value, the solver is terminated.
Set to a negative value to ignore this check.</p></li>
<li><p><cite>“max du growth factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1e5</strong> Allows the solver to
identify divergence pattern on earlier iterations. If the maximum norm of
the solution increment changes drastically on two consecutive iterations,
the solver is terminated.</p></li>
<li><p><cite>“max divergent iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>3</strong> Defines another way to
identify divergence pattern on earlier iterations. If the maximum norm of
the solution increment grows on too many consecutive iterations, the
solver is terminated.</p></li>
<li><p><cite>“max aa vectors</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>10</strong> Defines the maximum number of
consecutive vectors used for a local space.</p></li>
<li><p><cite>“modify correction</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> Allows a PK to modify the
solution increment. One example is a physics-based clipping of extreme
solution values.</p></li>
<li><p><cite>“relaxation parameter</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1</strong> Damping factor for increment.</p></li>
</ul>
</div>
</section>
<section id="newton">
<span id="solver-newton-with-line-search"></span><span id="solver-newton-and-inexact-newton"></span><h4>Newton<a class="headerlink" href="#newton" title="Link to this heading">#</a></h4>
<p>The classical Newton method works well for cases where Jacobian is available
and corresponds to a stable (e.g. upwind) discretization.  The inexact Newton
methods work for cases where the discrete Jacobian is either not available, or
not stable, or computationally expensive. The discrete Jacobian is replaced by
a stable approximation of the continuum Jacobian. The choice between exact and
inexact is not made by the Solver, but instead by the PK.  Both use the
ApplyPreconditioner() method – if this applies the true Jacobian, then the
method is Newton.  If it applies an appoximation, it is inexact Newton.</p>
<div class="admonition-solver-newton-spec admonition" id="solver-newton-spec">
<p class="admonition-title">solver-newton-spec</p>
<ul class="simple">
<li><p><cite>“nonlinear tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e-6</strong> defines the required error
tolerance. The error is calculated by a PK.</p></li>
<li><p><cite>“monitor</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>monitor update</strong> specifies control of the
nonlinear residual. The available options are <cite>“monitor update</cite>” and
<cite>“monitor residual</cite>”.</p></li>
<li><p><cite>“limit iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>50</strong> defines the maximum allowed number
of iterations.</p></li>
<li><p><cite>“diverged tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e10</strong> defines the error level
indicating divergence of the solver. The error is calculated by a PK.</p></li>
<li><p><cite>“max du growth factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e5</strong> allows the solver to
identify divergence pattern on earlier iterations. If the maximum norm of
the solution increment changes drastically on two consecutive iterations,
the solver is terminated.</p></li>
<li><p><cite>“max error growth factor</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e5</strong> defines another way to
identify divergence pattern on earlier iterations. If the PK-specific
error changes drastically on two consecutive iterations, the solver is
terminated.</p></li>
<li><p><cite>“max divergent iterations</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>3</strong> defines another way to
identify divergence pattern on earlier iterations. If the maximum norm of
the solution increment grows on too many consecutive iterations, the
solver is terminated.</p></li>
<li><p><cite>“make one iteration</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> require at least one iteration
to be performed before declaring success. This options makes any effect
only when <cite>“monitor residual</cite>” is choose.</p></li>
<li><p><cite>“modify correction</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>true</strong> allows a PK to modify the
solution increment. One example is a physics-based clipping of extreme
solution values.</p></li>
<li><p><cite>“stagnation iteration check</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>8</strong> determines the number of
iterations before the stagnation check is turned on. The stagnation
happens when the current l2-error exceeds the initial l2-error.</p></li>
</ul>
</div>
</section>
<section id="inexact-newton">
<h4>Inexact Newton<a class="headerlink" href="#inexact-newton" title="Link to this heading">#</a></h4>
<p>The inexact Newton methods work for cases where the discrete Jacobian is either
<em>not</em> available, or not stable, or computationally expensive. The discrete
Jacobian is replaced by a stable approximation of the continuum Jacobian.
This solver has the same list of parameters as the Newton solver.</p>
<p>The difference between these solvers is in the preconditioner parameters.
Here is the list of selected parameters for the Newton-Picard solver.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;operators&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;diffusion operator&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioner&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization primary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: optimized for monotonicity&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;discretization secondary&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mfd: optimized for sparsity&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face, cell}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioner schema&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{face, cell}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Newton correction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;approximate Jacobian&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>

<span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;solver type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Newton&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Newton parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nonlinear tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0e-05&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;diverged tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0e+10&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max du growth factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0e+03&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max divergent iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limit iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;20&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;modify correction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="jacobian-free-newton-krylov-jfnk">
<span id="jf-matrix-spec"></span><span id="solver-jacobian-free-newton-krylov"></span><h4>Jacobian-free Newton-Krylov (JFNK)<a class="headerlink" href="#jacobian-free-newton-krylov-jfnk" title="Link to this heading">#</a></h4>
<p>Jacobian-Free Newton Krylov uses a finite difference scheme to approximate the
action of the Jacobian matrix, then uses a Krylov method (which only needs the
action of the Jacobian and not the Jacobian itself) to calculate the action of
the inverse of the Jacobian, thereby providing a Newton-like update.  As the
linear Krylov scheme converges to the inverse action, the nonlinear solution
converges to the same solution as a true Newton method.</p>
<p>This implementation simply replaces a SolverFnBase’s ApplyPreconditioner() with
a new ApplyPreconditioner() which uses the Krylov method with the action of the
forward operator to (hopefully) improve, relative to the supplied approximate
inverse, the estimate of the inverse.</p>
<div class="admonition-solver-jfnk-spec admonition" id="solver-jfnk-spec">
<p class="admonition-title">solver-jfnk-spec</p>
<ul class="simple">
<li><p><cite>“nonlinear solver</cite>” <code class="docutils literal notranslate"><span class="pre">[solver-typed-spec]</span></code> The outer nonlinear solver to use.</p></li>
<li><p><cite>“inverse</cite>” <code class="docutils literal notranslate"><span class="pre">[inverse-typed-spec]</span></code> The Krylov method to use.</p></li>
<li><p><cite>“JF matrix parameters</cite>” <code class="docutils literal notranslate"><span class="pre">[jf-matrix-spec]</span></code> See <a class="reference internal" href="#jf-matrix-spec">jf-matrix-spec</a></p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;solver type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;JFNK&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;JFNK parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;typical solution value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;JF matrix parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;finite difference epsilon&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0e-8&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method for epsilon&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Knoll-Keyes L2&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nonlinear solver&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nonlinear tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0e-05&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;diverged tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0e+10&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;limit iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;20&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max divergent iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;linear operator&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;iterative method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;gmres&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gmres parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="nonlinear-object-oriented-solution-nox">
<span id="solver-nox"></span><h4>Nonlinear Object-Oriented Solution (NOX)<a class="headerlink" href="#nonlinear-object-oriented-solution-nox" title="Link to this heading">#</a></h4>
<p>The interface to Trilinos NOX solver is as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;solver type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;nox&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nox parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;typical solution value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;JF matrix parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;finite difference epsilon&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0e-8&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;method for epsilon&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Knoll-Keyes L2&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;nonlinear solver&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;solver type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Newton&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Newton parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>...
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;linear operator&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;iterative method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;gmres&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gmres parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>...
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="nka-with-line-search">
<h4>NKA with line search<a class="headerlink" href="#nka-with-line-search" title="Link to this heading">#</a></h4>
<p>Does NKA, then checks if that correction has reduced the residual by at least a
tolerance.  If not, this uses a Brendt minimization algorithm to try and find
an <span class="math notranslate nohighlight">\(\alpha\)</span> that minimizes the reduction in the residual.</p>
<p>Note, this always monitors the residual.</p>
<span class="target" id="solver-nka-ls-spec"></span></section>
<section id="nonlinear-continuation">
<span id="solver-nonlinear-continuation"></span><h4>Nonlinear continuation<a class="headerlink" href="#nonlinear-continuation" title="Link to this heading">#</a></h4>
<p>Continuation methods are useful when the nonlinearity can be controlled by a
single simple parameter.  In this method, the nonlinear problem is solved with
a less-nonlinear value of the parameter, and the solution of that is used as
the initial guess to solve a harder problem.  As each successive problem is
solved, the continuation parameter is changed closer and closer to the true
value.</p>
<p>Few if any PKs support this method currently – it requires the PK to provide more
interface about how to update the continuation parameter.</p>
<div class="admonition-solver-continuation-spec admonition" id="solver-continuation-spec">
<p class="admonition-title">solver-continuation-spec</p>
<ul class="simple">
<li><p><cite>“nonlinear tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.e-6</strong> defines the required error
tolerance. The error is calculated by a PK.</p></li>
<li><p><cite>“number of continuation steps</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>5</strong> How many steps to take
from initial parameter to final parameter.</p></li>
<li><p><cite>“inner solver</cite>” <code class="docutils literal notranslate"><span class="pre">[solver-typed-spec]</span></code> A <a class="reference internal" href="#solver">Solver</a>, used at each step.</p></li>
</ul>
</div>
</section>
</section>
<section id="preconditioners">
<span id="preconditioner"></span><h3><a class="toc-backref" href="#id84" role="doc-backlink">Preconditioners</a><a class="headerlink" href="#preconditioners" title="Link to this heading">#</a></h3>
<p>This sublist contains entries for various
preconditioners required by a simulation. At the moment, we support Trilinos multilevel
preconditioner, Hypre BoomerAMG preconditioner, ILU preconditioner, Hypre’s ILU
preconditioner, and identity preconditioner.</p>
<ul class="simple">
<li><p><cite>“preconditioning method</cite>” [string] defines preconditioner algorithm.</p></li>
<li><p><cite>“xxx parameters</cite>” [list] provides parameters for the preconditioner specified
by parameter <cite>“preconditioning method</cite>”.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioners&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_TRILINOS ML&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioning method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;ml&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ml parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_HYPRE AMG&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioning method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;boomer amg&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;boomer amg parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_BLOCK ILU&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioning method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;block ilu&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;block ilu parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span>...
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_DIAGONAL&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;preconditioning method&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;diagonal&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<section id="hypre-s-algebraic-multigrid-amg-and-euclid-ilu">
<h4>Hypre’s algebraic multigrid (AMG) and Euclid (ILU)<a class="headerlink" href="#hypre-s-algebraic-multigrid-amg-and-euclid-ilu" title="Link to this heading">#</a></h4>
<p>Boomer AMG is a HYPRE product consisting of a variety of Algebraic Multigrid
methods.  It is accessed through Ifpack.</p>
<p>This is provided when using the <cite>“preconditioning method</cite>”=`”boomer amg`” or
<cite>“preconditioning method</cite>” = <cite>“hypre: boomer amg</cite>” in the <a class="reference internal" href="#preconditioner">Preconditioner</a>
spec.</p>
<div class="admonition-preconditioner-boomer-amg-spec admonition" id="preconditioner-boomer-amg-spec">
<p class="admonition-title">preconditioner-boomer-amg-spec:</p>
<ul class="simple">
<li><p><cite>“tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>0.</strong> If is not zero, the preconditioner is dynamic
and approximate the inverse matrix with the prescribed tolerance (in
the energy norm ???).</p></li>
<li><p><cite>“smoother sweeps</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>3</strong> defines the number of smoothing loops. Default is 3.</p></li>
<li><p><cite>“cycle applications</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>5</strong> defines the number of V-cycles.</p></li>
<li><p><cite>“strong threshold</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>0.5</strong> defines the number of V-cycles. Default is 5.</p></li>
<li><p><cite>“relaxation type</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>6</strong> defines the smoother to be used. Default is 6
which specifies a symmetric hybrid Gauss-Seidel / Jacobi hybrid method. TODO: add others!</p></li>
<li><p><cite>“coarsen type</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>0</strong> defines the coarsening strategy to be used. Default is 0
which specifies a Falgout method. TODO: add others!</p></li>
<li><p><cite>“max multigrid levels</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> optionally defined the maximum number of multigrid levels.</p></li>
<li><p><cite>“use block indices</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> If true, uses the <cite>“systems of
PDEs</cite>” code with blocks given by the SuperMap, or one per DoF per entity
type.</p></li>
<li><p><cite>“number of functions</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>1</strong> Any value &gt; 1 tells Boomer AMG to
use the <cite>“systems of PDEs</cite>” code with strided block type.  Note that, to use
this approach, unknowns must be ordered with DoF fastest varying (i.e. not
the native Epetra_MultiVector order).  By default, it uses the <cite>“unknown</cite>”
approach in which each equation is coarsened and interpolated independently.</p></li>
<li><p><cite>“nodal strength of connection norm</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> tells AMG to coarsen such
that each variable has the same coarse grid - sometimes this is more
“physical” for a particular problem. The value chosen here for nodal
determines how strength of connection is determined between the coupled
system.  I suggest setting nodal = 1, which uses a Frobenius norm.  This
does NOT tell AMG to use nodal relaxation.  Default is 0.</p></li>
<li><p><cite>“verbosity</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>0</strong> prints a summary of run time settings and
timing information to stdout.  <cite>“1</cite>” prints coarsening info, <cite>“2</cite>” prints
smoothing info, and <cite>“3</cite>’” prints both.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;boomer amg parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;smoother sweeps&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycle applications&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;strong threshold&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.5&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;coarsen type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;relaxation type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbosity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of functions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>ILU is a Parallel Incomplete LU, provided as part of the HYPRE project
through the Ifpack interface.</p>
<p>This is provided when using the <cite>“preconditioning method</cite>”=`”ILU`” or
=`”hypre: ILU`” in the <a class="reference internal" href="#preconditioner">Preconditioner</a> spec.</p>
<div class="admonition-preconditioner-ilu-spec admonition" id="preconditioner-ilu-spec">
<p class="admonition-title">preconditioner-ILU-spec:</p>
<ul class="simple">
<li><p><cite>“ilu(k) fill level</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>1</strong> The factorization level.</p></li>
<li><p><cite>“ilut drop tolerance</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>0</strong> Defines a drop tolerance relative to the largest absolute value of any entry in the row being factored.</p></li>
<li><p><cite>“verbosity</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>0</strong> Prints a summary of runtime settings and timing information to stdout.</p></li>
</ul>
</div>
</section>
<section id="hypre-s-block-ilu">
<h4>Hypre’s Block ILU<a class="headerlink" href="#hypre-s-block-ilu" title="Link to this heading">#</a></h4>
<p>The internal parameters for block ILU are as follows (see
<a class="reference external" href="https://docs.trilinos.org/dev/packages/ifpack/doc/html/index.html">https://docs.trilinos.org/dev/packages/ifpack/doc/html/index.html</a> for more detail):</p>
<ul class="simple">
<li><p><cite>“fact: level-of-fill</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> sets the level of fill used by the level-based ilu(k) strategy.
This is based on powers of the graph, so the value 0 means no-fill. Default is 0.</p></li>
<li><p><cite>“fact: absolute threshold</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines the value to add to each diagonal element
(times the sign of the actual diagonal element). Default is 0.</p></li>
<li><p><cite>“fact: relative threshold</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> multiplies the diagonal by this value before checking
the threshold. Default is 1.</p></li>
<li><p><cite>“fact: relax value</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> if nonzero, dropped values are added to the diagonal (times
this factor). Default is 0.</p></li>
<li><p><cite>“overlap</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> defines overlap of the additive Schwarz. Default is 0.</p></li>
<li><p><cite>“schwarz: combine mode</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines how values corresponding to overlapping nodes are
handled. Users should set this value to <cite>“Add</cite>” if interested in a symmetric preconditioner.
Otherwise, the default value of <cite>“Zero</cite>” usually results in better convergence.
If the level of overlap is set to zero, the rows of the user matrix that are stored on a
given processor are treated as a self-contained local matrix and all column entries that
reach to off-processor entries are ignored. Setting the level of overlap to one tells Ifpack
to increase the size of the local matrix by adding rows that are reached to by rows owned by
this processor. Increasing levels of overlap are defined recursively in the same way.
For sufficiently large levels of overlap, the entire matrix would be part of each processor’s
local ILU factorization process.
Default is <cite>“Add</cite>”.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_MY ILU&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;block ilu parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;fact: relax value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;fact: absolute threshold&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;fact: relative threshold&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;fact: level-of-fill&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;overlap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;schwarz: combine mode&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Add&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="trilinos-ml">
<h4>Trilinos ML<a class="headerlink" href="#trilinos-ml" title="Link to this heading">#</a></h4>
<p>This is provided when using the <cite>“preconditioning method</cite>”=`”ml`” in the
<a class="reference internal" href="#preconditioner">Preconditioner</a> spec.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>no input spec defined</p>
</div>
<p>See also: <a class="reference external" href="https://trilinos.github.io/pdfs/mlguide5.pdf">https://trilinos.github.io/pdfs/mlguide5.pdf</a></p>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ml parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ML output&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;aggregation: damping factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.33&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;aggregation: nodes per aggregate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;aggregation: threshold&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;aggregation: type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Uncoupled&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;coarse: type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Amesos-KLU&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;coarse: max size&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;128&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;coarse: damping factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycle applications&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;eigen-analysis: iterations&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;eigen-analysis: type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cg&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;max levels&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;40&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;prec type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;MGW&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;smoother: damping factor&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;smoother: pre or post&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;both&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;smoother: sweeps&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;smoother: type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Gauss-Seidel&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="identity">
<h4>Identity<a class="headerlink" href="#identity" title="Link to this heading">#</a></h4>
<p>Simply copies the input vector to the output – uses the Identity matrix as a
preconditioner.</p>
<p>This is provided when using the <cite>“preconditioning method</cite>”=`”identity`” in the
<a class="reference internal" href="#preconditioner">Preconditioner</a> spec.</p>
<p>No parameters are required.</p>
</section>
<section id="diagonal">
<h4>Diagonal<a class="headerlink" href="#diagonal" title="Link to this heading">#</a></h4>
<p>Simply applys the pointwise inverse of the diagonal of the matrix as an
extremely cheap matrix.</p>
<p>This is provided when using the <cite>“preconditioning method</cite>”=`”diagonal`” in the
<a class="reference internal" href="#preconditioner">Preconditioner</a> spec.</p>
<p>No parameters are required.</p>
</section>
</section>
</section>
<section id="mesh">
<h2><a class="toc-backref" href="#id85" role="doc-backlink">MESH</a><a class="headerlink" href="#mesh" title="Link to this heading">#</a></h2>
<p>Amanzi supports both structured and unstructured numerical solution approaches.
This flexibility has a direct impact on the selection and design of the underlying
numerical algorithms, the style of the software implementations, and, ultimately,
the complexity of the user-interface.
This specification format uses and describes the unstructured mesh only.</p>
<div class="admonition-mesh-spec admonition" id="mesh-spec">
<p class="admonition-title">mesh-spec</p>
<ul class="simple">
<li><p><cite>“mesh</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> accepts <cite>“unstructured</cite>” to indicate the meshing option that Amanzi will use.
This instructs Amanzi to use data structures provided in the Trilinos or MSTK software frameworks.
To the extent possible, the discretization algorithms implemented under this option
are largely independent of the shape and connectivity of the underlying cells.
As a result, this option supports an arbitrarily complex computational mesh structure
that enables users to work with numerical meshes that can be aligned with geometrically
complex man-made or geostatigraphical features.
Under this option, the user typically provides a mesh file that was generated with
an external software package.
The following mesh file formats are currently supported: <cite>“Exodus II</cite>” (see example),
<cite>“MSTK</cite>” (see example), and <cite>“MOAB</cite>” (obsolete).
Amanzi also provides a rudimentary capability to generate unstructured meshes automatically.</p>
<ul>
<li><p><cite>“unstructured</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> accepts instructions to either (1) read or, (2) generate an unstructured mesh.</p>
<ul>
<li><p><cite>“read mesh file</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> accepts name, format of pre-generated mesh file</p>
<ul>
<li><p><cite>“file</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> name of pre-generated mesh file. Note that in the case of an
Exodus II mesh file, the suffix of the serial mesh file must be .exo and
the suffix of the parallel mesh file must be .par.
When running in serial the code will read this the indicated file directly.
When running in parallel and the suffix is .par, the code will instead read
the partitioned files, that have been generated with a Nemesis tool and
named as filename.par.N.r where N is the number of processors and r is the rank.
When running in parallel and the suffix is .exo, the code will partition automatically
the serial file.</p></li>
<li><p><cite>“format</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> format of pre-generated mesh file (<cite>“MSTK</cite>”, <cite>“MOAB</cite>”, or <cite>“Exodus II</cite>”)</p></li>
</ul>
</li>
<li><p><cite>“generate mesh</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> accepts parameters of generated mesh</p>
<ul>
<li><p><cite>“domain low coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Location of low corner of domain</p></li>
<li><p><cite>“domain high coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Location of high corner of domain</p></li>
<li><p><cite>“number of cells</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> the number of uniform cells in each coordinate direction</p></li>
</ul>
</li>
<li><p><cite>“expert</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> accepts parameters that control which particular mesh framework is to be used.</p>
<ul>
<li><p><cite>“framework</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> one of <cite>“stk::mesh</cite>”, <cite>“MSTK</cite>”, <cite>“MOAB</cite>” or <cite>“Simple</cite>”.</p></li>
<li><p><cite>“verify mesh</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> true or false.</p></li>
<li><p><cite>“partitioner</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines the partitioning algorithm for parallel unstructured meshes.
The available options are <cite>“metis”</cite> (default), <cite>“zoltan_graph”</cite> and <cite>“zoltan_rcb”</cite>. <cite>“metis”</cite>
and <cite>“zoltan_graph”</cite> perform a graph partitioning of the mesh with no regard to the geometry
of the mesh. <cite>“zoltan_rcb”</cite> partitions meshes using Recursive Coordinate Bisection which
can lead to better partitioning in meshes that are thin in a particular direction.
Additionally, the use of <cite>“zoltan_rcb”</cite> with the MSTK framework triggers an option to
detect columns of elements in a mesh and adjust the partitioning such that no column is
split over multiple partitions. If no partitioner is specified, the default one is used.</p></li>
<li><p><cite>“request edges</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> builds support for mesh edges. Only in 3D.</p></li>
<li><p><cite>“contiguous global ids</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> enforces contiguous global ids. Default is <em>true</em>.</p></li>
</ul>
</li>
<li><p><cite>“submesh</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> parameters for extracted meshes</p>
<ul>
<li><p><cite>“domain name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies name of the domain. Available options are
<cite>“fracture</cite>” for the fracture network or <cite>“surface</cite>” for surface models.</p></li>
<li><p><cite>“extraction method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies the extraction method. The only available option
is <cite>“manifold mesh</cite>”. If this parameter is missing, the parent mesh framework is used
for submesh extraction..</p></li>
<li><p><cite>“regions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> defines a list of regions for submesh. Parameter
<cite>“extraction method</cite>” requires a single name in this list.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>Example of <em>Unstructured</em> mesh generated internally:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mesh&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;unstructured&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;generate mesh&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of cells&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{100, 1, 100}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;domain low coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0.0, 0.0, 0.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;domain high coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{103.2, 1.0, 103.2}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;expert&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;framework&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;MSTK&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;partitioner&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;metis&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Example of <em>Unstructured</em> mesh read from an external file:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mesh&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;unstructured&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;read mesh file&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mesh_filename&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;format&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Exodus II&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="geometric-model">
<h2><a class="toc-backref" href="#id86" role="doc-backlink">GEOMETRIC MODEL</a><a class="headerlink" href="#geometric-model" title="Link to this heading">#</a></h2>
<section id="domain">
<h3><a class="toc-backref" href="#id87" role="doc-backlink">Domain</a><a class="headerlink" href="#domain" title="Link to this heading">#</a></h3>
<p>It is not always possible to extract space dimension from provided data.
Therefore, we require the user to provide simple list <em>domain</em> with only
one parameter <em>spatial dimension</em>.</p>
<div class="admonition-geometric-model-spec admonition">
<p class="admonition-title">geometric_model-spec</p>
<ul class="simple">
<li><p><cite>“spatial dimension</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> defined space dimension. The available
values are 2 or 3.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;domain&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;spatial dimension&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="regions">
<h3><a class="toc-backref" href="#id88" role="doc-backlink">Regions</a><a class="headerlink" href="#regions" title="Link to this heading">#</a></h3>
<p>Regions are geometrical constructs used to define subsets of
the computational domain in order to specify the problem to be solved, and the
output desired. Regions may represents zero-, one-, two- or three-dimensional
subsets of physical space.  For a three-dimensional problem, the simulation
domain will be a three-dimensional region bounded by a set of two-dimensional
regions.  If the simulation domain is N-dimensional, the boundary conditions
must be specified over a set of regions are (N-1)-dimensional.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Surface files contain labeled triangulated face sets.  The user is
responsible for ensuring that the intersections with other surfaces in the
problem, including the boundaries, are <em>exact</em> (<em>i.e.</em> that surface
intersections are <em>watertight</em> where applicable), and that the surfaces are
contained within the computational domain.  If nodes in the surface fall
outside the domain, the elements they define are ignored.</p>
<p>Examples of surface files are given in the <em>Exodus II</em> file format here.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Region names must NOT be repeated.</p>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;TOP SECTION&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 3, 5}&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{4, 5, 8}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;MIDDLE SECTION&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 3, 3}&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{4, 5, 5}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;BOTTOM SECTION&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 3, 0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{4, 5, 3}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;INFLOW SURFACE&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: labeled set&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;label&quot;</span><span class="w">  </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;sideset_2&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="w">   </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;F_area_mesh.exo&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;format&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Exodus II&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;entity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;face&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;OUTFLOW PLANE&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: plane&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;point&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0.5, 0.5, 0.5}&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;normal&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0, 0, 1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;BLOODY SAND&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: color function&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;F_area_col.txt&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;25&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;FLUX PLANE&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: polygon&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of points&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;points&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{-0.5, -0.5, -0.5,</span>
<span class="s">                                                               0.5, -0.5, -0.5,</span>
<span class="s">                                                               0.8, 0.0, 0.0,</span>
<span class="s">                                                               0.5,  0.5, 0.5,</span>
<span class="s">                                                              -0.5, 0.5, 0.5}&quot;</span><span class="nt">/&gt;</span>
<span class="w">       </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, <em>TOP SECTION</em>, <em>MIDDLE SECTION</em> and <em>BOTTOM SECTION</em>
are three box-shaped volumetric regions. <em>INFLOW SURFACE</em> is a
surface region defined in an Exodus II-formatted labeled set
file and <em>OUTFLOW PLANE</em> is a planar region. <em>BLOODY SAND</em> is a volumetric
region defined by the value 25 in color function file.</p>
<nav class="contents local" id="region-types">
<p class="topic-title"><strong>Region Types</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#all" id="id103">All</a></p></li>
<li><p><a class="reference internal" href="#box" id="id104">Box</a></p></li>
<li><p><a class="reference internal" href="#plane" id="id105">Plane</a></p></li>
<li><p><a class="reference internal" href="#halfspace" id="id106">Halfspace</a></p></li>
<li><p><a class="reference internal" href="#labeled-set" id="id107">Labeled Set</a></p></li>
<li><p><a class="reference internal" href="#function-color" id="id108">Function Color</a></p></li>
<li><p><a class="reference internal" href="#polygon" id="id109">Polygon</a></p></li>
<li><p><a class="reference internal" href="#cylinder" id="id110">Cylinder</a></p></li>
<li><p><a class="reference internal" href="#point" id="id111">Point</a></p></li>
<li><p><a class="reference internal" href="#logical" id="id112">Logical</a></p></li>
<li><p><a class="reference internal" href="#boundary" id="id113">Boundary</a></p></li>
<li><p><a class="reference internal" href="#enumerated-set" id="id114">Enumerated set</a></p></li>
<li><p><a class="reference internal" href="#box-volume-fractions" id="id115">Box volume fractions</a></p></li>
<li><p><a class="reference internal" href="#line-segment" id="id116">Line Segment</a></p></li>
</ul>
</nav>
<section id="all">
<h4><a class="toc-backref" href="#id103" role="doc-backlink">All</a><a class="headerlink" href="#all" title="Link to this heading">#</a></h4>
<p>No parameters required.</p>
<div class="admonition-region-all-spec admonition">
<p class="admonition-title">region_all-spec</p>
<ul class="simple">
<li><p><cite>“empty</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>True</strong> This is simply here to avoid issues with empty lists.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;domain&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: all&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="box">
<h4><a class="toc-backref" href="#id104" role="doc-backlink">Box</a><a class="headerlink" href="#box" title="Link to this heading">#</a></h4>
<p>List <em>region: box</em> defines a region bounded by coordinate-aligned
planes. Boxes are allowed to be of zero thickness in only one
direction in which case they are equivalent to planes.</p>
<div class="admonition-region-box-spec admonition" id="region-box-spec">
<p class="admonition-title">region-box-spec</p>
<ul class="simple">
<li><p><cite>“low coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Location of the boundary point with the lowest coordinates.</p></li>
<li><p><cite>“high coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Location of the boundary points with the highest coordinates.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;WELL&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{-5.0,-5.0, -5.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{5.0, 5.0,  5.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="plane">
<h4><a class="toc-backref" href="#id105" role="doc-backlink">Plane</a><a class="headerlink" href="#plane" title="Link to this heading">#</a></h4>
<p>List <em>region: plane</em> defines a plane using a point lying on the plane and normal to the plane.</p>
<div class="admonition-region-plane-spec admonition" id="region-plane-spec">
<p class="admonition-title">region-plane-spec</p>
<ul class="simple">
<li><p><cite>“normal</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Normal to the plane.</p></li>
<li><p><cite>“point</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Point in space.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;TOP_SECTION&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: plane&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;point&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 3, 5}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;normal&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1, 1, 0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;expert parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0e-05&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="halfspace">
<h4><a class="toc-backref" href="#id106" role="doc-backlink">Halfspace</a><a class="headerlink" href="#halfspace" title="Link to this heading">#</a></h4>
<p>List <em>region: halfspace</em> defines a halfspace determined by a plane and
outward normal to the plane.</p>
<div class="admonition-region-half-space-spec admonition">
<p class="admonition-title">region_half_space-spec</p>
<ul class="simple">
<li><p><cite>“normal</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Normal to the plane.</p></li>
<li><p><cite>“point</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Point in space.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;TOP_SECTION&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: halfspace&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;point&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 3, 5}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;normal&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1, 1, 0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;expert parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0e-05&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="labeled-set">
<h4><a class="toc-backref" href="#id107" role="doc-backlink">Labeled Set</a><a class="headerlink" href="#labeled-set" title="Link to this heading">#</a></h4>
<p>The list <em>region: labeled set</em> defines a named set of mesh entities
existing in an input mesh file. This is the same file that contains
the computational mesh. The name of the entity set is given
by <em>label</em>.  For example, a mesh file in the Exodus II
format can be processed to tag cells, faces and/or nodes with
specific labels, using a variety of external tools. Regions based
on such sets are assigned a user-defined label for Amanzi, which may
or may not correspond to the original label in the exodus file.
Note that the file used to express this labeled set may be in any
Amanzi-supported mesh format (the mesh format is specified in the
parameters for this option).  The <em>entity</em> parameter may be
necessary to specify a unique set.  For example, an Exodus file
requires <em>cell</em>, <em>face</em> or <em>node</em> as well as a label (which is
an integer).  The resulting region will have the dimensionality
associated with the entities in the indicated set.</p>
<div class="admonition-region-labeled-set-spec admonition" id="region-labeled-set-spec">
<p class="admonition-title">region-labeled-set-spec</p>
<ul class="simple">
<li><p><cite>“label</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Set per label defined in the mesh file.</p></li>
<li><p><cite>“file</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> File name.</p></li>
<li><p><cite>“format</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Currently, we only support mesh files in the “Exodus II” format.</p></li>
<li><p><cite>“entity</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Type of the mesh object (cell, face, etc).</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;AQUIFER&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: labeled set&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;entity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;porflow4_4.exo&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;format&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Exodus II&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;label&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="function-color">
<h4><a class="toc-backref" href="#id108" role="doc-backlink">Function Color</a><a class="headerlink" href="#function-color" title="Link to this heading">#</a></h4>
<p>The list <em>region: color function</em> defines a region based a specified integer
color, <em>value</em>, in a structured color function file, <em>file</em>.  The format of
the color function file is given below in the “Tabulated function file format”
section. As shown in the file, the color values may be specified at the nodes
or cells of the color function grid. A computational cell is assigned the
‘color’ of the data grid cell containing its cell centroid (cell-based colors)
or the data grid nearest its cell-centroid (node-based colors). Computational
cells sets are then built from all cells with the specified color <em>Value</em>.</p>
<p>In order to avoid, gaps and overlaps in specifying materials, it is strongly
recommended that regions be defined using a single color function file.</p>
<div class="admonition-region-color-function-spec admonition" id="region-color-function-spec">
<p class="admonition-title">region-color-function-spec</p>
<ul class="simple">
<li><p><cite>“file</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> File name containing color function.</p></li>
<li><p><cite>“value</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> Color that defines the set in the tabulated function file.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;SOIL_TOP&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: color function&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;geology_resamp_2D.tf3&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="polygon">
<h4><a class="toc-backref" href="#id109" role="doc-backlink">Polygon</a><a class="headerlink" href="#polygon" title="Link to this heading">#</a></h4>
<p>The list <em>region: polygon</em> defines a polygonal region on which mesh faces and
nodes can be queried. NOTE that one cannot ask for cells in a polygonal surface
region. In 2D, the polygonal region is a line and is specified by 2 points.
In 3D, the polygonal region is specified by an arbitrary number of points.
In both cases the point coordinates are given as a linear array. The polygon
can be non-convex.</p>
<p>This provides a set of faces with a normal for computing flux.</p>
<p>The polygonal surface region can be queried for a normal. In 2D, the normal is
defined as [Vy,-Vx] where [Vx,Vy] is the vector from point 1 to point 2.
In 3D, the normal of the polygon is defined by the order in which points
are specified.</p>
<div class="admonition-region-polygon-spec admonition">
<p class="admonition-title">region_polygon-spec</p>
<ul class="simple">
<li><p><cite>“number of points</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> Number of polygon points.</p></li>
<li><p><cite>“points</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Point coordinates in a linear array.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;XY_PENTAGON&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: polygon&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of points&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;points&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{-0.5, -0.5, -0.5,</span>
<span class="s">                                                           0.5, -0.5, -0.5,</span>
<span class="s">                                                           0.8, 0.0, 0.0,</span>
<span class="s">                                                           0.5,  0.5, 0.5,</span>
<span class="s">                                                          -0.5, 0.5, 0.5}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;expert parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0e-3&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="cylinder">
<h4><a class="toc-backref" href="#id110" role="doc-backlink">Cylinder</a><a class="headerlink" href="#cylinder" title="Link to this heading">#</a></h4>
<p>List <em>region: cylinder</em> defines an infinite cylinder determined by
a symmetry axis, point on this axis and radius.</p>
<div class="admonition-region-cylinder-spec admonition">
<p class="admonition-title">region_cylinder-spec</p>
<ul class="simple">
<li><p><cite>“axis</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> symmetry axis</p></li>
<li><p><cite>“point</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> point on a symmetry axis</p></li>
<li><p><cite>“radius</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> cylinder radius</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;TOP_SECTION&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: cylinder&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;normal&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1, 1, 0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;axis&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0, 0, 1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;expert parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;tolerance&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0e-05&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="point">
<h4><a class="toc-backref" href="#id111" role="doc-backlink">Point</a><a class="headerlink" href="#point" title="Link to this heading">#</a></h4>
<p>List <em>region: point</em> defines a point in space.
This region consists of cells containing this point.</p>
<div class="admonition-region-point-spec admonition" id="region-point-spec">
<p class="admonition-title">region-point-spec</p>
<ul class="simple">
<li><p><cite>“coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Location of point in space.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;DOWN_WIND150&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- parent list defining the name --&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: point&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{-150.0, 0.0, 0.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="logical">
<h4><a class="toc-backref" href="#id112" role="doc-backlink">Logical</a><a class="headerlink" href="#logical" title="Link to this heading">#</a></h4>
<p>The list <em>region: logical</em> defines logical operations on regions allow for
more advanced region definitions. At this time the logical region allows for
logical operations on a list of regions.  <em>union</em> and <em>intersection</em> are
self-evident. In the case of <em>subtraction</em>, subtraction is performed from the
first region in the list.  The <em>complement</em> is a special case in that it is
the only case that operates on single region, and returns the complement to it
within the domain ENTIRE_DOMAIN.  Currently, multi-region booleans are not
supported in the same expression.</p>
<div class="admonition-region-logical-spec admonition" id="region-logical-spec">
<p class="admonition-title">region-logical-spec</p>
<ul class="simple">
<li><p><cite>“operation</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines operation on the list of regions.
One of: <cite>“union</cite>”, <cite>“intersect</cite>”, <cite>“subtract</cite>”, <cite>“complement</cite>”</p></li>
<li><p><cite>“regions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> specifies the list of involved regions.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LOWER_LAYERs&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: logical&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;operation&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;union&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{Middle1, Middle2, Bottom}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="boundary">
<h4><a class="toc-backref" href="#id113" role="doc-backlink">Boundary</a><a class="headerlink" href="#boundary" title="Link to this heading">#</a></h4>
<p>List <em>region: boundary</em> defines a set of all boundary faces.
Using this definition, faces located on the domain boundary are extracted.</p>
<div class="admonition-region-boundary-spec admonition" id="region-boundary-spec">
<p class="admonition-title">region-boundary-spec</p>
<ul class="simple">
<li><p><cite>“entity</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Type of the mesh object.  Unclear whether this is
used or can be other things than <cite>“face</cite>”?</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;DOMAIN_BOUNDARY&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- parent list names the region --&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: boundary&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;entity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;face&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="enumerated-set">
<h4><a class="toc-backref" href="#id114" role="doc-backlink">Enumerated set</a><a class="headerlink" href="#enumerated-set" title="Link to this heading">#</a></h4>
<p>List <em>region: enumerated set</em> defines a set of mesh entities via the list
of input global ids. Note that global ids are not defined correctly when
parallel mesh is created on a fly.</p>
<div class="admonition-region-enumerated-spec admonition" id="region-enumerated-spec">
<p class="admonition-title">region-enumerated-spec</p>
<ul class="simple">
<li><p><cite>“entity</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Type of the mesh object.  One of: <cite>“cell</cite>”, <cite>“face</cite>”, <cite>“edge</cite>”, <cite>“node</cite>”</p></li>
<li><p><cite>“entity gids</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> List of the global IDs of the entities.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;WELL&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: enumerated set&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;entity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;face&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;entity gids&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1, 12, 23, 34}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="box-volume-fractions">
<h4><a class="toc-backref" href="#id115" role="doc-backlink">Box volume fractions</a><a class="headerlink" href="#box-volume-fractions" title="Link to this heading">#</a></h4>
<p>List <em>region: box volume fraction</em> defines a region bounded by a box <em>not</em>
aligned with coordinate axes.
Boxes are allowed to be of zero thickness in only one direction in which case
they are equivalent to rectangles on a plane or segments on a line.</p>
<div class="admonition-region-box-volume-fractions-spec admonition" id="region-box-volume-fractions-spec">
<p class="admonition-title">region-box-volume-fractions-spec</p>
<ul class="simple">
<li><p><cite>“corner coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Location of one box corner.</p></li>
<li><p><cite>“opposite corner coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Location of the opposite box corner.</p></li>
<li><p><cite>“normals</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Normals to sides in a linear array. Default is columns of
the identity matrix. The normals may be scaled arbitrarily but must be orthogonal to
one another and form the right coordinate frame.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;BASIN&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: box volume fractions&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;corner coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{-1.0,-1.0, 1.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;opposite corner coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1.0, 1.0, 1.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;normals&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1.0, 0.0, 0.0</span>
<span class="s">                                                           0.0, 2.0, 0.0,</span>
<span class="s">                                                           0.0, 0.0, 3.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>This example defines a degenerate box, a square on a surface <em>z=1</em>.</p>
</section>
<section id="line-segment">
<h4><a class="toc-backref" href="#id116" role="doc-backlink">Line Segment</a><a class="headerlink" href="#line-segment" title="Link to this heading">#</a></h4>
<p>List <em>region: line segment</em> desribes a region defined by a line
segment. This region is a set of cells which intersect with a line
segment.  The line segment is allowed to intersect with one or more cells. Zero length
line segments are allowed. The line segment is defined by its ends
points.</p>
<div class="admonition-region-line-segment-spec admonition" id="region-line-segment-spec">
<p class="admonition-title">region-line-segment-spec</p>
<ul class="simple">
<li><p><cite>“end coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Location of one end of a line
segment.</p></li>
<li><p><cite>“opposite end coordinate</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> Location of the opposite
end of a line segment.</p></li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;WELL&quot;</span><span class="nt">&gt;</span><span class="w"> </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="w">   </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: line segment&quot;</span><span class="nt">&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;end coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{497542.44, 5393755.77, 0.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">     </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;opposite end coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{497542.44, 5393755.77, 100.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w"> </span><span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="notes-and-example">
<h3><a class="toc-backref" href="#id89" role="doc-backlink">Notes and example</a><a class="headerlink" href="#notes-and-example" title="Link to this heading">#</a></h3>
<ul>
<li><p>Surface files contain labeled triangulated face sets.  The user is
responsible for ensuring that the intersections with other surfaces
in the problem, including the boundaries, are <em>exact</em> (<em>i.e.</em> that
surface intersections are <em>watertight</em> where applicable), and that
the surfaces are contained within the computational domain.  If
nodes in the surface fall outside the domain, the elements they
define are ignored.</p>
<p>Examples of surface files are given in the <em>Exodus II</em> file
format here.</p>
</li>
<li><p>Region names must NOT be repeated.</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_TOP SECTION&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 3, 5}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{4, 5, 8}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_MIDDLE SECTION&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 3, 3}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{4, 5, 5}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_BOTTOM SECTION&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{2, 3, 0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{4, 5, 3}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_INFLOW SURFACE&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: labeled set&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;label&quot;</span><span class="w">  </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_SIDESET2&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="w">   </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_MESH.exo&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;format&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Exodus II&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;entity&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;face&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_OUTFLOW PLANE&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: plane&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;point&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0.5, 0.5, 0.5}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;normal&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0, 0, 1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_BLOODY SAND&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: color function&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_FAREA_COLOR.txt&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;value&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;25&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_FLUX PLANE&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: polygon&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;number of points&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;points&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{-0.5, -0.5, -0.5,</span>
<span class="s">                                                             0.5, -0.5, -0.5,</span>
<span class="s">                                                             0.8, 0.0, 0.0,</span>
<span class="s">                                                             0.5,  0.5, 0.5,</span>
<span class="s">                                                            -0.5, 0.5, 0.5}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_ENTIRE MESH&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region: all&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, _TOP SECTION, _MIDDLE SECTION and _BOTTOM SECTION
are three box-shaped volumetric regions. _INFLOW SURFACE is a
surface region defined in an Exodus II-formatted labeled set
file and _OUTFLOW PLANE is a planar region. _BLOODY SAND is a volumetric
region defined by the value 25 in color function file.</p>
</section>
</section>
<section id="databases">
<h2><a class="toc-backref" href="#id90" role="doc-backlink">DATABASES</a><a class="headerlink" href="#databases" title="Link to this heading">#</a></h2>
<section id="thermodynamic-database">
<h3><a class="toc-backref" href="#id91" role="doc-backlink">Thermodynamic database</a><a class="headerlink" href="#thermodynamic-database" title="Link to this heading">#</a></h3>
<p>The thermodynamic database has a few sections, some of them are optional.</p>
<section id="primary-species">
<h4>Primary species<a class="headerlink" href="#primary-species" title="Link to this heading">#</a></h4>
<p>The <cite>“primary species</cite>” section is a list of primary species, one sublist for a species.
Each sublist is named after the species and contains the following parameters:</p>
<div class="admonition-primary-species-spec admonition">
<p class="admonition-title">primary_species-spec</p>
<ul class="simple">
<li><p><cite>“ion size parameter</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is an empirical parameter that provides agreement
between measured activity coefficients and ionic strength. In theory, it is the diameter
of the hydrated ion.</p></li>
<li><p><cite>“charge</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> is the ion charge. The net charge of an ion is non-zero since the
total number of electrons is unequal to the total number of protons.</p></li>
<li><p><cite>“gram molecular weight</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is amount of a molecular substance whose weight,
in grams, is numerically equal to the molecular weight of that substance.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;thermodynamic database&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;primary species&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;H+&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ion size parameter&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;9.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;charge&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gram molecular weight&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0079&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Ca++&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ion size parameter&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;6.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;charge&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gram molecular weight&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;40.078&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Here is the short list of species that could be used for models.
Each line has four data fields: name of a species, ion size parameter, charge, and atomic mass [u].</p>
<div class="highlight-asc notranslate"><div class="highlight"><pre><span></span><span class="c">Al+++</span><span class="w">      </span><span class="c">9.0</span><span class="w">     </span><span class="c">3.0</span><span class="w">    </span><span class="c">26.9815</span>
<span class="c">HCO3-</span><span class="w">      </span><span class="c">4.0</span><span class="w">    </span><span class="c">-1.0</span><span class="w">    </span><span class="c">61.0171</span>
<span class="c">HPO4--</span><span class="w">     </span><span class="c">4.0</span><span class="w">    </span><span class="c">-2.0</span><span class="w">    </span><span class="c">95.9793</span>
<span class="c">Cl-</span><span class="w">        </span><span class="c">3.0</span><span class="w">    </span><span class="c">-1.0</span><span class="w">    </span><span class="c">35.4527</span>
<span class="c">CO2(aq)</span><span class="w">    </span><span class="c">3.0</span><span class="w">     </span><span class="c">0.0</span><span class="w">    </span><span class="c">44.01</span>
<span class="c">Cs137</span><span class="w">      </span><span class="c">2.5</span><span class="w">     </span><span class="c">1.0</span><span class="w">   </span><span class="c">132.9054</span>
<span class="c">F-</span><span class="w">         </span><span class="c">3.5</span><span class="w">    </span><span class="c">-1.0</span><span class="w">    </span><span class="c">18.9984</span>
<span class="c">Fe++</span><span class="w">       </span><span class="c">6.0</span><span class="w">     </span><span class="c">2.0</span><span class="w">    </span><span class="c">55.847</span>
<span class="c">K+</span><span class="w">         </span><span class="c">3.0</span><span class="w">     </span><span class="c">1.0</span><span class="w">    </span><span class="c">39.0983</span>
<span class="c">Mg++</span><span class="w">       </span><span class="c">8.0</span><span class="w">     </span><span class="c">2.0</span><span class="w">    </span><span class="c">24.30</span>
<span class="c">Na+</span><span class="w">        </span><span class="c">4.0</span><span class="w">     </span><span class="c">1.0</span><span class="w">    </span><span class="c">22.9898</span>
<span class="c">N2(aq)</span><span class="w">     </span><span class="c">3.0</span><span class="w">     </span><span class="c">0.0</span><span class="w">    </span><span class="c">28.0135</span>
<span class="c">NO3-</span><span class="w">       </span><span class="c">3.0</span><span class="w">    </span><span class="c">-1.0</span><span class="w">    </span><span class="c">62.0049</span>
<span class="c">O2(aq)</span><span class="w">     </span><span class="c">3.0</span><span class="w">     </span><span class="c">0.0</span><span class="w">    </span><span class="c">31.9988</span>
<span class="c">Pb_210</span><span class="w">     </span><span class="c">1.0</span><span class="w">     </span><span class="c">0.0</span><span class="w">   </span><span class="c">210.00</span>
<span class="c">Pu_238</span><span class="w">     </span><span class="c">1.0</span><span class="w">     </span><span class="c">0.0</span><span class="w">   </span><span class="c">238.00</span>
<span class="c">Ra_226</span><span class="w">     </span><span class="c">1.0</span><span class="w">     </span><span class="c">0.0</span><span class="w">   </span><span class="c">226.00</span>
<span class="c">SiO2(aq)</span><span class="w">   </span><span class="c">3.0</span><span class="w">     </span><span class="c">0.0</span><span class="w">    </span><span class="c">60.0843</span>
<span class="c">SO4--</span><span class="w">      </span><span class="c">4.0</span><span class="w">    </span><span class="c">-2.0</span><span class="w">    </span><span class="c">96.0636</span>
<span class="c">Sr90</span><span class="w">       </span><span class="c">5.0</span><span class="w">     </span><span class="c">2.0</span><span class="w">    </span><span class="c">87.6200</span>
<span class="c">Tc_99</span><span class="w">      </span><span class="c">1.0</span><span class="w">     </span><span class="c">0.0</span><span class="w">    </span><span class="c">99.00</span>
<span class="c">Th_230</span><span class="w">     </span><span class="c">1.0</span><span class="w">     </span><span class="c">0.0</span><span class="w">   </span><span class="c">230.00</span>
<span class="c">Tritium</span><span class="w">    </span><span class="c">9.0</span><span class="w">     </span><span class="c">0.0</span><span class="w">     </span><span class="c">1.01</span>
<span class="c">U_234</span><span class="w">      </span><span class="c">1.0</span><span class="w">     </span><span class="c">0.0</span><span class="w">   </span><span class="c">234.00</span>
<span class="c">UO2++</span><span class="w">      </span><span class="c">4.5</span><span class="w">     </span><span class="c">2.0</span><span class="w">   </span><span class="c">270.028</span>
<span class="c">Zn++</span><span class="w">       </span><span class="c">6.0</span><span class="w">     </span><span class="c">2.0</span><span class="w">    </span><span class="c">65.39</span>
</pre></div>
</div>
</section>
<section id="aqueous-equilibrium-complexes">
<h4>Aqueous equilibrium complexes<a class="headerlink" href="#aqueous-equilibrium-complexes" title="Link to this heading">#</a></h4>
<p>The <cite>“aqueous equilibrium complexes</cite>” section is a list of aqueous equiliblium reactions.
Each sublist is named after a secondary species and contains the following parameters:</p>
<div class="admonition-aqueous-complex-spec admonition">
<p class="admonition-title">aqueous_complex-spec</p>
<ul class="simple">
<li><p><cite>“ion size parameter</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is an empirical parameter that provides agreement
between measured activity coefficients and ionic strength. In theory, it is the diameter
of the hydrated ion.</p></li>
<li><p><cite>“charge</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> is the ion charge. The net charge of an ion is non-zero since the
total number of electrons is unequal to the total number of protons.</p></li>
<li><p><cite>“gram molecular weight</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is amount of a molecular substance whose weight,
in grams, is numerically equal to the molecular weight of that substance.</p></li>
<li><p><cite>“reaction</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the equilibrium reaction equation.</p></li>
<li><p><cite>“equilibrium constant</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the value of reaction quotient at chemical equilibrium.
The reaction quotient is defined mathematically as the ratio of the activities of the product
species to that of the reactant species. The stoichiometric coefficients are taken into account
as exponents of activities.</p></li>
</ul>
</div>
<p>In a non-isothermal simulation, the equlibrium constant is a function of temperature.
In such a case we have one additional parameter <cite>“temperature</cite>” and  parameter
<cite>“equilibrium constant</cite>” becomes a list that defines a piecewice linear function logK(T).
This is the <a class="reference internal" href="#tabular-function">tabular function</a> with linear forms.</p>
<div class="admonition-aqueous-complex-temprerature-spec admonition">
<p class="admonition-title">aqueous_complex_temprerature-spec</p>
<ul class="simple">
<li><p><cite>“T</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> is the array of temperature points.</p></li>
<li><p><cite>“Keq</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> is the matching array of equilibrium constant values.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;thermodynamic database&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;aqueous equilibrium complexes&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;OH-&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ion size parameter&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3.5&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;charge&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;-1&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gram molecular weight&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;17.0073&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reaction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0 H2O  -1.0 H+&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;equilibrium constant&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;13.9951&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;temperature&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;298.15&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;equilibrium constant&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;T&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{273.15,  298.15,  333.15,  373.15,  423.15,  473.15,  523.15,  573.15}&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Keq&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{14.9398, 13.9951, 13.0272, 12.2551, 11.6308, 11.2836, 11.1675, 11.3002}&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">    </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;HCO3-&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ion size parameter&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;4.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;charge&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;-1&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gram molecular weight&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;61.0171&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reaction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0 H2O  -1.0 H+  1.0 CO2(aq)&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;equilibrium constant&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;6.3447&quot;</span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;temperature&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;298.15&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Below are a few examples of aqueous reaction.
Each line has five fields: reaction equation, logarithm of the equlibrium constant at 25C,
ion size parameter, ion charge, and the gram molecular weight.</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span>AlHPO4+    =  1.0 Al+++ 1.0 HPO4--    -7.4       4.0     1.0   122.961
CaCl+      =  1.0 Ca++  1.0 Cl-        0.6956    4.0     1.0    75.5307
CaCl2(aq)  =  1.0 Ca++  2.0 Cl-        0.6436    3.0     0.0   110.9834
CaCO3(aq)  =  1.0 Ca+2  1.0 CO3-2     -3.151     3.5     0.0    17.0073
CaHCO3+    =  1.0 Ca++  1.0 HCO3-     -1.0467    4.0     1.0   101.0951
CaHPO4(aq) =  1.0 Ca++  1.0 HPO4--    -2.7400    3.0     0.0   136.0573
CO3--      = -1.0 H+    1.0 HCO3-     10.3288    4.5    -2.0    60.0092
FeCl+      =  1.0 Fe++  1.0 Cl-        0.1605    4.0     1.0    91.2997
FeCl2(aq)  =  1.0 Fe++  2.0 Cl-        2.4541    3.0     0.0   126.752
FeCl4--    =  1.0 Fe++  4.0 Cl-       -1.9       4.0    -2.0   197.658
FeHCO3+    =  1.0 Fe++  1.0 HCO3-     -2.72      4.0     1.0   116.864
FeHPO4(aq) =  1.0 Fe++  1.0 HPO4--    -3.6       3.0     0.0   151.826
FeF+       =  1.0 Fe++  1.0 F-        -1.36      4.0     1.0    74.8454
FeSO4(aq)  =  1.0 Fe++  1.0 SO4--     -2.2       3.0     0.0   151.911
H2PO4-     =  1.0 H+    1.0 HPO4--    -7.2054    4.0    -1.0    96.9872
H3PO4(aq)  =  2.0 H+    1.0 HPO4--    -9.3751    3.0     0.0    97.9952
H2SO4(aq)  =  2.0 H+    1.0 SO4--      1.0209    3.0     0.0    98.0795
HCl(aq)    =  1.0 H+    1.0 Cl-       -0.67      3.0     0.0    36.4606
HNO3(aq)   =  1.0 H+    1.0 NO3-       1.3025    3.0     0.0    63.0129
HSO4-      =  1.0 H+    1.0 SO4--     -1.9791    4.0    -1.0    97.0715
KCl(aq)    =  1.0 K+    1.0 Cl-        1.4946    3.0     0.0    74.551
KHPO4-     =  1.0 K+    1.0 HPO4--    -0.78      4.0    -1.0   135.078
KSO4-      =  1.0 K+    1.0 SO4--     -0.8796    4.0    -1.0   135.162
NaHCO3(aq) =  1.0 Na+   1.0 HCO3-     -0.1541    3.0     0.0    84.0069
NaCl(aq)   =  1.0 Na+   1.0 Cl-        0.777     3.0     0.0    58.4425
NaF(aq)    =  1.0 Na+   1.0 F-         0.9976    3.0     0.0    41.9882
NaHPO4-    =  1.0 Na+   1.0 HPO4--    -0.92      4.0    -1.0   118.969
NaNO3(aq)  =  1.0 Na+   1.0 NO3-       1.044     3.0     0.0    84.9947
NaSO4-     =  1.0 Na+   1.0 SO4--     -0.82      4.0    -1.0   119.053
MgCO3(aq)  =  1.0 Mg+2  1.0 CO3-2     -2.928     3.5     0.0    17.0073
OH-        =  1.0 H2O  -1.0 H+        13.9951    3.5    -1.0    17.00730
P2O7----   = -1.0 H2O   2.0 HPO4--     3.7463    4.0    -4.0   173.9433
PO4---     = -1.0 H+    1.0 HPO4--    12.3218    4.0    -3.0    94.9714
UO2Cl+     =  1.0 Cl-   1.0 UO2++     -0.1572    4.0     1.0   305.48
UO2Cl2(aq) =  2.0 Cl-   1.0 UO2++      1.1253    3.0     0.0   340.933
UO2F+      =  1.0 F-    1.0 UO2++     -5.0502    4.0     1.0   289.026
UO2F2(aq)  =  2.0 F-    1.0 UO2++     -8.5403    3.0     0.0   308.024
UO2F3-     =  3.0 F-    1.0 UO2++    -10.7806    4.0    -1.0   327.023
UO2F4--    =  4.0 F-    1.0 UO2++    -11.5407    4.0    -2.0   346.021
UO2HPO4(aq)= 1.0 HPO4-- 1.0 UO2++     -8.4398    3.0     0.0   366.007
UO2NO3+    =  1.0 NO3-  1.0 UO2++     -0.2805    4.0     1.0   332.033
UO2SO4(aq) =  1.0 SO4-- 1.0 UO2++     -3.0703    3.0     0.0   366.091
UO2(SO4)2-- = 2.0 SO4-- 1.0 UO2++     -3.9806    4.0    -2.0   462.155

Al2(OH)2++++  = -2.0 H+    2.0 Al+++   2.0 H2O         7.6902    5.5    4.0    87.9778
Al3(OH)4(5+)  = -4.0 H+    3.0 Al+++   4.0 H2O        13.8803    6.0    5.0   148.9740
Al(OH)2+      =  2.0 H2O   1.0 Al+++  -2.0 H+         10.5945    4.0    1.0    60.9962
Al(OH)3(aq)   =  3.0 H2O   1.0 Al+++  -3.0 H+         16.1577    3.0    0.0    78.0034
AlH2PO4++     =  1.0 Al+++ 1.0 H+      1.0 HPO4--     -3.1       4.5    2.0   123.969
AlO2-         =  2.0 H2O   1.0 Al+++  -4.0 H+         22.8833    4.0   -1.0    58.9803
AlOH++        =  1.0 H2O   1.0 Al+++  -1.0 H+          4.9571    4.5    2.0    43.9889
CaCO3(aq)     = -1.0 H+    1.0 Ca++    1.0 HCO3-       7.0017    3.0    0.0   100.0872
CaH2PO4+      =  1.0 Ca++  1.0 H+      1.0 HPO4--     -1.4000    4.0    1.0   137.0652
CaP2O7--      = -1.0 H2O   1.0 Ca++    2.0 HPO4--     -3.0537    4.0   -2.0   214.0213
CaPO4-        = -1.0 H+    1.0 Ca++    1.0 HPO4--      5.8618    4.0   -1.0   135.0494
CaOH+         = -1.0 H+    1.0 Ca++    1.0 H2O        12.8500    4.0    1.0    57.0853
CO2(aq)       = -1.0 H2O   1.0 H+      1.0 HCO3-      -6.3447    3.0    0.0    44.0098
H2P2O7--      = -1.0 H2O   2.0 H+      2.0 HPO4--    -12.0709    4.0   -2.0   175.9592
H2S(aq)       =  2.0 H+    1.0 SO4--  -2.0 O2(aq)    131.329     3.0    0.0    34.0819
H3P2O7-       = -1.0 H2O   2.0 HPO4--  3.0 H+        -14.4165    4.0   -1.0   176.9671
H4P2O7(aq)    = -1.0 H2O   2.0 HPO4--  4.0 H+        -15.9263    3.0    0.0   177.9751
HAlO2(aq)     =  2.0 H2O   1.0 Al+++  -3.0 H+         16.4329    3.0    0.0    59.9883
HCO3-         =  1.0 H2O  -1.0 H+      1.0 CO2(aq)    6.34470    4.0   -1.0    61.01710
HO2-          =  1.0 H2O  -1.0 H+      0.5 O2(aq)     28.302     4.0   -1.0    33.0067
HP2O7---      = -1.0 H2O   1.0 H+      2.0 HPO4--     -5.4498    4.0   -3.0   174.9513
HS-           =  1.0 H+    1.0 SO4--  -2.0 O2(aq)    138.317     3.5   -1.0    33.0739
Fe2(OH)2++++  =  1.0 H2O   2.0 Fe++    0.5 O2(aq)    -14.0299    5.5    4.0   145.709
FeCO3(aq)     =  1.0 Fe++ -1.0 H+      1.0 HCO3-       5.5988    3.0    0.0   115.856
FeH2PO4+      =  1.0 Fe++  1.0 H+      1.0 HPO4--     -2.7       4.0    1.0   152.834
Fe(OH)2(aq)   =  2.0 H2O   1.0 Fe++   -2.0 H+         20.6       3.0    0.0    89.8617
Fe(OH)3-      =  3.0 H2O   1.0 Fe++   -3.0 H+         31.0       4.0   -1.0   106.869
Fe(OH)4--     =  4.0 H2O   1.0 Fe++   -4.0 H+         46.0       4.0   -2.0   123.876
FeOH+         =  1.0 H2O   1.0 Fe++   -1.0 H+          9.5       4.0    1.0    72.8543
FeOH++        =  0.5 H2O   1.0 Fe++    0.25 O2(aq)    -6.3       4.5    2.0    72.8543
FePO4-        =  1.0 Fe++ -1.0 H+      1.0 HPO4--      4.3918    4.0   -1.0   150.818
KHSO4(aq)     =  1.0 K+    1.0 H+      1.0 SO4--      -0.8136    3.0    0.0   136.17
KOH(aq)       =  1.0 H2O   1.0 K+     -1.0 H+         14.46      3.0    0.0    56.1056
KP2O7---      = -1.0 H2O   1.0 K+      2.0 HPO4--      1.4286    4.0   -3.0   213.042
MgOH+         =  1.0 H2O  -1.0 H+      1.0 Mg++      11.78510    4.0    1.0    41.3123
NaCO3-        = -1.0 H+    1.0 HCO3-   1.0 Na+         9.8144    4.0   -1.0    82.9990
NaOH(aq)      =  1.0 H2O   1.0 Na+    -1.0 H+         14.7948    3.0    0.0    39.9971
NH3(aq)       =  1.5 H2O   0.5 N2(aq) -0.75 O2(aq)    58.2305    3.0    0.0    17.0306
UO2CO3(aq)    = -1.0 H+    1.0 HCO3-   1.0 UO2++       0.6634    3.0    0.0   330.037
UO2(CO3)2--   = -2.0 H+    2.0 HCO3-   1.0 UO2++       3.7467    4.0   -2.0   390.046
UO2(CO3)3---- = -3.0 H+    3.0 HCO3-   1.0 UO2++       9.4302    4.0   -4.0   450.055
UO2H2PO4+     =  1.0 H+    1.0 HPO4--  1.0 UO2++     -11.6719    4.0    1.0   367.015
UO2H3PO4++    =  2.0 H+    1.0 HPO4--  1.0 UO2++     -11.3119    4.5    2.0   368.023
UO2OH+        =  1.0 H2O  -1.0 H+      1.0 UO2++       5.2073    4.0    1.0   287.035
UO2PO4-       = -1.0 H+    1.0 HPO4--  1.0 UO2++      -2.0798    4.0   -1.0   364.999
UO2(OH)2(aq)  =  2.0 H2O  -2.0 H+      1.0 UO2++      10.3146    3.0    0.0   304.042
UO2(OH)3-     =  3.0 H2O  -3.0 H+      1.0 UO2++      19.2218    4.0   -1.0   321.05
UO2(OH)4--    =  4.0 H2O  -4.0 H+      1.0 UO2++      33.0291    4.0   -2.0   338.057
(UO2)2OH+++   =  1.0 H2O  -1.0 H+      2.0 UO2++       2.7072    5.0    3.0   557.063
(UO2)2(OH)2++ =  2.0 H2O  -2.0 H+      2.0 UO2++       5.6346    4.5    2.0   574.07
(UO2)3(OH)4++ =  4.0 H2O  -4.0 H+      3.0 UO2++      11.929     4.5    2.0   878.112
(UO2)3(OH)5+  =  5.0 H2O  -5.0 H+      3.0 UO2++      15.5862    4.0    1.0   895.12
(UO2)3(OH)7-  =  7.0 H2O  -7.0 H+      3.0 UO2++      31.0508    4.0   -1.0   929.135
(UO2)4(OH)7+  =  7.0 H2O  -7.0 H+      4.0 UO2++      21.9508    4.0    1.0   1199.16
UO2(H2PO4)(H3PO4)+ = 3.0 H+ 2.0 HPO4-- 1.0 UO2++     -22.7537    4.0    1.0   465.01
UO2(H2PO4)2(aq) =    2.0 H+ 2.0 HPO4-- 1.0 UO2++     -21.7437    3.0    0.0   464.002
Zn(OH)2(aq)   =  2.0 H2O  -2.0 H+      1.0 Zn++       17.3282    3.0    0.0    99.4047
Zn(OH)3-      =  3.0 H2O  -3.0 H+      1.0 Zn++       28.8369    4.0   -1.0   116.41200
Zn(OH)4--     =  4.0 H2O  -4.0 H+      1.0 Zn++       41.6052    4.0   -2.0   133.41940
ZnOH+         =  1.0 H2O  -1.0 H+      1.0 Zn++        8.9600    4.0    1.0    82.39730

Ca2UO2(CO3)3(aq) =  2.0 Ca++ -3.0 H+     3.0 HCO3-   1.0 UO2++        0.2864   4.0    0.0   530.215
CaUO2(CO3)3--    =  1.0 Ca++ -3.0 H+     3.0 HCO3-   1.0 UO2++        3.8064   4.0   -2.0   530.215
CH4(aq)          =  1.0 H2O   1.0 H+     1.0 HCO3-  -2.0 O2(aq)     144.141    3.0    0.0     0.0
NaAlO2(aq)       =  2.0 H2O   1.0 Na+    1.0 Al+++  -4.0 H+          23.6266   3.0    0.0    81.9701
NaHP2O7--        = -1.0 H2O   1.0 Na+    1.0 H+      2.0 HPO4--      -6.8498   4.0   -2.0   197.941
NaHSiO3(aq)      =  1.0 H2O   1.0 Na+   -1.0 H+      1.0 SiO2(aq)     8.304    3.0    0.0   100.081
Fe+++            = -0.5 H2O   1.0 Fe++   1.0 H+      0.25 O2(aq)     -8.49     9.0    3.0    55.847
Fe3(OH)4(5+)     =  2.5 H2O   3.0 Fe++  -1.0 H+      0.75 O2(aq)    -19.1699   6.0    5.0   235.57
Fe(OH)2+         =  1.5 H2O   1.0 Fe++  -1.0 H+      0.25 O2(aq)     -2.82     4.0    1.0    89.8617
Fe(OH)3(aq)      =  2.5 H2O   1.0 Fe++  -2.0 H+      0.25 O2(aq)      3.51     3.0    0.0   106.869
Fe(OH)4-         =  3.5 H2O   1.0 Fe++  -3.0 H+      0.25 O2(aq)     13.11     4.0   -1.0   123.876
FeCO3+           = -0.5 H2O   1.0 Fe++   1.0 HCO3-   0.25 O2(aq)     -7.8812   4.0    1.0   115.856
MgHCO3+          =  1.0 H2O  -1.0 H+     1.0 CO2(aq) 1.0 Mg++         5.309    4.0    1.0    85.3221
N3-              =  0.5 H2O  -1.0 H+     1.5 N2(aq) -0.25 O2(aq)     77.7234   4.0   -1.0    42.0202
NH4+             =  1.5 H2O   1.0 H+     0.5 N2(aq) -0.75 O2(aq)     48.9895   2.5    1.0    18.0385
U+++             = -0.5 H2O   1.0 H+     1.0 UO2++  -0.75 O2(aq)     64.8028   5.0    3.0   238.029
U++++            = -1.0 H2O   2.0 H+     1.0 UO2++  -0.5 O2(aq)      33.949    5.5    4.0   238.029
UO2+             =  0.5 H2O  -1.0 H+     1.0 UO2++  -0.25 O2(aq)     20.0169   4.0    1.0   270.028
UO2OSi(OH)3+     =  2.0 H2O  -1.0 H+     1.0 SiO2(aq) 1.0 UO2++       2.4810   9.0    1.0   365.135
(UO2)2CO3(OH)3-  =  3.0 H2O  -4.0 H+     1.0 HCO3-   2.0 UO2++       11.2229   4.0   -1.0   651.087

Fe(SO4)2- = -0.5 H2O  1.0 Fe++  1.0 H+      2.0 SO4--   0.25 O2(aq)   -11.7037   4.0   -1.0   247.974
FeCl++    = -0.5 H2O  1.0 Fe++  1.0 H+      1.0 Cl-     0.25 O2(aq)    -7.6792   4.5    2.0    91.2997
FeCl2+    = -0.5 H2O  1.0 Fe++  1.0 H+      2.0 Cl-     0.25 O2(aq)   -10.62     4.0    1.0   126.752
FeCl4-    = -0.5 H2O  1.0 Fe++  1.0 H+      4.0 Cl-     0.25 O2(aq)    -7.7      4.0   -1.0   197.658
FeF++     = -0.5 H2O  1.0 Fe++  1.0 H+      1.0 F-      0.25 O2(aq)   -12.6265   4.5    2.0    74.8454
FeF2+     = -0.5 H2O  1.0 Fe++  1.0 H+      2.0 F-      0.25 O2(aq)   -16.8398   4.0    1.0    93.8438
FeH2PO4++ = -0.5 H2O  1.0 Fe++  2.0 H+      1.0 HPO4--  0.25 O2(aq)   -12.66     4.5    2.0   152.834
FeHPO4+   = -0.5 H2O  1.0 Fe++  1.0 H+      1.0 HPO4--  0.25 O2(aq)   -18.67     4.0    1.0   151.826
FeNO3++   = -0.5 H2O  1.0 Fe++  1.0 H+      1.0 NO3-    0.25 O2(aq)    -9.49     4.5    2.0   117.852
FeSO4+    = -0.5 H2O  1.0 Fe++  1.0 H+      1.0 SO4--   0.25 O2(aq)   -10.4176   4.0    1.0   151.911
MgUO2(CO3)3-- = 3.0 H2O -6.0 H+ 3.0 CO2(aq) 1.0 Mg++    1.00 UO2++     23.9105   3.0   -2.0   500.0
NH4SO4-   =  1.5 H2O  1.0 H+    0.5 N2(aq)  1.0 SO4--  -0.75 O2(aq)    57.2905   4.0   -1.0   114.102
</pre></div>
</div>
</section>
<section id="isotherms">
<h4>Isotherms<a class="headerlink" href="#isotherms" title="Link to this heading">#</a></h4>
<p>The <cite>“isotherms</cite>” section is the list of sorption processes that relate the sorbed concentration at
the solid surface to the aqueous concentration in contact with the solid at constant temperature.
It is a function of the free ion primary species concentrations, not total conentrations.
A sorption isotherm may represent equilibrium or kinetic processes depending on the data used to
fit the isotherm.
Each sublist has two parameters:</p>
<div class="admonition-isotherms-spec admonition">
<p class="admonition-title">isotherms-spec</p>
<ul class="simple">
<li><p><cite>“model</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> specifies the model name. The available options are <cite>“linear”,
`”langmuir</cite>”, and <cite>“freundlich</cite>”.</p></li>
<li><p><cite>“parameters</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> is the list of model parameters. The distribution
coefficient <em>K</em> is in the first position.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;isotherms&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;linear&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;parameters&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{10.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;B&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;langmuir&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;parameters&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{30.0, 0.1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;C&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;freundlich&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;parameters&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1.5, 1.25}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>A few examples are given below.
Each line has three fields: primary species name, adsorption isotherm model, and parameters.
The number of  parameters and their meaning depends on the model; although the first one
is always the distribution coefficient.</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span>Pu_238   linear    461168.4
U_234    linear    329406.0
Th_230   linear   1482327.0
Ra_226   linear     41175.75
Pb_210   linear   3294060.0
Tc_99    linear       988.218
</pre></div>
</div>
<p>NOTE: The parameters provided here are <em>global</em>.
The state field isotherm_kd overwrites any global data given here.</p>
</section>
<section id="general-kinetics">
<h4>General kinetics<a class="headerlink" href="#general-kinetics" title="Link to this heading">#</a></h4>
<p>The <cite>“general kinetics</cite>” section describes kinetic (slow) reactions in the form</p>
<div class="highlight-asc notranslate"><div class="highlight"><pre><span></span><span class="c">3</span><span class="w"> </span><span class="c">A(aq)</span><span class="w"> </span><span class="c">+</span><span class="w"> </span><span class="c">2</span><span class="w"> </span><span class="c">B(aq)</span><span class="w"> </span><span class="c">&lt;-&gt;</span><span class="w"> </span><span class="c">C(aq)</span><span class="w"> </span><span class="c">+</span><span class="w"> </span><span class="c">3</span><span class="w"> </span><span class="c">D(aq)</span><span class="w"> </span><span class="c">+</span><span class="w"> </span><span class="c">4</span><span class="w"> </span><span class="c">E(aq)</span>
</pre></div>
</div>
<p>where a number (stoichiometic coefficient) is followed by a species name.
Implementation of the generalized kinetic formulation is based of publication
“Multicomponent reactive transport modeling in variably saturated porous media
using a generalized formulation for kinetically controlled reactions” by K. Ulrich
Mayer (Water Res. Research, Vol.38:9, 1174, doi:10.1029/2001WR000862, 2002).</p>
<p>The list of parameters for each reaction includes</p>
<div class="admonition-general-kinetics-spec admonition">
<p class="admonition-title">general_kinetics-spec</p>
<ul class="simple">
<li><p><cite>“reactants</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the left-hand side of the above equation.</p></li>
<li><p><cite>“products</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the right-hand side of the above equation.</p></li>
<li><p><cite>“forward rate</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the forward reaction rate.</p></li>
<li><p><cite>“backward rate</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the reverse reaction rate.</p></li>
<li><p><cite>“reaction orders (reactants/products)</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> is the list of
reaction orders with respect to activies of dissolved species. The list
includes orders for reactants (first) and products (second).</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;general kinetics&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;general_0&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reactants&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0 Tritium&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;products&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;forward rate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.78577e-09&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;backward rate&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reaction orders (reactants/products)&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{3.0, 2.0, 0.0, 0.0, 0.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>This example describes decay of <em>Tritium</em>.</p>
</section>
<section id="mineral-thermodynamics-and-kinetics">
<h4>Mineral thermodynamics and kinetics<a class="headerlink" href="#mineral-thermodynamics-and-kinetics" title="Link to this heading">#</a></h4>
<p>The class for mineral reaction, should be written with the mineral as the reactant:</p>
<blockquote>
<div><p>Calcite = 1.0 Ca++ + 1.0 HCO3- -1.0 H+</p>
</div></blockquote>
<p>The <cite>“mineral kinetics</cite>” section includes at the moment both thermodynamic and kinetic data.
The list of parameters for each reaction includes</p>
<div class="admonition-mineral-spec admonition">
<p class="admonition-title">mineral-spec</p>
<ul class="simple">
<li><p><cite>“rate model</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the model name for reaction rate [mol/s]. Available option is <em>TST</em>.</p></li>
<li><p><cite>“equilibrium constant</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is logarithm of the equilibrium constant.</p></li>
<li><p><cite>“rate constant</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is log10 of the reaction rate constant.</p></li>
<li><p><cite>“modifiers</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the list of pairs: species name and value of modyfying exponent,
so that the string has always even number of words.</p></li>
<li><p><cite>“gram molecular weight</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is amount of a molecular substance whose weight,
in grams, is numerically equal to the molecular weight of that substance.</p></li>
<li><p><cite>“reaction</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the mineral reaction equation.</p></li>
<li><p><cite>“molar volume</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the molar volume, [m^3 / mol].</p></li>
<li><p><cite>“specific surface area</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the specific mineral surface area.</p></li>
</ul>
</div>
<p>The reaction rate is the dissolution rate for the mineral, so it is positive
for dissolution and negative for precipitation.
We assume that the sublist name is the mineral name.
We also assume that the mineral reaction includes only primary species and that
the modifying species are only primary species.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mineral kinetics&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Kaolinite&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;rate model&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;TST&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;rate constant&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;-8.967&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;modifiers&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;H+  7.77000E-01&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;gram molecular weight&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;258.16&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reaction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;5.0 H2O  -6.0 H+  2.0 Al+++  2.0 SiO2(aq)&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;equilibrium constant&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;7.57&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;molar volume&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;9.952e-05&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;specific surface area&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;100.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>A few examples of mineral reactions is beflow.
Each line in has five columns: mineral reaction, logarithm of equilibrium constant,
gram molecular weight [g/mol], molar volume [cm^3/mol],
and specific surface area [cm^2 mineral / cm^3 bulk].</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span>Halite       = 1.0 Na+   1.0 Cl-                                         1.58550   58.4425   27.0150  1.0
Gypsum       = 2.0 H2O   1.0 SO4-2   1.0 Ca++                           -4.581    172.1722   74.21216 1.0
Calcite      =-1.0 H+    1.0 HCO3-   1.0 Ca++                            1.8487   100.087    36.934   1.0
Gibbsite     = 3.0 H2O   1.0 Al+++  -3.0 H+                              7.756     78.0036   31.956   1.0
Schoepite    = 3.0 H2O  -2.0 H+      1.0 UO2++                           4.8333   322.058    66.08    1.0
Basaluminite =15.0 H2O -10.0 H+      4.0 Al+++    1.0 SO4--             22.2511   464.140   218.934   1.0
Ferrihydrite = 2.5 H2O   1.0 Fe++   -2.0 H+       0.25 O2(aq)           -3.594    106.869    23.99    1.0
Jurbanite    = 6.0 H2O   1.0 Al+++  -1.0 H+       1.0 SO4--             -3.23     230.064   126.0     1.0
Kaolinite    = 5.0 H2O  -6.0 H+      2.0 Al+++    2.0 SiO2(aq)           7.570    258.160    99.520   1.0
Soddyite     = 4.0 H2O  -4.0 H+      1.0 SiO2(aq) 2.0 UO2++              0.392    668.169   131.27    1.0
K-Feldspar   = 2.0 H2O   1.0 K+      1.0 Al+++   -4.0 H+  3.0 SiO2(aq)  -0.2753   278.332   108.87    1.0
Polyhalite   = 2.0 H2O   1.0 Mg++    2.0 Ca++     2.0 K+  4.0 SO4-2    -13.7440   218.1     100.9722  1.0
</pre></div>
</div>
</section>
<section id="ion-exchange-sites">
<h4>Ion exchange sites<a class="headerlink" href="#ion-exchange-sites" title="Link to this heading">#</a></h4>
<p>The <cite>“ion exchange sites</cite>” section is the list of ion exchange reactions.
Each sublist is named after the exchanger site and has the following parameters:</p>
<div class="admonition-ion-exchange-spec admonition">
<p class="admonition-title">ion_exchange-spec</p>
<ul class="simple">
<li><p><cite>“location</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the mineral name.</p></li>
<li><p><cite>“charge</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> is the exchanger charge.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ion exchange sites&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;X-&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;location&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;Bulk&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;charge&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;-1&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="ion-exchange-complexes">
<h4>Ion exchange complexes<a class="headerlink" href="#ion-exchange-complexes" title="Link to this heading">#</a></h4>
<p>The class for ion exchange complexation reaction</p>
<div class="highlight-asc notranslate"><div class="highlight"><pre><span></span><span class="c">NaX</span><span class="w"> </span><span class="c">&lt;===&gt;</span><span class="w"> </span><span class="c">Na+</span><span class="w"> </span><span class="c">+</span><span class="w"> </span><span class="c">X-</span>
</pre></div>
</div>
<p>The <cite>“ion exchange complexes</cite>” is the list of ion exchange complexation reactions.
We assume that the reactions are always written as one complex equals one primary
species plus one exchange site.
Each complex is defined by the following parameters:</p>
<div class="admonition-ion-exchange-complex-spec admonition">
<p class="admonition-title">ion_exchange_complex-spec</p>
<ul class="simple">
<li><p><cite>“reaction</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the exchange reaction.</p></li>
<li><p><cite>“equilibrium constant</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the logarithm of the equilibrium constant.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ion exchange complexes&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Na+X&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reaction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0 Na+  1.0 X-&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;equilibrium constant&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;Ca++X&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reaction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0 Ca++  2.0 X-&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;equilibrium constant&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.316228&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>A few additional examples, reaction equation and the equilibrium coefficient:</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span>Al+++X = 1.0 Al+++ 3.0 X-    1.71133
Ca0.5X = 0.5 Ca++  1.0 X-   -0.99
H+X    = 1.0 H+    1.0 X-    0.0251189
Mg++X  = 1.0 Mg++  2.0 X-    0.1666
</pre></div>
</div>
</section>
<section id="surface-complex-sites">
<h4>Surface complex sites<a class="headerlink" href="#surface-complex-sites" title="Link to this heading">#</a></h4>
<p>The <cite>“surface complex sites</cite>” section is the list of surface sites and related data.
Each site has one parameter <cite>“density</cite>”.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;surface complex sites&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;&gt;davis_OH&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;density&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;0.156199&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>NOTE: Each instance of this class should contain a single unique
surface site (e.g. &gt;FeOH) and ALL surface complexes associated with that site!</p>
</section>
<section id="surface-complexes">
<h4>Surface complexes<a class="headerlink" href="#surface-complexes" title="Link to this heading">#</a></h4>
<p>The <cite>“surface complexes</cite>” is the list of surface complexation reactions.
Each reaction is defined by the following parameters:</p>
<div class="admonition-surface-complex-spec admonition">
<p class="admonition-title">surface_complex-spec</p>
<ul class="simple">
<li><p><cite>“reaction</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is a surface complexation reaction involing the complex site
and primary species.</p></li>
<li><p><cite>“charge</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> is the charge of the complex.</p></li>
<li><p><cite>“equilibrium constant</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the logarithm of the reaction equilibrium coefficeint.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;surface complexes&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;(&gt;davis_O)UO2+&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;charge&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reaction&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0 &gt;davis_OH  -1.0 H+  1.0 UO2++&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;equilibrium constant&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;-0.444&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>A few additional examples.
Each line has three fields: reaction, logarithm of equailibrium coefficient, and charge.</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span>&gt;FeOH2+_s     = 1.0 &gt;FeOH_s   1.0 H+                        -7.18   1.0
&gt;FeO-_w       = 1.0 &gt;FeOH_w  -1.0 H+                         8.82  -1.0
&gt;FeOHUO2++    = 1.0 &gt;FeOH     1.0 UO2++                     -6.63   2.0
&gt;SiO-         =-1.0 H+        1.0 &gt;SiOH                      0.0
&gt;SiOH2+       = 1.0 H+        1.0 &gt;SiOH                      0.0
&gt;AlOUO2+      = 1.0 &gt;AlOH    -1.0 H+   1.0 UO2++            -3.13   1.0
&gt;FeOHZn+_s    = 1.0 &gt;FeOH_s  -1.0 H+   1.0 Zn++             -0.66   1.0
&gt;SiOUO3H3++   = 1.0 &gt;SiOH     1.0 H2O  1.0 UO2++             5.18   2.0
&gt;UO2++        = 1.0 UO2++    -1.0 Ca++ 1.0 &gt;Ca++            -5.12   0.0
&gt;SiOUO3H2+    = 1.0 &gt;SiOH     1.0 H2O  -1.0 H+  1.0 UO2++    5.18   1.0
&gt;SiOUO3H      = 1.0 &gt;SiOH     1.0 H2O  -2.0 H+  1.0 UO2++    5.18   0.0
&gt;SiOUO3-      = 1.0 &gt;SiOH     1.0 H2O  -3.0 H+  1.0 UO2++   12.35  -1.0
&gt;SiOUO2(OH)2- = 1.0 &gt;SiOH     2.0 H2O  -3.0 H+  1.0 UO2++   12.35  -1.0
&gt;FeOHUO3      = 1.0 &gt;FeOH     1.0 H2O  -2.0 H+  1.0 UO2++    3.05   0.0
</pre></div>
</div>
</section>
<section id="radioactive-decay">
<h4>Radioactive decay<a class="headerlink" href="#radioactive-decay" title="Link to this heading">#</a></h4>
<p>The <cite>“radiaoctive decay</cite>” section is the list of decay reactions for aqueous and
sorbed species. It not deal with decay of solid phase.
Currently, it does not deal with decay of solid phase.</p>
<div class="admonition-radioactive-decay-spec admonition">
<p class="admonition-title">radioactive_decay-spec</p>
<ul class="simple">
<li><p><cite>“reactant</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the species name.</p></li>
<li><p><cite>“product</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is the species name.</p></li>
<li><p><cite>“half life</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> is the half-life time of decay.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;radioactive decay&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;complex_0&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reactant&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;A&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;product&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;B&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;half life&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;3.9447e+08&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;complex_1&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reactant&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;B&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;product&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;C&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;half life&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;7.8894e+08&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;complex_2&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;reactant&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;C&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;product&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;half life&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.57788e+08&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>A few additionale examples:</p>
<div class="highlight-bc notranslate"><div class="highlight"><pre><span></span>Cs<span class="m">137</span>  <span class="o">--&gt;</span>  <span class="m">1.0</span> Cs<span class="m">137</span>    half_life <span class="m">30.2</span> years
Pb_<span class="m">210</span> <span class="o">--&gt;</span>               half_life <span class="m">22.2</span> years
Pu_<span class="m">238</span> <span class="o">--&gt;</span>  <span class="m">1.0</span> U_<span class="m">234</span>    half_life <span class="m">87.7</span> years
Ra_<span class="m">226</span> <span class="o">--&gt;</span>  <span class="m">1.0</span> Pb_<span class="m">210</span>   half_life <span class="m">1.6</span>e<span class="m">3</span> years
Th_<span class="m">230</span> <span class="o">--&gt;</span>  <span class="m">1.0</span> Ra_<span class="m">226</span>   half_life <span class="m">7.54</span>e<span class="m">4</span> years
U_<span class="m">234</span>  <span class="o">--&gt;</span>  <span class="m">1.0</span> Th_<span class="m">230</span>   half_life <span class="m">2.45</span>e<span class="m">5</span> years
Tc_<span class="m">99</span>  <span class="o">--&gt;</span>               half_life <span class="m">2.111</span>e<span class="m">5</span> years
Sr<span class="m">90</span>   <span class="o">--&gt;</span>  <span class="m">1.0</span> Sr<span class="m">90</span>     half_life <span class="m">28.8</span> years
</pre></div>
</div>
</section>
</section>
</section>
<section id="output-data">
<h2><a class="toc-backref" href="#id92" role="doc-backlink">OUTPUT DATA</a><a class="headerlink" href="#output-data" title="Link to this heading">#</a></h2>
<p>Amanzi uses a few ways to communicate simulation data to the user that includes
a short file with observations and full-scale visualization files.</p>
<section id="observation-file">
<h3><a class="toc-backref" href="#id93" role="doc-backlink">Observation file</a><a class="headerlink" href="#observation-file" title="Link to this heading">#</a></h3>
<p>A user may request any number of specific observations from Amanzi.
Each labeled observation data quantity involves a field quantity, a model, a region from which it will extract its source data, and a list of discrete times
for its evaluation.  The observations are evaluated during the simulation and returned to the calling process through one of Amanzi arguments.</p>
<div class="admonition-observations-spec admonition">
<p class="admonition-title">observations-spec</p>
<ul class="simple">
<li><p><cite>“observation data</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> can accept multiple lists for named observations.</p>
<ul>
<li><p><cite>“observation output filename</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> user-defined name for the file that the observations are written to.
The file name can contain relative or absolute path to an <em>existing</em> directory only.</p></li>
<li><p><cite>“time unit</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines time unit for output data.
Available options are <cite>“s</cite>”, <cite>“h</cite>”, <cite>“d</cite>”, and <cite>“y</cite>”. Default is <cite>“s</cite>”.</p></li>
<li><p><cite>“mass unit</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines mass unit for output data.
Available options are <cite>“g</cite>”, <cite>“lb</cite>”, and <cite>“lb</cite>”. Default is <cite>“kg</cite>”.</p></li>
<li><dl class="simple">
<dt><cite>“length unit</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines length unit for output data.</dt><dd><p>Available options are <cite>“cm</cite>”, <cite>“in</cite>”, <cite>“ft</cite>”, <cite>“yd</cite>” , <cite>“m</cite>”, and <cite>“km</cite>”. Default is <cite>“m</cite>”.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>“concentration unit</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> defines concentration unit for output data.</dt><dd><p>Available options are <cite>“molar</cite>”, and <cite>“SI</cite>”. Default is <cite>“molar</cite>”.</p>
</dd>
</dl>
</li>
<li><p><cite>“precision</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> defines the number of significant digits. Default is 16.</p></li>
<li><p>OBSERVATION <code class="docutils literal notranslate"><span class="pre">[list]</span></code> user-defined label, can accept values for <cite>“variables</cite>”, <cite>“functional</cite>”,
<cite>“region</cite>”, <cite>“times</cite>”, and TSPS (see below).</p>
<ul>
<li><p><cite>“domain name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> name of the domain. Typically, it is either <cite>“domain</cite>” for
the matrix/subsurface or <cite>“fracture</cite>” for the fracture network.</p></li>
<li><p><cite>“variable</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> a list of field quantities taken from the list of
available field quantities.</p></li>
<li><p><cite>“functional</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> the label of a function to apply to each of the variables
in the variable list (Function options detailed below)</p></li>
<li><p><cite>“region</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> the label of a user-defined region</p></li>
<li><p><cite>“cycles start period stop</cite>” [Array(int)] the first entry is the start cycle,
the second is the cycle period, and the third is the stop cycle or -1 in which case
there is no stop cycle. A visualization dump shall be written at such cycles that
satisfy cycle = start + n*period, for n=0,1,2,… and cycle &lt; stop if stop != -1.0.</p></li>
<li><p><cite>“cycles start period stop n</cite>” [Array(int)] if multiple cycles start-period-stop
parameters are needed, then use these parameters with n=0,1,2,…, and not the single
<cite>“cycles start period stop</cite>” parameter.</p></li>
<li><p><cite>“cycles</cite>” [Array(int)] an array of discrete cycles that at which a visualization dump shall be written.</p></li>
<li><p><cite>“times start period stop</cite>” [Array(double)] the first entry is the start time,
the second is the time period, and the third is the stop time or -1 in which case
there is no stop time. A visualization dump shall be written at such times that
satisfy time = start + n*period, for n=0,1,2,… and time &lt; stop if stop != -1.0.</p></li>
<li><p><cite>“times start period stop n</cite>” [Array(double) if multiple start-period-stop parameters
are needed, then use this these parameters with n=0,1,2,…, and not the
single  <cite>“times start period stop</cite>” parameter.</p></li>
<li><p><cite>“times</cite>” [Array(double)] an array of discrete times that at which a visualization
dump shall be written.</p></li>
<li><p><cite>“delimiter</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> the string used to delimit columns in the observation file
output, default is <cite>“,</cite>”.</p></li>
<li><p><cite>“interpolation</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> the string which defines
the interpolation method to compute observation. Works ONLY with
Line Segment region at the moment. Available options <cite>“linear</cite>”
and <cite>“constant</cite>”. Default is <cite>“linear</cite>”</p></li>
<li><p><cite>“weighting</cite>”  <code class="docutils literal notranslate"><span class="pre">[string]</span></code> the string defined the weighting
function applied to compute observation. Works ONLY with
Line Segment region at the moment. Available options <cite>“flux norm</cite>”
and <cite>“none</cite>”. Default is <cite>“none</cite>”. <cite>“flux norm</cite>” is the absolute
value of the Darcy flux in a cell.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>Available observation variables:</p>
<ul class="simple">
<li><p>volumetric water content [-] (volume water / bulk volume)</p></li>
<li><p>aqueous saturation [-] (volume water / volume pore space)</p></li>
<li><p>aqueous pressure [Pa]</p></li>
<li><p>hydraulic head [m]</p></li>
<li><p>permeability-weighted hydraulic head [m]</p></li>
<li><p>drawdown [m]</p></li>
<li><p>permeability-weighted drawdown [m]</p></li>
<li><p>volumetric water content [-]</p></li>
<li><p>gravimetric water content [-]</p></li>
<li><p>water table [m]</p></li>
<li><p>SOLUTE aqueous concentration [mol/m^3]</p></li>
<li><p>SOLUTE gaseous concentration [mol/m^3]</p></li>
<li><p>SOLUTE sorbed concentration [mol/kg]</p></li>
<li><p>SOLUTE free ion concentration</p></li>
<li><p>x-, y-, z- aqueous volumetric flux [m/s]</p></li>
<li><p>material id [-]</p></li>
<li><p>aqueous mass flow rate [kg/s] (when funtional=”integral”)</p></li>
<li><p>aqueous volumetric flow rate [m^3/s] (when functional=”integral”)</p></li>
<li><p>fractures aqueous volumetric flow rate [m^3/s] (when functional=”integral”)</p></li>
<li><p>SOLUTE volumetric flow rate [mol/s] (when functional=”integral”)</p></li>
<li><p>SOLUTE breakthrough curve [mol] (when functional=”integral”)</p></li>
<li><p>pH [-]</p></li>
<li><p>centroid x [m]</p></li>
</ul>
<p>Observations <em>drawdown</em> and <em>permeability-weighted</em> are calculated with respect to the value
registered at the first time it was requested.</p>
<p>The following observations are point-type obervations: “water table”, “drawdown”.</p>
<p>The following observations are integrated continuously in time but saved only at specified
times: “SOLUTE breakthrough curve”.</p>
<p>The following observation functionals are currently supported.
All of them operate on the variables identified.</p>
<div class="admonition-observation-data-spec admonition">
<p class="admonition-title">observation_data-spec</p>
<ul class="simple">
<li><p><cite>“observation data: point</cite>” returns the value of the field quantity at a point.</p></li>
<li><p><cite>“observation data: integral</cite>” returns the integral of the field quantity over the region specified.</p></li>
<li><p><cite>“observation data: extensive integral</cite>” returns the integral of an extensive variable
over the region specified.  Note that this should be used over the above Integral when
the variable to be integrated is an extensive quantity, i.e. water content or flux.</p></li>
<li><p><cite>“observation data: minimum</cite>” and <cite>“observation data: maximum</cite>” returns the minimum
(respectively maximum) of the field quantity over the region specified.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;observation data&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;observation output filename&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_OUTPUT.out&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;precision&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_ANY OBSERVATION NAME&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_REGION&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;functional&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;observation data: point&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;variable&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;volumetric water content&quot;</span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycles&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{100000, 200000, 400000, 500000}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycles start period stop&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0, 100, -1}&quot;</span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{101.0, 303.0, 422.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times start period stop 0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0.0, 10.0, 100.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times start period stop 1&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{100.0, 25.0, -1.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;_ANY OBSERVATION NAME B&quot;</span><span class="nt">&gt;</span><span class="w">  </span><span class="cm">&lt;!-- another observation --&gt;</span>
<span class="w">    </span>...
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, we collect <cite>“volumetric water content</cite>” on four selected cycles,
every 100 cycles, three selected times, every 10 seconds from 0 to 100, and every 25 seconds after that.</p>
</section>
<section id="checkpoint-file">
<h3><a class="toc-backref" href="#id94" role="doc-backlink">Checkpoint file</a><a class="headerlink" href="#checkpoint-file" title="Link to this heading">#</a></h3>
<p>A user may request periodic dumps of Amanzi checkpoint data.
The user has no explicit control over the content of these files, but has the guarantee that
the Amanzi run will be reproducible (with accuracy determined
by machine round errors and randomness due to execution in a parallel computing environment).
Therefore, output controls for <em>checkpoint data</em> are limited to file name generation and writing
frequency, by numerical cycle number.</p>
<div class="admonition-checkpoint-file-spec admonition">
<p class="admonition-title">checkpoint_file-spec</p>
<ul class="simple">
<li><p><cite>“checkpoint data</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> can accept a file name base <code class="docutils literal notranslate"><span class="pre">[string]</span></code> and cycle data <code class="docutils literal notranslate"><span class="pre">[list]</span></code>
used to generate the file base name or directory base name that is used in writing checkpoint data.</p>
<ul>
<li><p><cite>“file name base</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> (“checkpoint”)</p></li>
<li><p><cite>“file name digits</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> Default value is 5.</p></li>
<li><p><cite>“cycles start period stop</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> the first entry is the start cycle, the second
is the cycle period, and the third is the stop cycle or -1 in which case there is no stop cycle.
A visualization dump shall be written at such cycles that satisfy cycle = start + n*period,
for n=0,1,2,… and cycle &lt; stop if stop != -1.0.</p></li>
<li><p><cite>“cycles start period stop n</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> if multiple cycles start period stop parameters
are needed, then use these parameters with n=0,1,2,…, and not the single <cite>“cycles start period stop</cite>” parameter.</p></li>
<li><p><cite>“cycles</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> an array of discrete cycles that at which a visualization dump shall be written.</p></li>
<li><p><cite>“times start period stop</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> the first entry is the start time,
the second is the time period, and the third is the stop time or -1 in which
case there is no stop time. A visualization dump shall be written at such times
that satisfy time = start + n*period, for n=0,1,2,… and time &lt; stop if stop != -1.0.</p></li>
<li><p><cite>“times start period stop n</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> if multiple start period stop parameters
are needed, then use this these parameters with n=0,1,2,…, and not the
single  <cite>“times start period stop</cite>” parameter.</p></li>
<li><p><cite>“times</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> an array of discrete times that at which a visualization dump shall be written.</p></li>
</ul>
</li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;checkpoint data&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file name base&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_CHKPOINT&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file name digits&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycles start period stop&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0, 100, -1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycles&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{999, 1001}&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times start period stop 0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0.0, 10.0, 100.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times start period stop 1&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{100.0, 25.0, -1.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{101.0, 303.0, 422.0}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, checkpoint data files are written when the cycle number is
a multiple of 100.</p>
</section>
<section id="visualization-file">
<h3><a class="toc-backref" href="#id95" role="doc-backlink">Visualization file</a><a class="headerlink" href="#visualization-file" title="Link to this heading">#</a></h3>
<p>A user may request periodic writes of field data for the purposes of visualization.
The user will specify explicitly what is to be included in the file at each snapshot.
Visualization files can only be written at intervals corresponding to the numerical
time step values or intervals corresponding to the cycle number; writes are controlled by time step cycle number.</p>
<div class="admonition-vis-spec admonition">
<p class="admonition-title">vis-spec</p>
<ul class="simple">
<li><p><cite>“visualization data</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> can accept a file name base <code class="docutils literal notranslate"><span class="pre">[string]</span></code> and cycle
data <code class="docutils literal notranslate"><span class="pre">[list]</span></code> that is used to generate the file base name or directory base name that
is used in writing visualization data.
It can also accept a set of lists to specify which field quantities to write.
The file name can contain relative or absolute path to an <em>existing</em> directory only.</p>
<ul>
<li><p><cite>“file name base</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> (“amanzi_vis”)</p></li>
<li><p><cite>“file format</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> (“XDMF”) Amanzi supports two types of
visualization files.  XDMF is the default and preferred method, but does
not correctly handle general polyhedra.  Serial, 3D general polyhedral
support is supported by the “SILO” option.  This will eventually be
extended to parallel, 2/3D support, but this is not yet implemented.</p></li>
<li><p><cite>“cycles start period stop</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> the first entry is the start cycle,
the second is the cycle period, and the third is the stop cycle or -1 in which case
there is no stop cycle. A visualization dump shall be written at such cycles that
satisfy cycle = start + n*period, for n=0,1,2,… and cycle &lt; stop if stop != -1.0.</p></li>
<li><p><cite>“cycles start period stop n</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> if multiple cycles start-period-stop parameters
are needed, then use these parameters with n=0,1,2,…, and not the single
<cite>“cycles start period stop</cite>” parameter.</p></li>
<li><p><cite>“cycles</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> an array of discrete cycles that at which a visualization dump shall be written.</p></li>
<li><p><cite>“times start period stop</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> the first entry is the start time,
the second is the time period, and the third is the stop time or -1 in which case
there is no stop time. A visualization dump shall be written at such times that
satisfy time = start + n*period, for n=0,1,2,… and time &lt; stop if stop != -1.0.</p></li>
<li><p><cite>“times start period stop n</cite>” [Array(double) if multiple start-period-stop parameters
are needed, then use this these parameters with n=0,1,2,…, and not the single
<cite>“times start period stop</cite>” parameter.</p></li>
<li><p><cite>“times</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> an array of discrete times that at which a visualization dump shall be written.</p></li>
<li><p><cite>“dynamic mesh</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> (false) write mesh data for every visualization dump,
this facilitates visualizing deforming meshes.</p></li>
<li><p><cite>“write regions</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> contains auxiliary fields with region ids to write into the visualization file.</p>
<ul>
<li><p><cite>“REGION_NAME</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> the user-defined field name and the list of assigned regions.
The first entry in the regions array is marked with the value 1.0 in the array,
the second with the value 2.0, and so forth.
The code ignores entries in the regions array that are not valid regions that contain cells.</p></li>
</ul>
</li>
<li><p><cite>“write partitions</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> (false) if this parameter is true, then write an array into
the visualization file that contains the rank number of the processor that owns a mesh cell.</p></li>
<li><p><cite>“time units</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> time units, e.g. <cite>“y</cite>” or <cite>“h</cite>”.</p></li>
</ul>
</li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;visualization data&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file name base&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_PLOT&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycles start period stop&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0, 100, -1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycles&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{999, 1001}&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times start period stop 0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0.0, 10.0, 100.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times start period stop 1&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{100.0, 25.0, -1.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{101.0, 303.0, 422.0}&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dynamic mesh&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;bool&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;write regions&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_OBS1, _OBS2, _OBS3}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;wells&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_OBS4}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="walkabout-file">
<h3><a class="toc-backref" href="#id96" role="doc-backlink">Walkabout file</a><a class="headerlink" href="#walkabout-file" title="Link to this heading">#</a></h3>
<p>A user may request periodic dumps of Walkabout data. Output controls for Walkabout data are
limited to file name generation and writing frequency, by numerical cycle number or time.</p>
<div class="admonition-walkabout-spec admonition">
<p class="admonition-title">walkabout-spec</p>
<ul class="simple">
<li><p><cite>“walkabout data</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> can accept a file name base <code class="docutils literal notranslate"><span class="pre">[string]</span></code> and cycle data [list]
used to generate the file base name or directory base name that is used in writing Walkabout data.</p>
<ul>
<li><p><cite>“file name base</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> The file name can contain relative or absolute path to an <em>existing</em>
directory only.  Default is <cite>“walkabout</cite>”.</p></li>
<li><p><cite>“file name digits</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> specify the number of digits that should be appended to the file
name for the cycle number. Default is 5.</p></li>
<li><p><cite>“cycles start period stop</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> the first entry is the start cycle,
the second is the cycle period, and the third is the stop cycle or -1 in which case
there is no stop cycle. A visualization dump shall be written at such cycles that
satisfy cycle = start + n*period, for n=0,1,2,… and cycle &lt; stop if stop != -1.0.</p></li>
<li><p><cite>“cycles start period stop n</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> if multiple cycles start-period-stop parameters
are needed, then use these parameters with n=0,1,2,…, and not the single
<cite>“cycles start period stop</cite>” parameter.</p></li>
<li><p><cite>“cycles</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> an array of discrete cycles that at which a visualization dump shall be written.</p></li>
<li><p><cite>“times start period stop</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> the first entry is the start time,
the second is the time period, and the third is the stop time or -1 in which case
there is no stop time. A visualization dump shall be written at such times that
satisfy time = start + n*period, for n=0,1,2,… and time &lt; stop if stop != -1.0.</p></li>
<li><p><cite>“times start period stop n</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> if multiple start-period-stop parameters
are needed, then use this these parameters with n=0,1,2,…, and not the single
<cite>“times start period stop</cite>” parameter.</p></li>
<li><p><cite>“times</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> an array of discrete times that at which a visualization dump shall be written.</p></li>
<li><p><cite>“write regions</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> contains three lists of equal size with region names,
material names, and material ids to write into the output file.</p>
<ul>
<li><p><cite>“region names</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> specifies names of regions.</p></li>
<li><p><cite>“material names</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> specifies names of materials.</p></li>
<li><p><cite>“material ids</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(int)]</span></code> specifies material ids.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>Example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;walkabout data&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file name base&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;_WALKABOUT&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;file name digits&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;int&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycles start period stop&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0, 100, -1}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;cycles&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{999, 1001}&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times start period stop 0&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{0.0, 10.0, 100.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times start period stop 1&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{100.0, 25.0, -1.0}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;times&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{101.0, 303.0, 422.0}&quot;</span><span class="nt">/&gt;</span>

<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;write regions&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;region names&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_REGION1, _REGION2}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;material names&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_MAT1, _MAT2}&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;material ids&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1000, 2000}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>In this example, walkabout data files are written when the cycle number is
a multiple of 100.</p>
</section>
<section id="mesh-info">
<h3><a class="toc-backref" href="#id97" role="doc-backlink">Mesh info</a><a class="headerlink" href="#mesh-info" title="Link to this heading">#</a></h3>
<p>A user may request to dump mesh information. Mesh information includes coordinates of cell centroids
written is the order consistent with all output fields.</p>
<div class="admonition-mesh-info-spec admonition">
<p class="admonition-title">mesh_info-spec</p>
<ul class="simple">
<li><p><cite>“filename</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> is name of the HDF5 file where coordinates of the centroids are dumped.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mesh info&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;filename&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;centroids&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>

<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mesh info fracture&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;filename&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;centroids_fracture&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="input-data">
<h2><a class="toc-backref" href="#id98" role="doc-backlink">INPUT DATA</a><a class="headerlink" href="#input-data" title="Link to this heading">#</a></h2>
<p>This section describes format and purpose of various input files.
In addition it explain how to verify the input information (e.g. regions) using special sublists.</p>
<section id="input-analysis">
<h3><a class="toc-backref" href="#id99" role="doc-backlink">Input analysis</a><a class="headerlink" href="#input-analysis" title="Link to this heading">#</a></h3>
<p>This list contains data collected by the input parser of a higher-level spec.</p>
<div class="admonition-input-analysis-spec admonition">
<p class="admonition-title">input_analysis-spec</p>
<ul class="simple">
<li><p><cite>“used boundary condition regions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> provides list of boundary regions
for analysis. The simulator will print number of faces and total area of these regions
if verbosity level is equal to or above <em>high</em>.</p></li>
<li><p><cite>“used source and sink regions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> provides list of source and sink regions
for analysis. The simulator will print number of cells and the total volume of these regions
if verbosity level is equal to or above <em>high</em>.</p></li>
<li><p><cite>“used observation regions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> provides list of observation regions
for analysis. The simulator will print number of faces(or cells) and the total area
(or volume) of these regions if verbosity level is equal to or above <em>high</em>.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;analysis&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;used boundary condition regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_REG1,_REG2}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;used source and sink regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_REG3,_REG4}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;used observation regions&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{_REG5}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbose object&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;verbosity level&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;high&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="tabulated-eos-format-amanzi">
<h3><a class="toc-backref" href="#id100" role="doc-backlink">Tabulated EOS format (Amanzi)</a><a class="headerlink" href="#tabulated-eos-format-amanzi" title="Link to this heading">#</a></h3>
<p>The tabulated equation of state uses a free format for integers, doubles and text string;
however, the order of block is fixed and string cannot have spaces.
The first three lines have the following format:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Amanzi
N1 scale shift temperature
N2 scale shift pressure
</pre></div>
</div>
<p>where <em>Ni</em> is the number of data points in either T or p directions,
<em>scale</em> and <em>shift</em> are the scale factor and shift required to convert data
to SI units, and <em>field_name</em> is either <cite>“temperature</cite>” or <cite>“pressure</cite>”</p>
<p>The second block has seven lines and the above format, except for <em>N</em> which
is now the total number of data points in the T-p table.</p>
<p>The third block provides data for physical fields using the following order:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>T p rho internal_energy enthalpy Cv Cp viscosity thermal_conductivity phase
</pre></div>
</div>
<p>where <em>phase</em> is the first letter of phase, <cite>“l</cite>” or <cite>“g</cite>”.</p>
<section id="example-for-liquid-water">
<h4>Example for liquid water<a class="headerlink" href="#example-for-liquid-water" title="Link to this heading">#</a></h4>
<p>In this example the following units are used for <em>3x3</em> tabulated data:
temperature [K], pressure [bar], density [kg/m3], internal energy [kJ/mol],
enthalpy [kJ/mol], Cv [J/mol*K], Cp [J/mol*K], viscosity [Pa*s], and thermal conductivity [W/m*K].
Thus, to convert these data to SI units, we specify non-unity factors for pressure, internal energy,
and enthalpy.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Amanzi
3 1.0000 0.0 temperature
3 1.0e+5 0.0 pressure

9 1.0000 0.0 density
9 1.0e+3 0.0 internal_energy
9 1000.0 0.0 enthalpy
9 1.0 0.0 cv
9 1.0 0.0 cp
9 1.0 0.0 viscosity
9 1.0 0.0 thermal_conductivity

280.15 0.5  999.879 0.530097 0.530997 75.6574 75.6793 0.00142708 0.574347  l
290.15 0.5  998.754  1.28544  1.28634 75.0821 75.4233 0.00107982 0.593025  l
300.15 0.5  996.493  2.03905  2.03995 74.3983 75.3170 0.000851   0.610549  l

280.15 1.0  999.904  0.530085 0.531887 75.6536 75.6756 0.00142701 0.574372  l
290.15 1.0  998.777  1.28540  1.28720  75.0787 75.4203 0.00107979  0.593048  l
300.15 1.0  996.515  2.03898  2.04078  74.3954 75.3145 0.000850991  0.610572  l

280.15 1.2 999.913  0.53008 0.532242 75.6521  75.6741  0.00142699  0.574382  l
290.15 1.2 998.787  1.28538 1.28754 75.0774  75.4191  0.00107978 0.593058  l
300.15 1.2 996.524  2.03895 2.04112 74.3942  75.3135  0.000850987  0.610581 l
</pre></div>
</div>
</section>
</section>
<section id="tabulated-eos-format-fehm">
<h3><a class="toc-backref" href="#id101" role="doc-backlink">Tabulated EOS format (FEHM)</a><a class="headerlink" href="#tabulated-eos-format-fehm" title="Link to this heading">#</a></h3>
<p>The tabulated equation of state uses a free format for integers, doubles and text string;
however, the order of block is fixed and string cannot have spaces.</p>
<section id="id29">
<h4>Example for liquid water<a class="headerlink" href="#id29" title="Link to this heading">#</a></h4>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>nonuniform                                                Grid type
   8    6     9                                          Array dimensions
   1.000000        0.000000                               Temperature factor and offset
   1.000000        0.000000                               Pressure factor and offset
   19                                                     Saturation line closeness flag
Table temperatures ---&gt;
 -200.00   -195.00   -190.00   -185.00   -180.00   -175.00   -170.00   -165.00
Table pressures ---&gt;
 6.5074101E-02  0.1195323   0.2031954   0.3243768   0.4918777   0.7149075
Array property types ---&gt;
density
dd/dt
dd/dp
enthalpy
dh/dt
dh/dp
viscosity
dv/dt
dv/dp
Density array ---&gt;
  900.9539  2.986970  2.792525  2.623569  2.474998  2.343097  2.225062  2.118721
  901.0682  878.6923  5.241142  4.904944  4.613682  4.357906  4.130922  3.927764
  901.2436  878.8931  855.6431  8.584902  8.033060  7.558094  7.142697  6.775020
  901.4971  879.1833  855.9796  831.6210  13.32351  12.44936  11.70498  11.05858
  901.8464  879.5831  856.4427  832.1661  806.3937  19.82610  18.47106  17.33520
  902.3099  880.1130  857.0560  832.8870  807.2585  779.6672  28.56710  26.48487
dD/dT array ---&gt;
 -4.401056  -4.465137  -3.634006E-02 -3.175270E-02 -2.8047204E-02 -2.4993611E-02 -2.2437597E-02 -2.0270992E-02
 -4.404730  -4.554480  -4.633789     -6.274590E-02 -5.4703809E-02 -4.8275996E-02 -4.3014195E-02 -3.8629483E-02
 -4.400110  -4.560047  -4.748645     -4.847290     -0.1026809     -8.9036323E-02 -7.8307390E-02 -6.9622092E-02
 -4.393451  -4.551746  -4.756232     -4.995862     -5.119995      -0.1618524     -0.1390779     -0.1215700
 -4.384296  -4.540369  -4.741705     -5.004901     -5.313653      -5.472827      -0.2490898     -0.2111700
 -4.372241  -4.525384  -4.722595     -4.979755     -5.321985      -5.728076      -5.937891      -0.3788673
dD/dP array ---&gt;
  1.676756  46.57508  44.38469  41.44989  38.92557  36.72093  34.77290  33.03539
  2.097235  1.917826  44.96321  43.16014  40.24044  37.75665  35.60374  33.71167
  2.093754  2.396778  2.227240  43.98545  42.51919  39.50047  36.97467  34.81088
  2.088050  2.390179  2.769690  2.630571  43.65722  42.49656  39.24163  36.58062
  2.081284  2.380574  2.756290  3.241876  3.168733  44.03999  43.17746  39.50084
  2.072423  2.367801  2.738755  3.216566  3.853050  3.902956  45.26769  44.73188
Enthalpy array ---&gt;
 -11.08680  202.0743    207.3656  212.5940  217.7786  222.9311  228.0593  233.1689
 -11.04795  -1.441901   205.8394  211.2797  216.6258  221.9066  227.1395  232.3360
 -10.98825  -1.385264   8.315416  209.1396  214.7777  220.2795  225.6877  231.0275
 -10.90171  -1.303152   8.391649  18.23019  211.8896  217.7864  223.4902  229.0631
 -10.78201  -1.189503   8.497250  18.32486  28.35650  213.9910  220.2263  226.1903
 -10.62244  -1.037911   8.638263  18.45154  28.46319  38.76015  215.3184  222.0043
dH/dT array ---&gt;
  1.917285  1.925377  1.051970  1.041299  1.033711  1.028070  1.023779  1.020430
  1.915049  1.933634  1.946059  1.078633  1.062691  1.051370  1.042940  1.036470
  1.914508  1.930367  1.957850  1.975565  1.113985  1.091000  1.074800  1.062750
  1.913727  1.929336  1.953334  1.991954  2.016201  1.160051  1.127669  1.105069
  1.912657  1.927926  1.951436  1.985925  2.038849  2.071369  1.219936  1.174710
  1.911247  1.926070  1.948945  1.982493  2.030861  2.102872  2.146351  1.298700
dH/dP array ---&gt;
 0.5700204  -31.36753  -27.58228  -23.85831  -20.98058  -18.67626  -16.78886  -15.21603
 0.7135022  0.5404872  -28.02403  -25.00951  -21.72656  -19.19770  -17.17040  -15.50379
 0.7139086  0.6773382  0.5040666  -25.57932  -23.12046  -20.11376  -17.81494  -15.97750
 0.7144175  0.6781194  0.6298733  0.4559285  -23.83204  -21.78361  -18.91836  -16.75610
 0.7151018  0.6791806  0.6314830  0.5667921  0.3892052  -22.65932  -20.92485  -18.07487
 0.7160630  0.6805639  0.6335793  0.5700380  0.4816387  0.2933709  -22.00557  -20.52189
Viscosity array ---&gt;
 2.0667833E-04  9.9999997E-06  5.9198064E-06  6.2753802E-06  6.6270109E-06  6.9747775E-06  7.3187521E-06  7.6590040E-06
 2.0685646E-04  1.7128805E-04  9.9999997E-06  6.2796817E-06  6.6325765E-06  6.9813382E-06  7.3261003E-06  7.6669758E-06
 2.0713007E-04  1.7152553E-04  1.4429199E-04  6.2892664E-06  6.6436955E-06  6.9936523E-06  7.3393444E-06  7.6809429E-06
 2.0752632E-04  1.7186940E-04  1.4459844E-04  1.2321399E-04  9.9999997E-06  7.0168890E-06  7.3631581E-06  7.7051855E-06
 2.0807389E-04  1.7234446E-04  1.4502162E-04  1.2360205E-04  1.0634069E-04  7.0617830E-06  7.4066052E-06  7.7475661E-06
 2.0880280E-04  1.7297656E-04  1.4558440E-04  1.2411769E-04  1.0682854E-04  9.2474213E-05  9.9999997E-06  7.8235007E-06
dV/dT array ---&gt;
-8.2993447E-06 -7.0931769E-06  7.1518159E-08  7.0720446E-08  6.9939738E-08  6.9174121E-08  6.8422651E-08  6.7684958E-08
-8.3128207E-06 -6.2673280E-06 -5.4209727E-06  7.1008344E-08  7.0165655E-08  6.9352382E-08  6.8563757E-08  6.7796513E-08
-8.3213863E-06 -6.2838080E-06 -4.8463658E-06 -4.2460219E-06  7.0438588E-08  6.9564884E-08  6.8729058E-08  6.7924752E-08
-8.3338045E-06 -6.2927879E-06 -4.8655406E-06 -3.8467074E-06 -3.4165248E-06  6.9696760E-08  6.8829650E-08  6.7998009E-08
-8.3509904E-06 -6.3052271E-06 -4.8742413E-06 -3.8680932E-06 -3.1414711E-06 -2.8306706E-06  6.8578309E-08  6.7805061E-08
-8.3739160E-06 -6.3218395E-06 -4.8858869E-06 -3.8755861E-06 -3.1643483E-06 -2.6455236E-06 -2.4201813E-06  6.6710982E-08
dV/dP array ---&gt;
 2.6134942E-06 -1.4940065E-08  4.0690097E-08  7.1375538E-08  9.5491849E-08  1.1454858E-07  1.2968569E-07  1.4171002E-07
 3.2705682E-06  2.2667357E-06  4.9334119E-08  1.0053603E-07  1.2079731E-07  1.3665340E-07  1.4908871E-07  1.5883744E-07
 3.2700600E-06  2.8380018E-06  2.0271643E-06  1.1456318E-07  1.6409528E-07  1.7355011E-07  1.8090707E-07  1.8653024E-07
 3.2694163E-06  2.8367640E-06  2.5274601E-06  1.8711472E-06  1.8563070E-07  2.3600580E-07  2.3299235E-07  2.3078385E-07
 3.2685762E-06  2.8350339E-06  2.5246798E-06  2.3140383E-06  1.7851987E-06  2.6802255E-07  3.2196141E-07  3.0296016E-07
 3.2674695E-06  2.8328298E-06  2.5211041E-06  2.3085806E-06  2.1822507E-06  1.7638789E-06  3.6895875E-07  4.3009413E-07
Saturation line intersection array ---&gt;
  F   T   F   F   F   F   F   F
  F   F   T   F   F   F   F   F
  F   F   F   T   F   F   F   F
  F   F   F   F   T   F   F   F
  F   F   F   F   F   T   F   F
  F   F   F   F   F   F   T   F
Saturation line closeness array ---&gt;
  0  10   0   0   0   0   0   0
  0   0  11   0   0   0   0   0
  0   0   0  12   0   0   0   0
  0   0   0   0  13   0   0   0
  0   0   0   0   0  14   0   0
  0   0   0   0   0   0  15   0

    6               Number of saturation line vertices
Pressure            Temperature         dP/dT               Cell      Intersection_type
 6.5074101E-02       -195.0000           1.0891641E-02         487        6
 0.1195323           -190.0000           1.6732618E-02         541        6
 0.2031954           -185.0000           2.4236280E-02         595        6
 0.3243768           -180.0000           3.3500183E-02         649        6
 0.4918777           -175.0000           4.4605963E-02         703        6
 0.7149075           -170.0000           5.7636499E-02         757        6


Liquid properties at saturation line vertices ---&gt;
Density     dD/dT      dD/dP      Enthalpy   dH/dT      dH/dP      Viscosity       dV/dT          dV/dP
  878.6282  -4.465137   1.176809  -1.459917   1.925377  0.3308200  1.7121245E-04  -7.0931769E-06  1.3881693E-06
  855.5234  -4.633789   1.431348   8.288394   1.946059  0.3229902  1.4418318E-04  -5.4209727E-06  1.3005098E-06
  831.4067  -4.847290   1.768377   18.19324   1.975565  0.3049078  1.2306188E-04  -4.2460219E-06  1.2552354E-06
  806.0210  -5.119995   2.224947   28.31119   2.016201  0.2704890  1.0613137E-04  -3.4165248E-06  1.2496769E-06
  779.0295  -5.472827   2.858964   38.71334   2.071369  0.2098658  9.2187336E-05  -2.8306706E-06  1.2862695E-06
  749.9777  -5.937891   3.772253   49.49191   2.146351  0.1066512  8.0373306E-05  -2.4201813E-06  1.3734772E-06

Vapour properties at saturation line vertices ---&gt;
Density     dD/dT           dD/dP     Enthalpy  dH/dT     dH/dP      Viscosity      dV/dT           dV/dP
  2.986970  -3.8888931E-02  46.57508  202.0743  1.058261  -31.36753  5.5601986E-06  7.1921569E-08  -1.4940065E-08
  5.241141  -6.7239381E-02  44.96321  205.8395  1.088046  -28.02403  5.9224931E-06  7.1437718E-08   4.9334119E-08
  8.584903  -0.1103685      43.98545  209.1396  1.127609  -25.57932  6.2892664E-06  7.0885832E-08   1.1456318E-07
  13.32350  -0.1748287      43.65722  211.8897  1.179343  -23.83204  6.6661905E-06  7.0139684E-08   1.8563070E-07
  19.82610  -0.2710075      44.03999  213.9910  1.247070  -22.65932  7.0617830E-06  6.8964439E-08   2.6802255E-07
  28.56710  -0.4164467      45.26769  215.3184  1.337180  -22.00557  7.4888940E-06  6.6921345E-08   3.6895875E-07
</pre></div>
</div>
</section>
</section>
<section id="tabulated-function-file-format">
<h3><a class="toc-backref" href="#id102" role="doc-backlink">Tabulated function file format</a><a class="headerlink" href="#tabulated-function-file-format" title="Link to this heading">#</a></h3>
<p>The following ASCII input file format supports the definition of a tabulated function defined over a grid.
Several XML input Parameters refer to files in this format.
The file consists of the following records (lines).
Each record is on a single line, except for the DATAVAL record which may be split across multiple lines.</p>
<ol class="arabic simple">
<li><p><strong>DATATYPE</strong>:  An integer value: 0 for integer data, 1 for real data.</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>An integer-valued file is used to define a ‘color’ function used in the definition of a region.</p></li>
</ul>
</div></blockquote>
<p>2. <strong>GRIDTYPE</strong>:  A string that specifies the type of grid used to define the function.
The format of the rest of the file is contingent upon this value.
The currently supported options are uniform rectilinear grids in 1, 2 and 3-D,
which are indicated by the values <cite>1DCoRectMesh</cite>, <cite>2DCoRectMesh</cite> and <cite>3DCoRectMesh</cite>,
respectively (names adopted from XDMF).</p>
<p>For the uniform rectilinear grids, the remaining records are as follows.
Several records take 1, 2 or 3 values depending on the space dimension of the grid.</p>
<p>3. <strong>NXNYNZ</strong>: 3 (or 2, 1) integer values (NX, NY, NZ) giving the number of zones in
the x, y and z coordinate directions, respectively.</p>
<p>4. <strong>CORNER1</strong>: 3 (or 2, 1) floating point values (X1, Y1, Z1) giving the coordinate
of the first corner of the domain.</p>
<p>5. <strong>CORNER2</strong>: 3 (or 2, 1) floating point values (X2, Y2, Z2) giving the coordinate
of the second corner of the domain.  The grid points r_{i,j,k} = (x_i, y_j, z_j) are defined as:</p>
<blockquote>
<div><p>x_i = X1 + i*(X2-X1)/NX, 0 &lt;= i &lt;= NX</p>
<p>y_j = Y1 + j*(Y2-Y1)/NY, 0 &lt;= j &lt;= NY</p>
<p>z_k = Z1 + k*(Z2-Z1)/NZ, 0 &lt;= k &lt;= NZ</p>
</div></blockquote>
<p>The (i,j,k) grid cell is defined by the corner grid points r_{i-1,j-1,k-1} and
r_{i,j,k}, for 1 &lt;= i &lt;= NX, 1 &lt;= j &lt;= NY, 1 &lt;= k &lt;= NZ.
Note that the corner points are any pair of opposite corner points; the ordering of grid
points and cells starts at CORNER1 and ends at CORNER2.</p>
<ol class="arabic simple" start="6">
<li><p><strong>DATALOC</strong>:  An integer value: 0 for cell-based data, 1 for point-based data.</p></li>
</ol>
<p>7. <strong>DATACOL</strong>:  An integer (N) giving the number of “columns” in the data.
This is the number of values per grid cell/point.
N=1 for a scalar valued function; N&gt;1 for a N-vector valued function.</p>
<blockquote>
<div><ul class="simple">
<li><p>only a single column is currently supported.</p></li>
</ul>
</div></blockquote>
<p>8. <strong>DATAVAL</strong>: The values of the function on the cells/points of the grid.
The values should appear in Fortran array order were the values stored in
the Fortran array A(N,NX,NY,NZ) (A(N,0:NX,0:NY,0:NZ) for point-based data).
That is, the column index varies fastest, x grid index next fastest, etc.</p>
<section id="id30">
<h4>Example<a class="headerlink" href="#id30" title="Link to this heading">#</a></h4>
<p>As an example, consider the following integer-valued function in 2-D:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>          <span class="o">+-----+-----+-----+</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">)</span>
          <span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>
          <span class="o">|</span>  <span class="mi">2</span>  <span class="o">|</span>  <span class="mi">1</span>  <span class="o">|</span>  <span class="mi">1</span>  <span class="o">|</span>
          <span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>
          <span class="o">+-----+-----+-----+</span>
          <span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>
          <span class="o">|</span>  <span class="mi">5</span>  <span class="o">|</span>  <span class="mi">1</span>  <span class="o">|</span>  <span class="mi">2</span>  <span class="o">|</span>
          <span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>     <span class="o">|</span>
<span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">+-----+-----+-----+</span>
</pre></div>
</div>
<p>The corresponding input file would be:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>0
2DCoRectMesh
3 2
0.0 0.0
2.0 3.0
0
1
5 1 2 2 1 1
</pre></div>
</div>
</section>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="input_specs.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Input Specification</p>
      </div>
    </a>
    <a class="right-next"
       href="AmanziInputSpec-u.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Unstructured Input Specification for Amanzi  1.6-dev</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 202X, jointly shared by contributor institutions.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>