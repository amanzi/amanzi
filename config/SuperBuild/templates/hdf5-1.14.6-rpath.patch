--- hdf5-1.14.6-orig/config/cmake/HDFMacros.cmake	2025-06-28 06:19:52
+++ hdf5-1.14.6/config/cmake/HDFMacros.cmake	2025-06-28 06:26:18
@@ -465,17 +465,21 @@
   set (CMAKE_INSTALL_RPATH_USE_LINK_PATH  OFF)
   # add the automatically determined parts of the RPATH
   # which point to directories outside the build tree to the install RPATH
-  set (CMAKE_BUILD_WITH_INSTALL_RPATH ON)
+  set (CMAKE_BUILD_WITH_INSTALL_RPATH OFF)
   if (APPLE)
-    set (CMAKE_INSTALL_NAME_DIR "@rpath")
-    set (CMAKE_INSTALL_RPATH
-        "@executable_path/../${${package_prefix}_INSTALL_LIB_DIR}"
-        "@executable_path/"
-        "@loader_path/../${${package_prefix}_INSTALL_LIB_DIR}"
-        "@loader_path/"
-    )
+    set(CMAKE_MACOSX_RPATH ON)
+    #set (CMAKE_INSTALL_NAME_DIR "@rpath")
+    #set (CMAKE_INSTALL_RPATH
+    #    "@executable_path/../${${package_prefix}_INSTALL_LIB_DIR}"
+    #    "@executable_path/"
+    #    "@loader_path/../${${package_prefix}_INSTALL_LIB_DIR}"
+    #    "@loader_path/"
+    #)
   else ()
     set (CMAKE_INSTALL_RPATH "\$ORIGIN/../${${package_prefix}_INSTALL_LIB_DIR}:\$ORIGIN/")
+    if (BUILD_STATIC_EXECS)
+      set (CMAKE_SKIP_INSTALL_RPATH ON)
+    endif ()  
   endif ()
 
   if (DEFINED ADDITIONAL_CMAKE_PREFIX_PATH AND EXISTS "${ADDITIONAL_CMAKE_PREFIX_PATH}")
