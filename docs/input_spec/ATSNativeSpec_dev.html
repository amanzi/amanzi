<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.13.1: http://docutils.sourceforge.net/" />
<title></title>
<style type="text/css">

/* Stylesheet for pygments enhanced reStructured Text */
/* ================================================== */

/* :Author:    Guenter Milde */
/* :Copyright: 2007 G. Milde */
/*             This stylesheet is released under the GPL v. 2 or later */

/* This stylesheet provides syntax highlight for documents generated with a */
/* pygments_ enhanced reStructured Text -> html converter. */

/* Import the default docutils style sheet */
/* --------------------------------------- */
/* :: */

@import url("/stylesheets/html4css1.css");         

/* Indent the code block */
/* --------------------- */

/* Content copied from the `html4css1.css` rule for literal blocks. */
/* Selector adapted to the output of Pygments_. :: */

div.highlight {
  margin-left: 2em ;
  margin-right: 2em ;
  background-color: #eeeeee
  }


/* Colour code blocks */
/* ------------------ */

/* Pygments_ has an option to generate stylesheets for html and latex. */
/* The following code is generated with the command */
/* `pygmentize -S default -f html > pygments-default.css`:: */

.c { color: #008800; font-style: italic } /* Comment */
.err { border: 1px solid #FF0000 } /* Error */
.k { color: #AA22FF; font-weight: bold } /* Keyword */
.o { color: #666666 } /* Operator */
.cm { color: #008800; font-style: italic } /* Comment.Multiline */
.cp { color: #008800 } /* Comment.Preproc */
.c1 { color: #008800; font-style: italic } /* Comment.Single */
.gd { color: #A00000 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #FF0000 } /* Generic.Error */
.gh { color: #000080; font-weight: bold } /* Generic.Heading */
.gi { color: #00A000 } /* Generic.Inserted */
.go { color: #808080 } /* Generic.Output */
.gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.gt { color: #0040D0 } /* Generic.Traceback */
.kc { color: #AA22FF; font-weight: bold } /* Keyword.Constant */
.kd { color: #AA22FF; font-weight: bold } /* Keyword.Declaration */
.kp { color: #AA22FF } /* Keyword.Pseudo */
.kr { color: #AA22FF; font-weight: bold } /* Keyword.Reserved */
.kt { color: #AA22FF; font-weight: bold } /* Keyword.Type */
.m { color: #666666 } /* Literal.Number */
.s { color: #BB4444 } /* Literal.String */
.na { color: #BB4444 } /* Name.Attribute */
.nb { color: #AA22FF } /* Name.Builtin */
.nc { color: #0000FF } /* Name.Class */
.no { color: #880000 } /* Name.Constant */
.nd { color: #AA22FF } /* Name.Decorator */
.ni { color: #999999; font-weight: bold } /* Name.Entity */
.ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.nf { color: #00A000 } /* Name.Function */
.nl { color: #A0A000 } /* Name.Label */
.nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.nt { color: #008000; font-weight: bold } /* Name.Tag */
.nv { color: #B8860B } /* Name.Variable */
.ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.mf { color: #666666 } /* Literal.Number.Float */
.mh { color: #666666 } /* Literal.Number.Hex */
.mi { color: #666666 } /* Literal.Number.Integer */
.mo { color: #666666 } /* Literal.Number.Oct */
.sb { color: #BB4444 } /* Literal.String.Backtick */
.sc { color: #BB4444 } /* Literal.String.Char */
.sd { color: #BB4444; font-style: italic } /* Literal.String.Doc */
.s2 { color: #BB4444 } /* Literal.String.Double */
.se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.sh { color: #BB4444 } /* Literal.String.Heredoc */
.si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.sx { color: #008000 } /* Literal.String.Other */
.sr { color: #BB6688 } /* Literal.String.Regex */
.s1 { color: #BB4444 } /* Literal.String.Single */
.ss { color: #B8860B } /* Literal.String.Symbol */
.bp { color: #AA22FF } /* Name.Builtin.Pseudo */
.vc { color: #B8860B } /* Name.Variable.Class */
.vg { color: #B8860B } /* Name.Variable.Global */
.vi { color: #B8860B } /* Name.Variable.Instance */
.il { color: #666666 } /* Literal.Number.Integer.Long */

/* .. _pygments:  http://pygments.org/ */

</style>
<style type="text/css">

/*
*   math2html: convert LaTeX equations to HTML output.
*
*   Copyright (C) 2009,2010 Alex Fernández
*
*   Released under the terms of the `2-Clause BSD license'_, in short:
*   Copying and distribution of this file, with or without modification,
*   are permitted in any medium without royalty provided the copyright
*   notice and this notice are preserved.
*   This file is offered as-is, without any warranty.
*
* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause
*
*   Based on eLyXer: convert LyX source files to HTML output.
*   http://elyxer.nongnu.org/
*/
/* --end--
* CSS file for LaTeX formulas.
*/

/* Formulas */
.formula {
	text-align: center;
	font-family: "Droid Serif", "DejaVu Serif", "STIX", serif;
	margin: 1.2em 0;
}
span.formula {
	white-space: nowrap;
}
div.formula {
	padding: 0.5ex;
	margin-left: auto;
	margin-right: auto;
}

/* Basic features */
a.eqnumber {
	display: inline-block;
	float: right;
	clear: right;
	font-weight: bold;
}
span.unknown {
	color: #800000;
}
span.ignored, span.arraydef {
	display: none;
}
.formula i {
	letter-spacing: 0.1ex;
}

/* Alignment */
.align-left, .align-l {
	text-align: left;
}
.align-right, .align-r {
	text-align: right;
}
.align-center, .align-c {
	text-align: center;
}

/* Structures */
span.overline, span.bar {
	text-decoration: overline;
}
.fraction, .fullfraction {
	display: inline-block;
	vertical-align: middle;
	text-align: center;
}
.fraction .fraction {
	font-size: 80%;
	line-height: 100%;
}
span.numerator {
	display: block;
}
span.denominator {
	display: block;
	padding: 0ex;
	border-top: thin solid;
}
sup.numerator, sup.unit {
	font-size: 70%;
	vertical-align: 80%;
}
sub.denominator, sub.unit {
	font-size: 70%;
	vertical-align: -20%;
}
span.sqrt {
	display: inline-block;
	vertical-align: middle;
	padding: 0.1ex;
}
sup.root {
	font-size: 70%;
	position: relative;
	left: 1.4ex;
}
span.radical {
	display: inline-block;
	padding: 0ex;
	font-size: 150%;
	vertical-align: top;
}
span.root {
	display: inline-block;
	border-top: thin solid;
	padding: 0ex;
	vertical-align: middle;
}
span.symbol {
	line-height: 125%;
	font-size: 125%;
}
span.bigsymbol {
	line-height: 150%;
	font-size: 150%;
}
span.largesymbol {
	font-size: 175%;
}
span.hugesymbol {
	font-size: 200%;
}
span.scripts {
	display: inline-table;
	vertical-align: middle;
}
.script {
	display: table-row;
	text-align: left;
	line-height: 150%;
}
span.limits {
	display: inline-table;
	vertical-align: middle;
}
.limit {
	display: table-row;
	line-height: 99%;
}
sup.limit, sub.limit {
	line-height: 100%;
}
span.symbolover {
	display: inline-block;
	text-align: center;
	position: relative;
	float: right;
	right: 100%;
	bottom: 0.5em;
	width: 0px;
}
span.withsymbol {
	display: inline-block;
}
span.symbolunder {
	display: inline-block;
	text-align: center;
	position: relative;
	float: right;
	right: 80%;
	top: 0.3em;
	width: 0px;
}

/* Environments */
span.array, span.bracketcases, span.binomial, span.environment {
	display: inline-table;
	text-align: center;
	border-collapse: collapse;
	margin: 0em;
	vertical-align: middle;
}
span.arrayrow, span.binomrow {
	display: table-row;
	padding: 0ex;
	border: 0ex;
}
span.arraycell, span.bracket, span.case, span.binomcell, span.environmentcell {
	display: table-cell;
	padding: 0ex 0.2ex;
	line-height: 99%;
	border: 0ex;
}
/*
* CSS file for LaTeX formulas, extra stuff:
* binomials, vertical braces, stackrel, fonts and colors.
*/

/* Inline binomials */
span.binom {
	display: inline-block;
	vertical-align: middle;
	text-align: center;
	font-size: 80%;
}
span.binomstack {
	display: block;
	padding: 0em;
}

/* Over- and underbraces */
span.overbrace {
	border-top: 2pt solid;
}
span.underbrace {
	border-bottom: 2pt solid;
}

/* Stackrel */
span.stackrel {
	display: inline-block;
	text-align: center;
}
span.upstackrel {
	display: block;
	padding: 0em;
	font-size: 80%;
	line-height: 64%;
	position: relative;
	top: 0.15em;

}
span.downstackrel {
	display: block;
	vertical-align: bottom;
	padding: 0em;
}

/* Fonts */
span.mathsf, span.textsf {
	font-style: normal;
	font-family: sans-serif;
}
span.mathrm, span.textrm {
	font-style: normal;
	font-family: serif;
}
span.text, span.textnormal {
	font-style: normal;
}
span.textipa {
	color: #008080;
}
span.fraktur {
	font-family: "Lucida Blackletter", eufm10, blackletter;
}
span.blackboard {
	font-family: Blackboard, msbm10, serif;
}
span.scriptfont {
	font-family: "Monotype Corsiva", "Apple Chancery", "URW Chancery L", cursive;
	font-style: italic;
}

/* Colors */
span.colorbox {
	display: inline-block;
	padding: 5px;
}
span.fbox {
	display: inline-block;
	border: thin solid black;
	padding: 2px;
}
span.boxed, span.framebox {
	display: inline-block;
	border: thin solid black;
	padding: 5px;
}


</style>
</head>
<body>
<div class="document">


<div class="section" id="ats-native-xml-input-specification-v1">
<h1><a class="toc-backref" href="#id2">ATS Native XML Input Specification V1</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first"><strong>Table of Contents</strong></p>
<ul class="simple">
<li><a class="reference internal" href="#ats-native-xml-input-specification-v1" id="id2">ATS Native XML Input Specification V1</a></li>
<li><a class="reference internal" href="#syntax-of-the-specification" id="id3">Syntax of the Specification</a></li>
<li><a class="reference internal" href="#symbol-index" id="id4">Symbol Index</a></li>
<li><a class="reference internal" href="#main" id="id5">Main</a></li>
<li><a class="reference internal" href="#mesh" id="id6">Mesh</a><ul>
<li><a class="reference internal" href="#generatedmesh" id="id7">GeneratedMesh</a></li>
<li><a class="reference internal" href="#meshfromfile" id="id8">MeshFromFile</a></li>
<li><a class="reference internal" href="#logicalmesh" id="id9">LogicalMesh</a></li>
<li><a class="reference internal" href="#surfacemesh" id="id10">SurfaceMesh</a></li>
<li><a class="reference internal" href="#columnmeshes" id="id11">ColumnMeshes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#region" id="id12">Region</a><ul>
<li><a class="reference internal" href="#point" id="id13">Point</a></li>
<li><a class="reference internal" href="#box" id="id14">Box</a></li>
<li><a class="reference internal" href="#plane" id="id15">Plane</a></li>
<li><a class="reference internal" href="#labeled-set" id="id16">Labeled Set</a></li>
<li><a class="reference internal" href="#color-function" id="id17">Color Function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#coordinator" id="id18">Coordinator</a></li>
<li><a class="reference internal" href="#visualization" id="id19">Visualization</a></li>
<li><a class="reference internal" href="#checkpoint" id="id20">Checkpoint</a></li>
<li><a class="reference internal" href="#observation" id="id21">Observation</a></li>
<li><a class="reference internal" href="#pk" id="id22">PK</a><ul>
<li><a class="reference internal" href="#base-pks" id="id23">Base PKs</a><ul>
<li><a class="reference internal" href="#pkphysicalbase" id="id24">PKPhysicalBase</a></li>
<li><a class="reference internal" href="#pkbdfbase" id="id25">PKBDFBase</a></li>
<li><a class="reference internal" href="#pkphysicalbdfbase" id="id26">PKPhysicalBDFBase</a></li>
</ul>
</li>
<li><a class="reference internal" href="#physical-pks" id="id27">Physical PKs</a><ul>
<li><a class="reference internal" href="#flow-pks" id="id28">Flow PKs</a><ul>
<li><a class="reference internal" href="#richards-pk" id="id29">Richards PK</a></li>
<li><a class="reference internal" href="#permafrost-flow-pk" id="id30">Permafrost Flow PK</a></li>
<li><a class="reference internal" href="#overland-flow-head-primary-variable-pk" id="id31">Overland Flow, head primary variable PK</a></li>
<li><a class="reference internal" href="#overland-flow-pressure-primary-variable-pk" id="id32">Overland Flow, pressure primary variable, PK</a></li>
<li><a class="reference internal" href="#snow-distribution-pk" id="id33">Snow Distribution PK</a></li>
</ul>
</li>
<li><a class="reference internal" href="#energy-pks" id="id34">Energy PKs</a><ul>
<li><a class="reference internal" href="#advection-diffusion-pk" id="id35">Advection Diffusion PK</a></li>
<li><a class="reference internal" href="#energy-base-pk" id="id36">Energy Base PK</a></li>
<li><a class="reference internal" href="#two-phase-subsurface-energy-pk" id="id37">Two-Phase subsurface Energy PK</a></li>
<li><a class="reference internal" href="#three-phase-subsurface-energy-pk" id="id38">Three-Phase subsurface Energy PK</a></li>
<li><a class="reference internal" href="#id1" id="id39">Three-Phase subsurface Energy PK</a></li>
<li><a class="reference internal" href="#surface-ice-energy-pk" id="id40">Surface Ice Energy PK</a></li>
</ul>
</li>
<li><a class="reference internal" href="#surface-energy-balance-pks" id="id41">Surface Energy Balance PKs</a><ul>
<li><a class="reference internal" href="#surface-energy-balance-snow-monolithic-version" id="id42">Surface Energy Balance / Snow -- Monolithic Version</a></li>
<li><a class="reference internal" href="#surface-energy-balance-generic-version" id="id43">Surface Energy Balance -- Generic Version</a></li>
</ul>
</li>
<li><a class="reference internal" href="#biogeochemistry" id="id44">Biogeochemistry</a><ul>
<li><a class="reference internal" href="#biogeochemistry-monolithic-version" id="id45">Biogeochemistry -- Monolithic Version</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deformation" id="id46">Deformation</a><ul>
<li><a class="reference internal" href="#volumetric-deformation" id="id47">Volumetric Deformation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mpcs" id="id48">MPCs</a><ul>
<li><a class="reference internal" href="#weakmpc" id="id49">WeakMPC</a></li>
<li><a class="reference internal" href="#strongmpc" id="id50">StrongMPC</a></li>
</ul>
</li>
<li><a class="reference internal" href="#physical-mpcs" id="id51">Physical MPCs</a><ul>
<li><a class="reference internal" href="#coupled-water-mpc" id="id52">Coupled Water MPC</a></li>
<li><a class="reference internal" href="#subsurface-mpc" id="id53">Subsurface MPC</a></li>
<li><a class="reference internal" href="#permafrost-mpc" id="id54">Permafrost MPC</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#state" id="id55">State</a><ul>
<li><a class="reference internal" href="#field-evaluators" id="id56">Field Evaluators</a><ul>
<li><a class="reference internal" href="#field-evaluator-base-classes" id="id57">Field Evaluator Base Classes</a><ul>
<li><a class="reference internal" href="#primaryvariableevaluator" id="id58">PrimaryVariableEvaluator</a></li>
<li><a class="reference internal" href="#secondaryvariableevaluator" id="id59">SecondaryVariableEvaluator</a></li>
<li><a class="reference internal" href="#secondaryvariablesevaluator" id="id60">SecondaryVariablesEvaluator</a></li>
<li><a class="reference internal" href="#independentvariableevaluator" id="id61">IndependentVariableEvaluator</a></li>
</ul>
</li>
<li><a class="reference internal" href="#water-content" id="id62">Water Content</a><ul>
<li><a class="reference internal" href="#richardswatercontentevaluator" id="id63">RichardsWaterContentEvaluator</a></li>
<li><a class="reference internal" href="#richardswatercontentwithvaporevaluator" id="id64">RichardsWaterContentWithVaporEvaluator</a></li>
<li><a class="reference internal" href="#permafrostwatercontentevaluator" id="id65">PermafrostWaterContentEvaluator</a></li>
</ul>
</li>
<li><a class="reference internal" href="#surface-water-potential-surfaces" id="id66">Surface Water potential surfaces</a><ul>
<li><a class="reference internal" href="#surfaceelevation" id="id67">SurfaceElevation</a></li>
<li><a class="reference internal" href="#surfacepotential" id="id68">SurfacePotential</a></li>
<li><a class="reference internal" href="#snowsurfacepotential" id="id69">SnowSurfacePotential</a></li>
</ul>
</li>
<li><a class="reference internal" href="#generic-evaluators" id="id70">Generic Evaluators</a><ul>
<li><a class="reference internal" href="#additiveevaluator" id="id71">AdditiveEvaluator</a></li>
<li><a class="reference internal" href="#multiplicativeevaluator" id="id72">MultiplicativeEvaluator</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#initialconditions" id="id73">InitialConditions</a><ul>
<li><a class="reference internal" href="#initialization-of-constant-scalars" id="id74">Initialization of constant scalars</a></li>
<li><a class="reference internal" href="#initialization-of-constant-vectors" id="id75">Initialization of constant vectors</a></li>
<li><a class="reference internal" href="#initialization-of-scalar-fields" id="id76">Initialization of scalar fields</a></li>
<li><a class="reference internal" href="#initialization-of-tensor-fields" id="id77">Initialization of tensor fields</a></li>
<li><a class="reference internal" href="#initialization-from-a-file" id="id78">Initialization from a file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#boundaryconditions" id="id79">BoundaryConditions</a><ul>
<li><a class="reference internal" href="#flow-specific-boundary-conditions" id="id80">Flow-specific Boundary Conditions</a><ul>
<li><a class="reference internal" href="#dirichlet-pressure-boundary-conditions" id="id81">Dirichlet (pressure) boundary conditions</a></li>
<li><a class="reference internal" href="#neumann-mass-flux-boundary-conditions" id="id82">Neumann (mass flux) boundary conditions</a></li>
<li><a class="reference internal" href="#seepage-face-boundary-conditions" id="id83">Seepage face boundary conditions</a></li>
<li><a class="reference internal" href="#dirichlet-head-boundary-conditions" id="id84">Dirichlet (head) boundary conditions</a></li>
<li><a class="reference internal" href="#fixed-level-boundary-conditions" id="id85">Fixed level boundary conditions</a></li>
<li><a class="reference internal" href="#zero-head-gradient-boundary-conditions" id="id86">Zero head gradient boundary conditions</a></li>
<li><a class="reference internal" href="#critical-depth-boundary-conditions" id="id87">Critical depth boundary conditions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#time-integrators-solvers-and-other-mathematical-specs" id="id88">Time integrators, solvers, and other mathematical specs</a><ul>
<li><a class="reference internal" href="#timeintegrator" id="id89">TimeIntegrator</a></li>
<li><a class="reference internal" href="#linear-solver-spec" id="id90">Linear Solver Spec</a></li>
<li><a class="reference internal" href="#preconditioner" id="id91">Preconditioner</a><ul>
<li><a class="reference internal" href="#hypre-s-boomer-amg" id="id92">Hypre's Boomer AMG</a></li>
<li><a class="reference internal" href="#trilinos-ml" id="id93">Trilinos ML</a></li>
<li><a class="reference internal" href="#block-ilu" id="id94">Block ILU</a></li>
<li><a class="reference internal" href="#indentity" id="id95">Indentity</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nonlinearsolver" id="id96">NonlinearSolver</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-common-specs" id="id97">Other Common Specs</a><ul>
<li><a class="reference internal" href="#ioevent" id="id98">IOEvent</a></li>
<li><a class="reference internal" href="#verboseobject" id="id99">VerboseObject</a></li>
<li><a class="reference internal" href="#function" id="id100">Function</a><ul>
<li><a class="reference internal" href="#constant-function" id="id101">Constant Function</a></li>
<li><a class="reference internal" href="#tabular-function" id="id102">Tabular Function</a></li>
<li><a class="reference internal" href="#smooth-step-function" id="id103">Smooth step Function</a></li>
<li><a class="reference internal" href="#polynomial-function" id="id104">Polynomial Function</a></li>
<li><a class="reference internal" href="#multi-variable-linear-function" id="id105">Multi-variable linear Function</a></li>
<li><a class="reference internal" href="#separable-function" id="id106">Separable Function</a></li>
<li><a class="reference internal" href="#additive-function" id="id107">Additive Function</a></li>
<li><a class="reference internal" href="#multiplicative-function" id="id108">Multiplicative Function</a></li>
<li><a class="reference internal" href="#composition-function" id="id109">Composition Function</a></li>
<li><a class="reference internal" href="#piecewise-bilinear-function" id="id110">Piecewise Bilinear Function</a></li>
<li><a class="reference internal" href="#distance-function" id="id111">Distance Function</a></li>
<li><a class="reference internal" href="#monomial-function" id="id112">Monomial Function</a></li>
<li><a class="reference internal" href="#standard-math-function" id="id113">Standard Math Function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operator" id="id114">Operator</a><ul>
<li><a class="reference internal" href="#operatoraccumulation" id="id115">OperatorAccumulation</a></li>
<li><a class="reference internal" href="#operatordiffusion" id="id116">OperatorDiffusion</a></li>
<li><a class="reference internal" href="#operatoradvection" id="id117">OperatorAdvection</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="syntax-of-the-specification">
<h1><a class="toc-backref" href="#id3">Syntax of the Specification</a></h1>
<ul class="simple">
<li>Input specification for each ParameterList entry consists of two parts.
First, a bulleted list defines the usage syntax and available options.
This is followed by example snipets of XML code to demonstrate usage.</li>
<li>In many cases, the input specifies data for a particular parameterized model, and ATS
supports a number of parameterizations.
For example, initial data might be uniform (the value is required), or linear in y (the value
and its gradient are required).
Where ATS supports a number of parameterized models for quantity Z, the available
models will be listed by name, and then will be described in the subsequent section.
For example, the specification for an <cite>&quot;X</cite>&quot; list might begin with the following:<ul>
<li><cite>&quot;Y</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;default_value&quot;</strong>, <cite>&quot;other</cite>&quot;, <cite>&quot;valid</cite>&quot;, <cite>&quot;options</cite>&quot;</li>
<li>Z <tt class="docutils literal"><span class="pre">[Z-spec]</span></tt> Model for Z, choose exactly one of the following: (1) <cite>&quot;z1</cite>&quot;, or (2) <cite>&quot;z2</cite>&quot; (see below)</li>
</ul>
</li>
</ul>
<p>Here, an <cite>&quot;X</cite>&quot; is defined by a <cite>&quot;Y</cite>&quot; and a <cite>&quot;Z</cite>&quot;.
The <cite>&quot;Y</cite>&quot; is a string parameter but the <cite>&quot;Z</cite>&quot; is given by a model (which will require its own set of parameters).
The options for <cite>&quot;Z</cite>&quot; will then be described as a spec:</p>
<blockquote>
<ul class="simple">
<li><cite>&quot;z1</cite>&quot; applies model z1.  Requires <cite>&quot;z1a</cite>&quot; <tt class="docutils literal">[string]</tt></li>
<li><cite>&quot;z2</cite>&quot; applies model z2.  Requires <cite>&quot;z2a</cite>&quot; <tt class="docutils literal">[double]</tt> and <cite>&quot;z2b</cite>&quot; <tt class="docutils literal">[int]</tt></li>
</ul>
</blockquote>
<p>An example of using such a specification:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;X&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;Y&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;hello&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;z2&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;z2a&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.7&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;z2b&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
<p>Here, the user is defining X with Y=&quot;hello&quot;, and Z will be a z2 constructed with z2a=0.7 and z2b=3.</p>
<p>Conventions:</p>
<ul class="simple">
<li>Reserved keywords and labels are <cite>&quot;quoted and italicized</cite>&quot; -- these
labels or values of parameters in user-generated input files must
match (using XML matching rules) the specified or allowable values.</li>
<li>User-defined labels are indicated with ALL-CAPS, and are meant to
represent a typical name given by a user - these can be names or
numbers or whatever serves best the organization of the user input
data.</li>
<li>Bold values are default values, and are used if the Parameter
is not provided.</li>
</ul>
</div>
<div class="section" id="symbol-index">
<h1><a class="toc-backref" href="#id4">Symbol Index</a></h1>
<p><span class="formula">|<i>E</i>|</span> | volume of a cell <span class="formula">[<i>m</i><sup><i>X</i></sup>]</span> (where <span class="formula"><i>X</i></span> is the dimension of the mesh)
<span class="formula"><i>g</i></span> | gravitational acceleration vector <span class="formula">[<i>m</i><i>s</i><sup> − </sup>2]</span>
<span class="formula"><i>h</i></span> | ponded depth, or the water head over the surface <span class="formula">[<i>m</i>]</span>
:math:`` | alternative, in context of the subsurface, water head <span class="formula">[<i>m</i>]</span>
<span class="formula"><i>h</i><sub><i>snow</i></sub></span> | snow depth <span class="formula">[<i>m</i>]</span>
<span class="formula"><i>K</i></span> | absolute permeability <span class="formula">[<i>m</i><sup>2</sup>]</span>
<span class="formula"><i>k</i><sub><i>r</i></sub></span> | relative permeability <span class="formula">[ − ]</span>
<span class="formula"><i>n</i><sub><i>X</i></sub></span> | molar density of phase X <span class="formula">[<i>mol</i><i>m</i><sup> − </sup>3]</span>
<span class="formula"><i>p</i></span> | pressure of the liquid phase <span class="formula">[<i>Pa</i>]</span>
<span class="formula"><i>P</i><sub><i>s</i>, <i>r</i></sub></span> | precipitation of rain or snow, noting that snow is always a precipitation rate in snow-water-equivalent (SWE) basis.  <span class="formula">[<i>m</i><i>s</i><sup> − </sup>1]</span>
<span class="formula"><i>Q</i><sub><i>w</i></sub></span> | mass source of water <span class="formula">[<i>mol</i><i>s</i><sup> − </sup>1]</span>
<span class="formula"><i>s</i><sub><i>X</i></sub></span> | saturation of phase X <span class="formula">[ − ]</span>
<span class="formula"><i>t</i></span> | time variable <span class="formula">[<i>s</i>]</span>
<span class="formula"><i>z</i></span> | elevation <span class="formula">[<i>m</i>]</span>
<span class="formula"><i>ν</i></span> | dynamic viscosity of water <span class="formula">[<i>Pa</i><i>s</i>]</span>
<span class="formula"><i>φ</i></span> | porosity of the soil <span class="formula">[ − ]</span>
<span class="formula"><i>ρ</i></span> | mass density of a phase <span class="formula">[<i>kg</i><i>m</i><sup> − </sup>3]</span>
<span class="formula">Θ</span> | extensive water content of a cell <span class="formula">[<i>mol</i>]</span></p>
</div>
<div class="section" id="main">
<h1><a class="toc-backref" href="#id5">Main</a></h1>
<p>The <cite>&quot;main</cite>&quot; ParameterList frames the entire input spec, and must contain
one sublist for each of the following sections.</p>
<ul>
<li><p class="first"><cite>&quot;mesh</cite>&quot; <tt class="docutils literal"><span class="pre">[mesh-spec]</span></tt>  See the <a class="reference internal" href="#mesh">Mesh</a> spec.</p>
</li>
<li><p class="first"><cite>&quot;regions</cite>&quot; <tt class="docutils literal">[list]</tt></p>
<p>List of multiple <a class="reference internal" href="#region">Region</a> specs, each in its own sublist named uniquely by the user.</p>
</li>
<li><p class="first"><cite>&quot;coordinator</cite>&quot; <tt class="docutils literal"><span class="pre">[coordinator-spec]</span></tt>  See the <a class="reference internal" href="#coordinator">Coordinator</a> spec.</p>
</li>
<li><p class="first"><cite>&quot;visualization</cite>&quot; <tt class="docutils literal"><span class="pre">[visualization-spec]</span></tt> A <a class="reference internal" href="#visualization">Visualization</a> spec for the main mesh/domain.</p>
</li>
<li><p class="first"><cite>&quot;visualization XX</cite>&quot; <tt class="docutils literal"><span class="pre">[visualization-spec]</span></tt></p>
<p>Potentially more than one other <a class="reference internal" href="#visualization">Visualization</a> specs, one for each domain <cite>&quot;XX</cite>&quot;.  e.g. <cite>&quot;surface</cite>&quot;</p>
</li>
<li><p class="first"><cite>&quot;checkpoint</cite>&quot; <tt class="docutils literal"><span class="pre">[checkpoint-spec]</span></tt> A <a class="reference internal" href="#checkpoint">Checkpoint</a> spec.</p>
</li>
<li><p class="first"><cite>&quot;observations</cite>&quot; <tt class="docutils literal"><span class="pre">[observation-spec]</span></tt> An <a class="reference internal" href="#observation">Observation</a> spec.</p>
</li>
<li><p class="first"><cite>&quot;PKs</cite>&quot; <tt class="docutils literal">[list]</tt></p>
<p>A list containing exactly one sublist, a <a class="reference internal" href="#pk">PK</a> spec with the top level PK.</p>
</li>
<li><p class="first"><cite>&quot;state</cite>&quot; <tt class="docutils literal">[list]</tt> A <a class="reference internal" href="#state">State</a> spec.</p>
</li>
</ul>
</div>
<div class="section" id="mesh">
<h1><a class="toc-backref" href="#id6">Mesh</a></h1>
<blockquote>
Simple wrapper that takes a ParameterList and generates all needed meshes.</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 123)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>All processes are simulated on a domain, which is discretized through a mesh.</p>
<p>Multiple domains and therefore meshes can be used in a single simulation, and multiple meshes can be constructed on the fly.</p>
<p>The base mesh represents the primary domain of simulation.  Simple, structured
meshes may be generated on the fly, or complex unstructured meshes are
provided as <tt class="docutils literal">Exodus II</tt> files.  The base <em>mesh</em> list includes either a
<a class="reference internal" href="#generatedmesh">GeneratedMesh</a>,  <a class="reference internal" href="#meshfromfile">MeshFromFile</a>, or <a class="reference internal" href="#logicalmesh">LogicalMesh</a> spec, as described below.</p>
<p>Additionally, a <a class="reference internal" href="#surfacemesh">SurfaceMesh</a> may be formed by lifting the surface of a
provided mesh and then flattening that mesh to a 2D surface.  <a class="reference internal" href="#columnmeshes">ColumnMeshes</a>
which split a base mesh into vertical columns of cells for use in 1D models
may also be generated automatically.</p>
<p>Finally, mesh generation is hard and error-prone.  A mesh audit is provided,
which checks for many common geometric and topologic errors in mesh
generation.  This is reasonably fast, even for big meshes, and can be done through providing a &quot;verify mesh&quot; option.</p>
<ul class="simple">
<li><cite>&quot;verify mesh</cite>&quot; <tt class="docutils literal">[bool]</tt> <strong>false</strong> Perform a mesh audit.</li>
<li><cite>&quot;deformable mesh</cite>&quot; <tt class="docutils literal">[bool]</tt> <strong>false</strong> Will this mesh be deformed?</li>
</ul>
<div class="section" id="generatedmesh">
<h2><a class="toc-backref" href="#id7">GeneratedMesh</a></h2>
<p>Generated mesh are by definition structured, with uniform dx, dy, and dz.
Such a mesh is specified by a bounding box high and low coordinate, and a list
of number of cells in each direction.</p>
<ul class="simple">
<li><cite>&quot;generate mesh</cite>&quot; <tt class="docutils literal">[list]</tt><ul>
<li><cite>&quot;domain low coordinate</cite>&quot; <tt class="docutils literal">[Array(double)]</tt> Location of low corner of domain</li>
<li><cite>&quot;domain high coordinate</cite>&quot; <tt class="docutils literal">[Array(double)]</tt> Location of high corner of domain</li>
<li><cite>&quot;number of cells</cite>&quot; <tt class="docutils literal">[Array(int)]</tt> the number of uniform cells in each coordinate direction</li>
</ul>
</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;mesh&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;generate mesh&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;number of cells&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{100, 1, 100}}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;domain low coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{0.0, 0.0, 0.0}}&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;domain high coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{100.0, 1.0, 10.0}}&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="meshfromfile">
<h2><a class="toc-backref" href="#id8">MeshFromFile</a></h2>
<p>Meshes can be pre-generated in a multitude of ways, then written to &quot;Exodus
II&quot; file format, and loaded in ATS.</p>
<ul class="simple">
<li><cite>&quot;read mesh file</cite>&quot; <tt class="docutils literal">[list]</tt> accepts name, format of pre-generated mesh file<ul>
<li><dl class="first docutils">
<dt><cite>&quot;file</cite>&quot; <tt class="docutils literal">[string]</tt> name of pre-generated mesh file. Note that in the case of an</dt>
<dd>Exodus II mesh file, the suffix of the serial mesh file must be .exo and
the suffix of the parallel mesh file must be .par.
When running in serial the code will read this the indicated file directly.
When running in parallel and the suffix is .par, the code will instead read
the partitioned files, that have been generated with a Nemesis tool and
named as filename.par.N.r where N is the number of processors and r is the rank.
When running in parallel and the suffix is .exo, the code will partition automatically
the serial file.</dd>
</dl>
</li>
<li><cite>&quot;format</cite>&quot; <tt class="docutils literal">[string]</tt> format of pre-generated mesh file (<cite>&quot;MSTK</cite>&quot; or <cite>&quot;Exodus II</cite>&quot;)</li>
</ul>
</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;mesh&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;read mesh file&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;mesh_filename.exo&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;format&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Exodus II&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;verify mesh&quot;</span> <span class="na">type=</span><span class="s">&quot;bool&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="logicalmesh">
<h2><a class="toc-backref" href="#id9">LogicalMesh</a></h2>
<p>** Document me! **</p>
</div>
<div class="section" id="surfacemesh">
<h2><a class="toc-backref" href="#id10">SurfaceMesh</a></h2>
<p>To lift a surface off of the mesh, a side-set specifying all surface faces
must be given.  These faces are lifted locally, so the partitioning of the
surface cells will be identical to the partitioning of the subsurface faces
that correspond to these cells.  All communication and ghost cells are set up.
The mesh is flattened, so all surface faces must have non-zero area when
projected in the z-direction.  No checks for holes are performed.  Surface
meshes may similarly be audited to make sure they are reasonable for
computation.</p>
<ul class="simple">
<li><cite>&quot;surface sideset name</cite>&quot; <tt class="docutils literal">[string]</tt> The <a class="reference internal" href="#region">Region</a> name containing all surface faces.</li>
<li><cite>&quot;verify mesh</cite>&quot; <tt class="docutils literal">[bool]</tt> <strong>false</strong> Verify validity of surface mesh.</li>
<li><cite>&quot;export mesh to file</cite>&quot; <tt class="docutils literal">[string]</tt> Export the lifted surface mesh to this filename.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;mesh&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;read mesh file&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;mesh_filename.exo&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;format&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Exodus II&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;verify mesh&quot;</span> <span class="na">type=</span><span class="s">&quot;bool&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;surface mesh&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span>  <span class="na">name=</span><span class="s">&quot;surface sideset name&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;surface_region&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;verify mesh&quot;</span> <span class="na">type=</span><span class="s">&quot;bool&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;export mesh to file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;surface_mesh.exo&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="columnmeshes">
<h2><a class="toc-backref" href="#id11">ColumnMeshes</a></h2>
<p>** Document me! **</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;mesh&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;read mesh file&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;mesh_filename.exo&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;format&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Exodus II&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;column meshes&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="region">
<h1><a class="toc-backref" href="#id12">Region</a></h1>
<blockquote>
Region: a geometric or discrete subdomain (abstract)</blockquote>
<p>Regions are geometrical constructs used in Amanzi to define subsets of
the computational domain in order to specify the problem to be solved, and the
output desired. Regions may represents zero-, one-, two- or three-dimensional
subsets of physical space.  for a three-dimensional problem, the simulation
domain will be a three-dimensional region bounded by a set of two-dimensional
regions.  If the simulation domain is N-dimensional, the boundary conditions
must be specified over a set of regions are (N-1)-dimensional.</p>
<p>Amanzi automatically defines the special region labeled <em>All</em>, which is the
entire simulation domain. Currently, the unstructured framework does
not support the <em>All</em> region, but it is expected to do so in the
near future.</p>
<blockquote>
<ul class="simple">
<li><cite>&quot;regions</cite>&quot; <tt class="docutils literal">[list]</tt> can accept a number of uniquely named lists for regions<ul>
<li><tt class="docutils literal"><span class="pre">[region-spec]</span></tt> Geometric model primitive, as described below.</li>
</ul>
</li>
</ul>
</blockquote>
<p>Amanzi supports parameterized forms for a number of analytic shapes, as well
as more complex definitions based on triangulated surface files.</p>
<p><strong>Notes:</strong></p>
<ul>
<li><p class="first">Surface files contain labeled triangulated face sets.  The user is
responsible for ensuring that the intersections with other surfaces
in the problem, including the boundaries, are <em>exact</em> (<em>i.e.</em> that
surface intersections are <em>watertight</em> where applicable), and that
the surfaces are contained within the computational domain.  If
nodes in the surface fall outside the domain, the elements they
define are ignored.</p>
<p>Examples of surface files are given in the <em>Exodus II</em> file
format here.</p>
</li>
<li><p class="first">Region names must NOT be repeated.</p>
</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span>  <span class="c">&lt;!-- parent list --&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;TOP SECTION&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{2, 3, 5}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{4, 5, 8}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;MIDDLE SECTION&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{2, 3, 3}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{4, 5, 5}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BOTTOM SECTION&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{2, 3, 0}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{4, 5, 3}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;INFLOW SURFACE&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: labeled set&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;label&quot;</span>  <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;sideset_2&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span>   <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;F_area_mesh.exo&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;format&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Exodus II&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;entity&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;face&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;OUTFLOW PLANE&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: plane&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;point&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.5, 0.5, 0.5}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;normal&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0, 0, 1}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BLOODY SAND&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: color function&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;F_area_col.txt&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;25&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;FLUX PLANE&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: polygon&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;number of points&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;points&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{-0.5, -0.5, -0.5,</span>
<span class="s">                                                               0.5, -0.5, -0.5,</span>
<span class="s">                                                               0.8, 0.0, 0.0,</span>
<span class="s">                                                               0.5,  0.5, 0.5,</span>
<span class="s">                                                              -0.5, 0.5, 0.5}&quot;</span><span class="nt">/&gt;</span>
       <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
<p>In this example, <em>TOP SESCTION</em>, <em>MIDDLE SECTION</em> and <em>BOTTOM SECTION</em>
are three box-shaped volumetric regions. <em>INFLOW SURFACE</em> is a
surface region defined in an Exodus II-formatted labeled set
file and <em>OUTFLOW PLANE</em> is a planar region. <em>BLOODY SAND</em> is a volumetric
region defined by the value 25 in color function file.</p>
<div class="section" id="point">
<h2><a class="toc-backref" href="#id13">Point</a></h2>
<blockquote>
RegionPoint: a point in space.</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 377)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>List <em>region: point</em> defines a point in space.
This region consists of cells containing this point.</p>
<ul class="simple">
<li><cite>&quot;coordinate</cite>&quot; <tt class="docutils literal">[Array(double)]</tt> Location of point in space.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;DOWN_WIND150&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- parent list defining the name --&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: point&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{-150.0, 0.0, 0.0}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="box">
<h2><a class="toc-backref" href="#id14">Box</a></h2>
<blockquote>
RegionBox: a rectangular region in space, defined by two points</blockquote>
<p>List <em>region: box</em> defines a region bounded by coordinate-aligned
planes. Boxes are allowed to be of zero thickness in only one
direction in which case they are equivalent to planes.</p>
<ul class="simple">
<li><cite>&quot;low coordinate</cite>&quot; <tt class="docutils literal">[Array(double)]</tt> Location of the boundary point with the lowest coordinates.</li>
<li><cite>&quot;high coordinate</cite>&quot; <tt class="docutils literal">[Array(double)]</tt> Location of the boundary points with the highest coordinates.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;WELL&quot;</span><span class="nt">&gt;</span>  <span class="c">&lt;!-- parent list --&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: box&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;low coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{-5.0,-5.0, -5.0}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;high coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{5.0, 5.0,  5.0}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="plane">
<h2><a class="toc-backref" href="#id15">Plane</a></h2>
<blockquote>
RegionPlane: A planar (infinite) region in space, defined by a point and a normal.</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 424)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>List <em>region: plane</em> defines a plane using a point lying on the plane and normal to the plane.</p>
<ul class="simple">
<li><cite>&quot;normal</cite>&quot; <tt class="docutils literal">[Array(double)]</tt> Normal to the plane.</li>
<li><cite>&quot;point</cite>&quot; <tt class="docutils literal">[Array(double)]</tt> Point in space.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;TOP_SECTION&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- parent list --&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: plane&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;point&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{2, 3, 5}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;normal&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{1, 1, 0}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;expert parameters&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;tolerance&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0e-05&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="labeled-set">
<h2><a class="toc-backref" href="#id16">Labeled Set</a></h2>
<blockquote>
RegionLabeledSet: A region defined by a set of mesh entities in a mesh file</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 450)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>The list <em>region: labeled set</em> defines a named set of mesh entities
existing in an input mesh file. This is the same file that contains
the computational mesh. The name of the entity set is given
by <em>label</em>.  For example, a mesh file in the Exodus II
format can be processed to tag cells, faces and/or nodes with
specific labels, using a variety of external tools. Regions based
on such sets are assigned a user-defined label for Amanzi, which may
or may not correspond to the original label in the exodus file.
Note that the file used to express this labeled set may be in any
Amanzi-supported mesh format (the mesh format is specified in the
parameters for this option).  The <em>entity</em> parameter may be
necessary to specify a unique set.  For example, an Exodus file
requires <em>cell</em>, <em>face</em> or <em>node</em> as well as a label (which is
an integer).  The resulting region will have the dimensionality
associated with the entities in the indicated set.</p>
<ul class="simple">
<li><cite>&quot;label</cite>&quot; <tt class="docutils literal">[string]</tt> Set per label defined in the mesh file.</li>
<li><cite>&quot;file</cite>&quot; <tt class="docutils literal">[string]</tt> File name.</li>
<li><cite>&quot;format</cite>&quot; <tt class="docutils literal">[string]</tt> Currently, we only support mesh files in the &quot;Exodus II&quot; format.</li>
<li><cite>&quot;entity</cite>&quot; <tt class="docutils literal">[string]</tt> Type of the mesh object (cell, face, etc).</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;AQUIFER&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: labeled set&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;entity&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;porflow4_4.exo&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;format&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Exodus II&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;label&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="color-function">
<h2><a class="toc-backref" href="#id17">Color Function</a></h2>
<blockquote>
RegionColorFunction: A region defined by the value of an indicator function in a file.</blockquote>
<p>The list <em>region: color function</em> defines a region based a specified
integer color, <em>value</em>, in a structured color function file,
<em>file</em>. The format of the color function file is given below in
the &quot;Tabulated function file format&quot; section. As
shown in the file, the color values may be specified at the nodes or
cells of the color function grid. A computational cell is assigned
the 'color' of the data grid cell containing its cell centroid
(cell-based colors) or the data grid nearest its cell-centroid
(node-based colors). Computational cells sets are then built from
all cells with the specified color <em>Value</em>.</p>
<p>In order to avoid, gaps and overlaps in specifying materials, it is
strongly recommended that regions be defined using a single color
function file.</p>
<ul class="simple">
<li><cite>&quot;file</cite>&quot; <tt class="docutils literal">[string]</tt> File name.</li>
<li><cite>&quot;value</cite>&quot; <tt class="docutils literal">[int]</tt> Color that defines the set in a tabulated function file.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;SOIL_TOP&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;region: color function&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;geology_resamp_2D.tf3&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="coordinator">
<h1><a class="toc-backref" href="#id18">Coordinator</a></h1>
<blockquote>
Coordinator: Simulation controller and top-level driver</blockquote>
<p>In the <cite>&quot;coordinator</cite>&quot; sublist, the user specifies global control of
the simulation, including starting and ending times and restart options.</p>
<ul>
<li><p class="first"><cite>&quot;start time</cite>&quot; <tt class="docutils literal">[double]</tt>, <strong>0.</strong> Specifies the start of time in model time.</p>
</li>
<li><p class="first"><cite>&quot;start time units</cite>&quot; <tt class="docutils literal">[string]</tt>, <strong>&quot;s&quot;</strong>, <cite>&quot;d</cite>&quot;, <cite>&quot;yr</cite>&quot;</p>
</li>
<li><p class="first"><cite>&quot;end time</cite>&quot; <tt class="docutils literal">[double]</tt> Specifies the end of the simulation in model time.</p>
</li>
<li><p class="first"><cite>&quot;end time units</cite>&quot; <tt class="docutils literal">[string]</tt>, <strong>&quot;s&quot;</strong>, <cite>&quot;d</cite>&quot;, <cite>&quot;yr</cite>&quot;</p>
</li>
<li><p class="first"><cite>&quot;end cycle</cite>&quot; <tt class="docutils literal">[int]</tt> If provided, specifies the end of the simulation in timestep cycles.</p>
</li>
<li><p class="first"><cite>&quot;restart from checkpoint file</cite>&quot; <tt class="docutils literal">[string]</tt> If provided, specifies a path to the checkpoint file to continue a stopped simulation.</p>
</li>
<li><p class="first"><cite>&quot;wallclock duration [hrs]</cite>&quot; <tt class="docutils literal">[double]</tt> After this time, the simulation will checkpoint and end.  Not required.</p>
</li>
<li><p class="first"><cite>&quot;required times</cite>&quot; <tt class="docutils literal"><span class="pre">[time-control-spec]</span></tt></p>
<p>A <a href="#id118"><span class="problematic" id="id119">TimeControl_</span></a> spec that sets a collection of times/cycles at which the simulation is guaranteed to hit exactly.  This is useful for situations such as where data is provided at a regular interval, and interpolation error related to that data is to be minimized.</p>
</li>
</ul>
<p>Note: Either <cite>&quot;end cycle</cite>&quot; or <cite>&quot;end time</cite>&quot; are required, and if
both are present, the simulation will stop with whichever arrives
first.  An <cite>&quot;end cycle</cite>&quot; is commonly used to ensure that, in the case
of a time step crash, we do not continue on forever spewing output.</p>
<p>Example:</p>
<!-- code-block::xml

<!- - simulation control - ->
<ParameterList name="coordinator">
  <Parameter  name="end cycle" type="int" value="6000"/>
  <Parameter  name="start time" type="double" value="0."/>
  <Parameter  name="start time units" type="string" value="s"/>
  <Parameter  name="end time" type="double" value="1"/>
  <Parameter  name="end time units" type="string" value="yr"/>
  <ParameterList name="required times">
    <Parameter name="start period stop" type="Array(double)" value="{0,-1,86400}" />
  </ParameterList>
</ParameterList> -->
</div>
<div class="section" id="visualization">
<h1><a class="toc-backref" href="#id19">Visualization</a></h1>
<p>A user may request periodic writes of field data for the purposes of
visualization in the <cite>&quot;visualization</cite>&quot; sublists.  ATS accepts a visualization
list for each domain/mesh, including surface and column meshes.  These are in
separate ParameterLists, entitled <cite>&quot;visualization</cite>&quot; for the main mesh, and
<cite>&quot;visualization surface</cite>&quot; on the surface mesh.  It is expected that, for any
addition meshes, each will have a domain name and therefore admit a spec of
the form: <cite>&quot;visualization DOMAIN-NAME</cite>&quot;.</p>
<blockquote>
Visualization: a class for controlling simulation output.</blockquote>
<p>Each list contains all parameters as in a <a class="reference internal" href="#ioevent">IOEvent</a> spec, and also:</p>
<ul>
<li><p class="first"><cite>&quot;file name base</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;visdump_data&quot;</strong>, <strong>&quot;visdump_surface_data&quot;</strong></p>
</li>
<li><p class="first"><cite>&quot;dynamic mesh</cite>&quot; <tt class="docutils literal">[bool]</tt> <strong>false</strong></p>
<p>Write mesh data for every visualization dump, this facilitates visualizing deforming meshes.</p>
</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;visualization&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file name base&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;visdump_data&quot;</span><span class="nt">/&gt;</span>

  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;cycles start period stop&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{0, 100, -1}}&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;cycles&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{999, 1001}}&quot;</span> <span class="nt">/&gt;</span>

  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times start period stop 0&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{0.0, 10.0, 100.0}}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times start period stop 1&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{100.0, 25.0, -1.0}}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{101.0, 303.0, 422.0}}&quot;</span><span class="nt">/&gt;</span>

  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;dynamic mesh&quot;</span> <span class="na">type=</span><span class="s">&quot;bool&quot;</span> <span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="checkpoint">
<h1><a class="toc-backref" href="#id20">Checkpoint</a></h1>
<p>A user may request periodic dumps of ATS Checkpoint Data in the
<cite>&quot;checkpoint</cite>&quot; sublist.  The user has no explicit control over the
content of these files, but has the guarantee that the ATS run will be
reproducible (with accuracies determined by machine round errors and
randomness due to execution in a parallel computing environment).
Therefore, output controls for Checkpoint Data are limited to file
name generation and writing frequency, by numerical cycle number.
Unlike <cite>&quot;visualization</cite>&quot;, there is only one <cite>&quot;checkpoint</cite>&quot; list for
all domains/meshes.</p>
<blockquote>
Visualization: a class for controlling simulation output.</blockquote>
<p>Each list contains all parameters as in a <a class="reference internal" href="#ioevent">IOEvent</a> spec, and also:</p>
<ul>
<li><p class="first"><cite>&quot;file name base</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;checkpoint&quot;</strong></p>
</li>
<li><p class="first"><cite>&quot;file name digits</cite>&quot; <tt class="docutils literal">[int]</tt> <strong>5</strong></p>
<p>Write mesh data for every visualization dump, this facilitates visualizing deforming meshes.</p>
</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;checkpoint&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;cycles start period stop&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{0, 100, -1}}&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;cycles&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{999, 1001}}&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times start period stop 0&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{0.0, 10.0, 100.0}}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times start period stop 1&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{100.0, 25.0, -1.0}}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{101.0, 303.0, 422.0}}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
<p>In this example, checkpoint files are written when the cycle number is
a multiple of 100, every 10 seconds for the first 100 seconds, and
every 25 seconds thereafter, along with times 101, 303, and 422.  Files will be written in the form: <cite>&quot;checkpoint00000.h5</cite>&quot;.</p>
</div>
<div class="section" id="observation">
<h1><a class="toc-backref" href="#id21">Observation</a></h1>
<blockquote>
Observable: Collects, reduces, and writes observations during a simulation.</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 670)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>Observations are a localized-in-space but frequent in time view of
data, designed to get at useful diagnostic quantities such as
hydrographs, total water content, quantities at a point, etc.  These
are designed to allow frequent collection in time without saving huge
numbers of visualization files to do postprocessing.  In fact, these
should be though of as orthogonal data queries to visualization -- vis
is pointwise in time but complete in space, while observations are
pointwise/finite in space but complete in time.</p>
<p>A user may request any number of specific observations from ATS.  Each
observation spec involves a field quantity, a functional reduction
operator, a region from which it will extract its source data, and a
list of discrete times for its evaluation.  The observations are
evaluated during the simulation and written to disk.</p>
<ul class="simple">
<li><cite>&quot;observations</cite>&quot; [list] can accept multiple <tt class="docutils literal"><span class="pre">[observation-spec]</span></tt> entries.</li>
</ul>
<p>An <tt class="docutils literal"><span class="pre">[observation-spec]</span></tt> consists of the following quantities:</p>
<ul class="simple">
<li><cite>&quot;observation output filename</cite>&quot; [string] user-defined name for the file that the observations are written to.</li>
<li><cite>&quot;variable</cite>&quot; [string] any ATS variable used by any PK, e.g. <cite>&quot;pressure</cite>&quot; or <cite>&quot;surface-water_content</cite>&quot;</li>
<li><cite>&quot;region</cite>&quot; [string] the label of a user-defined region</li>
<li><cite>&quot;location name</cite>&quot; [string] the mesh location of the thing to be measured, i.e. <cite>&quot;cell</cite>&quot;, <cite>&quot;face</cite>&quot;, or <cite>&quot;node</cite>&quot;</li>
<li><cite>&quot;functional</cite>&quot; [string] the label of a function to apply to the variable across the region.  Valid functionals include:</li>
</ul>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 698)</p>
Bullet list ends without a blank line; unexpected unindent.</div>
<blockquote>
<ul class="simple">
<li><cite>&quot;observation data: point</cite>&quot; returns the value of the field quantity at a point.  The region and location name must result in a single entity being selected.</li>
<li><cite>&quot;observation data: extensive integral</cite>&quot; returns the sum of an (extensive) variable over the region.  This should be used for extensive quantities such as <cite>&quot;water_content</cite>&quot; or <cite>&quot;energy</cite>&quot;.</li>
<li><cite>&quot;observation data: intensive integral</cite>&quot; returns the volume-weighted average of an (intensive) variable over the region.  This should be used for intensive quantities such as <cite>&quot;temperature</cite>&quot; or <cite>&quot;saturation_liquid</cite>&quot;.</li>
</ul>
</blockquote>
<ul class="simple">
<li>Additionally, each <tt class="docutils literal"><span class="pre">[observation-spec]</span></tt> contains all parameters as in a <a class="reference internal" href="#ioevent">IOEvent</a> spec, which are used to specify at which times/cycles the observation is collected.</li>
</ul>
<p>For flux observations, and additional option is available:</p>
<ul class="simple">
<li><cite>&quot;direction normalized flux</cite>&quot; [bool] <em>false</em> Normalize the flux to point in the outward-normal direction.  This is important when looking at fluxes across a boundary, for instance to plot a hydrograph.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;observations&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- This measures the hydrograph out the &quot;east&quot; face of the surface domain --&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;surface outlet flux&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;variable&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;surface-mass_flux&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;direction normalized flux&quot;</span> <span class="na">type=</span><span class="s">&quot;bool&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;region&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;east&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;functional&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;observation data: extensive integral&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;delimiter&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot; &quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;location name&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;face&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;observation output filename&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;surface_outlet_flux.dat&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times start period stop&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.0,86400.0,-1.0}&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="c">&lt;!-- This measures the total water, in mols, in the entire subsurface domain --&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;subsurface water content&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;variable&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;water_content&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;region&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;computational domain&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;functional&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;observation data: extensive integral&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;delimiter&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot; &quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;location name&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;cell&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;observation output filename&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;water_content.dat&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times start period stop&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.0,86400.0,-1.0}&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="c">&lt;!-- This tracks the temperature at a point --&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;temperature_probeA&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;variable&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;temperature&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;region&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;probeA&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;functional&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;observation data: point&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;delimiter&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot; &quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;location name&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;cell&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;observation output filename&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;temperature_probeA.dat&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;times start period stop&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.0,86400.0,-1.0}&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="pk">
<h1><a class="toc-backref" href="#id22">PK</a></h1>
<blockquote>
The interface for a Process Kernel, an equation or system of equations.</blockquote>
<p>A process kernel represents a single or system of partial/ordinary
differential equation(s) or conservation law(s), and is used as the
fundamental unit for coupling strategies.</p>
<p>Implementations of this interface typically are either an MPC
(multi-process coupler) whose job is to heirarchically couple several
other PKs and represent the system of equations, or a Physical PK,
which represents a single equation.</p>
<p>All PKs have the following parameters in their spec:</p>
<ul>
<li><p class="first"><cite>&quot;PK type</cite>&quot; <tt class="docutils literal">[string]</tt></p>
<p>The PK type is a special key-word which corresponds to a given class in the PK factory.  See available PK types listed below.</p>
</li>
<li><p class="first"><cite>&quot;PK name</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>LIST-NAME</strong></p>
<p>This is automatically written as the <cite>&quot;name</cite>&quot; attribute of the containing PK sublist, and need not be included by the user.</p>
</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;PKs&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;my cool PK&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;PK type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;my cool PK&quot;</span><span class="nt">/&gt;</span>
     ...
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;PKs&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;Top level MPC&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;PK type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;strong MPC&quot;</span><span class="nt">/&gt;</span>
     ...
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
<div class="section" id="base-pks">
<h2><a class="toc-backref" href="#id23">Base PKs</a></h2>
<p>There are several types of PKs, and each PK has its own valid input spec.  However, there are three main types of PKs, from which nearly all PKs derive.  Note that none of these are true PKs and cannot stand alone.</p>
<div class="section" id="pkphysicalbase">
<h3><a class="toc-backref" href="#id24">PKPhysicalBase</a></h3>
<blockquote>
A base class with default implementations of methods for a leaf of the PK tree (a conservation equation, or similar).</blockquote>
<p><tt class="docutils literal">PKPhysicalBase</tt> is a base class providing some functionality for PKs which
are defined on a single mesh, and represent a single process model.  Typically
all leaves of the PK tree will inherit from <tt class="docutils literal">PKPhysicalBase</tt>.</p>
<ul>
<li><p class="first"><cite>&quot;domain</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;&quot;</strong>, e.g. <cite>&quot;surface</cite>&quot;.</p>
<p>Domains and meshes are 1-to-1, and the empty string refers to the main domain or mesh.  PKs defined on other domains must specify which domain/mesh they refer to.</p>
</li>
<li><p class="first"><cite>&quot;primary variable</cite>&quot; <tt class="docutils literal">[string]</tt></p>
<p>The primary variable associated with this PK, i.e. <cite>&quot;pressure</cite>&quot;, <cite>&quot;temperature</cite>&quot;, <cite>&quot;surface_pressure</cite>&quot;, etc.</p>
</li>
<li><p class="first"><cite>&quot;initial condition</cite>&quot; <tt class="docutils literal"><span class="pre">[initial-condition-spec]</span></tt>  See <a class="reference internal" href="#initialconditions">InitialConditions</a>.</p>
<p>Additionally, the following parameters are supported:</p>
</li>
</ul>
<blockquote>
<ul>
<li><p class="first"><cite>&quot;initialize faces from cell</cite>&quot; <tt class="docutils literal">[bool]</tt> <strong>false</strong></p>
<p>Indicates that the primary variable field has both CELL and FACE objects, and the FACE values are calculated as the average of the neighboring cells.</p>
</li>
</ul>
</blockquote>
<p>NOTE: <tt class="docutils literal">PKPhysicalBase <span class="pre">(v)--&gt;</span></tt> <a href="#id120"><span class="problematic" id="id121">PKDefaultBase_</span></a></p>
</div>
<div class="section" id="pkbdfbase">
<h3><a class="toc-backref" href="#id25">PKBDFBase</a></h3>
<blockquote>
A base class with default implementations of methods for a PK that can be implicitly integrated in time.</blockquote>
<p><tt class="docutils literal">PKBDFBase</tt> is a base class from which PKs that want to use the <tt class="docutils literal">BDF</tt>
series of implicit time integrators must derive.  It specifies both the
<tt class="docutils literal">BDFFnBase</tt> interface and implements some basic functionality for <tt class="docutils literal">BDF</tt>
PKs.</p>
<ul>
<li><p class="first"><cite>&quot;initial time step</cite>&quot; <tt class="docutils literal">[double]</tt> <strong>1.</strong></p>
<p>The initial timestep size for the PK, this ensures that the initial timestep
will not be <strong>larger</strong> than this value.</p>
</li>
<li><p class="first"><cite>&quot;assemble preconditioner</cite>&quot; <tt class="docutils literal">[bool]</tt> <strong>true</strong></p>
<p>A flag for the PK to not assemble its preconditioner if it is not needed by
a controlling PK.  This is usually set by the MPC, not by the user.</p>
</li>
</ul>
<p>In the top-most (in the PK tree) PK that is meant to be integrated implicitly,
several additional specs are included.  For instance, in a strongly coupled
flow and energy problem, these specs are included in the <tt class="docutils literal">StrongMPC</tt> that
couples the flow and energy PKs, not to the flow or energy PK itself.</p>
<ul>
<li><p class="first"><cite>&quot;time integrator</cite>&quot; <tt class="docutils literal"><span class="pre">[time-integrator-spec]</span></tt> is a <a class="reference internal" href="#timeintegrator">TimeIntegrator</a>.</p>
<p>Note that this is only provided in the top-most <tt class="docutils literal">PKBDFBase</tt> in the tree --
this is often a <a class="reference internal" href="#strongmpc">StrongMPC</a> or a class deriving from <a class="reference internal" href="#strongmpc">StrongMPC</a>.</p>
</li>
<li><p class="first"><cite>&quot;preconditioner</cite>&quot; <tt class="docutils literal"><span class="pre">[preconditioner-spec]</span></tt> is a <a class="reference internal" href="#preconditioner">Preconditioner</a>.</p>
<p>This spec describes how to form the (approximate) inverse of the preconditioner.</p>
</li>
</ul>
<p>NOTE: <tt class="docutils literal">PKBDFBase&nbsp; <span class="pre">(v)--&gt;</span></tt> <a href="#id122"><span class="problematic" id="id123">PKDefaultBase_</span></a></p>
</div>
<div class="section" id="pkphysicalbdfbase">
<h3><a class="toc-backref" href="#id26">PKPhysicalBDFBase</a></h3>
<blockquote>
Standard base for most implemented PKs, this combines both domains/meshes of PKPhysicalBase and BDF methods of PKBDFBase.</blockquote>
<p>A base class for all PKs that are both physical, in the sense that they
implement an equation and are not couplers, and support the implicit
integration interface.  This largely just supplies a default error norm based
on error in conservation relative to the extent of the conserved quantity.</p>
<ul>
<li><p class="first"><cite>&quot;absolute error tolerance</cite>&quot; [double] <strong>1.0</strong></p>
<p>Absolute tolerance, <span class="formula"><i>a</i><sub><i>tol</i></sub></span> in the equation below.</p>
</li>
<li><p class="first"><cite>&quot;relative error tolerance</cite>&quot; [double] <strong>1.0</strong></p>
<p>Relative tolerance, <span class="formula"><i>r</i><sub><i>tol</i></sub></span> in the equation below.</p>
</li>
</ul>
<p>By default, the error norm used by solvers is given by:</p>
<p><span class="formula"><i>ENORM</i>(<i>u</i>, <i>du</i>) = |<i>du</i>| ⁄ (<i>a</i><sub><i>tol</i></sub> + <i>r</i><sub><i>tol</i></sub>*|<i>u</i>|)</span></p>
<p>The defaults here are typically good, or else good defaults are set in the
code, so these need not be supplied.</p>
<dl class="docutils">
<dt>NOTE: <tt class="docutils literal">PKPhysicalBDFBase <span class="pre">--&gt;</span></tt> <a class="reference internal" href="#pkbdfbase">PKBDFBase</a></dt>
<dd><tt class="docutils literal">PKPhysicalBDFBase <span class="pre">--&gt;</span></tt> <a class="reference internal" href="#pkphysicalbase">PKPhysicalBase</a>
<tt class="docutils literal">PKPhysicalBDFBase <span class="pre">(v)--&gt;</span></tt> <a href="#id124"><span class="problematic" id="id125">PKDefaultBase_</span></a></dd>
</dl>
</div>
</div>
<div class="section" id="physical-pks">
<h2><a class="toc-backref" href="#id27">Physical PKs</a></h2>
<p>Physical PKs are the physical capability implemented within ATS.</p>
<div class="section" id="flow-pks">
<h3><a class="toc-backref" href="#id28">Flow PKs</a></h3>
<div class="section" id="richards-pk">
<h4><a class="toc-backref" href="#id29">Richards PK</a></h4>
<blockquote>
Two-phase, variable density Richards equation.</blockquote>
<p>Solves Richards equation:</p>
<div class="formula">
<span class="fraction"><span class="ignored">(</span><span class="numerator">∂Θ</span><span class="ignored">)/(</span><span class="denominator">∂<i>t</i></span><span class="ignored">)</span></span> − ∇<span class="fraction"><span class="ignored">(</span><span class="numerator"><i>k</i><sub><i>r</i></sub><i>n</i><sub><i>l</i></sub></span><span class="ignored">)/(</span><span class="denominator"><i>μ</i></span><span class="ignored">)</span></span><i>K</i>(∇<i>p</i> + <i>ρ</i><i>g</i>⋅<i>ẑ</i>) = <i>Q</i><sub><i>w</i></sub>
</div>
<p>Options:</p>
<p>Variable naming:</p>
<ul class="simple">
<li><cite>&quot;domain</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;&quot;</strong>  Defaults to the base subsurface domain.</li>
<li><cite>&quot;primary variable</cite>&quot; <tt class="docutils literal">[string]</tt> The primary variable associated with this PK, typically <cite>&quot;pressure</cite>&quot;</li>
</ul>
<p>Other variable names, typically not set as the default is basically always good:</p>
<ul class="simple">
<li><cite>&quot;conserved quantity suffix</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;water_content&quot;</strong>  If set, changes the conserved quantity key.</li>
<li><cite>&quot;conserved quantity key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;DOMAIN-CONSERVED_QUANTITY_SUFFIX&quot;</strong> Typically not set, default is good. <tt class="docutils literal">[mol]</tt></li>
<li><cite>&quot;mass density key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;DOMAIN-mass_density_liquid&quot;</strong> liquid water density <tt class="docutils literal">[kg <span class="pre">m^-3]</span></tt></li>
<li><cite>&quot;molar density key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;DOMAIN-molar_density_liquid&quot;</strong> liquid water density <tt class="docutils literal">[mol <span class="pre">m^-3]</span></tt></li>
<li><cite>&quot;permeability key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;DOMAIN-permeability&quot;</strong> permeability of the soil medium <tt class="docutils literal">[m^2]</tt></li>
<li><cite>&quot;conductivity key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;DOMAIN-relative_permeability&quot;</strong> scalar coefficient of the permeability <tt class="docutils literal"><span class="pre">[-]</span></tt></li>
<li><cite>&quot;upwind conductivity key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;DOMAIN-upwind_relative_permeability&quot;</strong> upwinded (face-based) scalar coefficient of the permeability.  Note the units of this are strange, but this represents <span class="formula"><span class="fraction"><span class="ignored">(</span><span class="numerator"><i>n</i><sub><i>l</i></sub><i>k</i><sub><i>r</i></sub></span><span class="ignored">)/(</span><span class="denominator"><i>μ</i></span><span class="ignored">)</span></span></span>  <tt class="docutils literal">[mol <span class="pre">kg^-1</span> s^1 <span class="pre">m^-2]</span></tt></li>
<li><cite>&quot;darcy flux key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;DOMAIN-mass_flux&quot;</strong> mass flux across a face <tt class="docutils literal">[mol <span class="pre">s^-1]</span></tt></li>
<li><cite>&quot;darcy flux direction key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;DOMAIN-mass_flux_direction&quot;</strong> direction of the darcy flux (used in upwinding <span class="formula"><i>k</i><sub><i>r</i></sub></span>) <tt class="docutils literal"><span class="pre">[??]</span></tt></li>
<li><cite>&quot;darcy velocity key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;DOMAIN-darcy_velocity&quot;</strong> darcy velocity vector, interpolated from faces to cells <tt class="docutils literal">[m <span class="pre">s^-1]</span></tt></li>
<li><cite>&quot;darcy flux key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;DOMAIN-mass_flux&quot;</strong> mass flux across a face <tt class="docutils literal">[mol <span class="pre">s^-1]</span></tt></li>
<li><cite>&quot;saturation key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;DOMAIN-saturation_liquid&quot;</strong> volume fraction of the liquid phase <tt class="docutils literal"><span class="pre">[-]</span></tt></li>
</ul>
<p>Discretization control:</p>
<ul class="simple">
<li><cite>&quot;diffusion</cite>&quot; <tt class="docutils literal">[list]</tt> An <a class="reference internal" href="#operatordiffusion">OperatorDiffusion</a> spec describing the (forward) diffusion operator</li>
<li><cite>&quot;diffusion preconditioner</cite>&quot; <tt class="docutils literal">[list]</tt> An <a class="reference internal" href="#operatordiffusion">OperatorDiffusion</a> spec describing the diffusive parts of the preconditioner.</li>
</ul>
<p>Time integration and timestep control:</p>
<ul class="simple">
<li><cite>&quot;initial time step</cite>&quot; <tt class="docutils literal">[double]</tt> <strong>1.</strong> Max initial time step size <tt class="docutils literal">[s]</tt></li>
<li><cite>&quot;time integrator</cite>&quot; <tt class="docutils literal"><span class="pre">[time-integrator-spec]</span></tt> is a <a class="reference internal" href="#timeintegrator">TimeIntegrator</a>.  Note
that this is only provided if this Richards PK is not strongly coupled to
other PKs.</li>
<li><cite>&quot;linear solver</cite>&quot; <tt class="docutils literal"><span class="pre">[linear-solver-spec]</span></tt> is a <a href="#id126"><span class="problematic" id="id127">LinearSolver_</span></a> spec.  Note
that this is only used if this PK is not strongly coupled to other PKs.</li>
<li><cite>&quot;preconditioner</cite>&quot; <tt class="docutils literal"><span class="pre">[preconditioner-spec]</span></tt> is a <a class="reference internal" href="#preconditioner">Preconditioner</a> spec.
Note that this is only used if this PK is not strongly coupled to other PKs.</li>
<li><cite>&quot;initial condition</cite>&quot; <tt class="docutils literal"><span class="pre">[initial-condition-spec]</span></tt> See <a class="reference internal" href="#initialconditions">InitialConditions</a>.
Additionally, the following parameter is supported:<ul>
<li><cite>&quot;initialize faces from cell</cite>&quot; <tt class="docutils literal">[bool]</tt> <strong>false</strong> Indicates that the
primary variable field has both CELL and FACE objects, and the FACE values
are calculated as the average of the neighboring cells.</li>
</ul>
</li>
</ul>
<p>Error control:</p>
<ul>
<li><p class="first"><cite>&quot;absolute error tolerance</cite>&quot; [double] <strong>DERIVED</strong> Defaults to a porosity of 0.5 * a saturation of 0.1 * n_l.  A small, but significant, amount of water.</p>
</li>
<li><p class="first"><cite>&quot;relative error tolerance</cite>&quot; [double] <strong>1</strong> Take the error relative to the amount of water present in that cell.</p>
</li>
<li><p class="first"><cite>&quot;flux tolerance</cite>&quot; [double] <strong>1</strong></p>
<p>Multiplies the error in flux (on a face) relative to the min of water in the
neighboring cells.  Typically only changed if infiltration is very small and
the boundary condition is not converging, at which point it can be decreased
by an order of magnitude at a time until the boundary condition is
satisfied.</p>
</li>
</ul>
<p>Boundary conditions:</p>
<ul class="simple">
<li><cite>&quot;boundary conditions</cite>&quot; <tt class="docutils literal"><span class="pre">[subsurface-flow-bc-spec]</span></tt> <strong>defaults to Neuman, 0 normal flux</strong>  See <a class="reference internal" href="#flow-specific-boundary-conditions">Flow-specific Boundary Conditions</a></li>
</ul>
<p>Physics control:</p>
<ul class="simple">
<li><cite>&quot;permeability rescaling</cite>&quot; <tt class="docutils literal">[double]</tt> <strong>1</strong> Typically 1e7 or order <span class="formula"><i>sqrt</i>(<i>K</i>)</span> is about right.  This rescales things to stop from multiplying by small numbers (permeability) and then by large number (<span class="formula"><i>ρ</i> ⁄ <i>μ</i></span>).</li>
</ul>
<p>May inherit options from <a class="reference internal" href="#pkphysicalbdfbase">PKPhysicalBDFBase</a></p>
</div>
<div class="section" id="permafrost-flow-pk">
<h4><a class="toc-backref" href="#id30">Permafrost Flow PK</a></h4>
</div>
<div class="section" id="overland-flow-head-primary-variable-pk">
<h4><a class="toc-backref" href="#id31">Overland Flow, head primary variable PK</a></h4>
</div>
<div class="section" id="overland-flow-pressure-primary-variable-pk">
<h4><a class="toc-backref" href="#id32">Overland Flow, pressure primary variable, PK</a></h4>
<blockquote>
Overland flow using the diffusion wave equation.</blockquote>
<p>Solves the diffusion wave equation for overland flow with pressure as a primary variable:</p>
<div class="formula">
<span class="fraction"><span class="ignored">(</span><span class="numerator">∂Θ</span><span class="ignored">)/(</span><span class="denominator">∂<i>t</i></span><span class="ignored">)</span></span> − ∇<i>n</i><sub><i>l</i></sub><i>k</i>∇<i>h</i>(<i>p</i>) = <i>Q</i><sub><i>w</i></sub>
</div>
<p>Options:</p>
<p>Variable naming:</p>
<ul class="simple">
<li><cite>&quot;domain</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;surface&quot;</strong>  Defaults to the extracted surface mesh.</li>
<li><cite>&quot;primary variable</cite>&quot; <tt class="docutils literal">[string]</tt> The primary variable associated with this PK, typically <cite>&quot;DOMAIN-pressure</cite>&quot;</li>
</ul>
<p>Other variable names, typically not set as the default is basically always good:</p>
<ul class="simple">
<li><cite>&quot;conserved quantity suffix</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;water_content&quot;</strong>  If set, changes the conserved quantity key.</li>
<li><cite>&quot;conserved quantity key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;DOMAIN-CONSERVED_QUANTITY_SUFFIX&quot;</strong> Typically not set, default is good. <tt class="docutils literal">[mol]</tt></li>
</ul>
<p>Discretization control:</p>
<ul class="simple">
<li><cite>&quot;diffusion</cite>&quot; <tt class="docutils literal">[list]</tt> An <a class="reference internal" href="#operatordiffusion">OperatorDiffusion</a> spec describing the (forward) diffusion operator</li>
<li><cite>&quot;diffusion preconditioner</cite>&quot; <tt class="docutils literal">[list]</tt> An <a class="reference internal" href="#operatordiffusion">OperatorDiffusion</a> spec describing the diffusive parts of the preconditioner.</li>
</ul>
<p>Time integration and timestep control:</p>
<ul class="simple">
<li><cite>&quot;initial time step</cite>&quot; <tt class="docutils literal">[double]</tt> <strong>1.</strong> Max initial time step size <tt class="docutils literal">[s]</tt>.</li>
<li><cite>&quot;time integrator</cite>&quot; <tt class="docutils literal"><span class="pre">[time-integrator-spec]</span></tt> is a <a class="reference internal" href="#timeintegrator">TimeIntegrator</a> spec.
Note that this is only used if this PK is not strongly coupled to other PKs.</li>
<li><cite>&quot;linear solver</cite>&quot; <tt class="docutils literal"><span class="pre">[linear-solver-spec]</span></tt> is a <a href="#id128"><span class="problematic" id="id129">LinearSolver_</span></a> spec.  Note
that this is only used if this PK is not strongly coupled to other PKs.</li>
<li><cite>&quot;preconditioner</cite>&quot; <tt class="docutils literal"><span class="pre">[preconditioner-spec]</span></tt> is a <a class="reference internal" href="#preconditioner">Preconditioner</a> spec.
Note that this is only used if this PK is not strongly coupled to other PKs.</li>
<li><cite>&quot;initial condition</cite>&quot; <tt class="docutils literal"><span class="pre">[initial-condition-spec]</span></tt> See <a class="reference internal" href="#initialconditions">InitialConditions</a>.
Additionally, the following parameter is supported:<ul>
<li><cite>&quot;initialize faces from cell</cite>&quot; <tt class="docutils literal">[bool]</tt> <strong>false</strong> Indicates that the
primary variable field has both CELL and FACE objects, and the FACE values
are calculated as the average of the neighboring cells.</li>
</ul>
</li>
</ul>
<p>Error control:</p>
<ul class="simple">
<li><cite>&quot;absolute error tolerance</cite>&quot; [double] <strong>DERIVED</strong> Defaults to 1 cm of water.  A small, but significant, amount of water.</li>
<li><cite>&quot;relative error tolerance</cite>&quot; [double] <strong>1</strong> Take the error relative to the amount of water present in that cell.</li>
<li><cite>&quot;flux tolerance</cite>&quot; [double] <strong>1</strong> Multiplies the error in flux (on a face)
relative to the min of water in the neighboring cells.  Typically only
changed if infiltration is very small and the boundary condition is not
converging, at which point it can be decreased by an order of magnitude at a
time until the boundary condition is satisfied.</li>
</ul>
<p>Boundary conditions:</p>
<ul class="simple">
<li><cite>&quot;boundary conditions</cite>&quot; <tt class="docutils literal"><span class="pre">[surface-flow-bc-spec]</span></tt> <strong>defaults to Neuman, 0 normal flux</strong></li>
</ul>
<p>May inherit options from <a class="reference internal" href="#pkphysicalbdfbase">PKPhysicalBDFBase</a>.</p>
</div>
<div class="section" id="snow-distribution-pk">
<h4><a class="toc-backref" href="#id33">Snow Distribution PK</a></h4>
</div>
</div>
<div class="section" id="energy-pks">
<h3><a class="toc-backref" href="#id34">Energy PKs</a></h3>
<div class="section" id="advection-diffusion-pk">
<h4><a class="toc-backref" href="#id35">Advection Diffusion PK</a></h4>
</div>
<div class="section" id="energy-base-pk">
<h4><a class="toc-backref" href="#id36">Energy Base PK</a></h4>
</div>
<div class="section" id="two-phase-subsurface-energy-pk">
<h4><a class="toc-backref" href="#id37">Two-Phase subsurface Energy PK</a></h4>
</div>
<div class="section" id="three-phase-subsurface-energy-pk">
<h4><a class="toc-backref" href="#id38">Three-Phase subsurface Energy PK</a></h4>
</div>
<div class="section" id="id1">
<h4><a class="toc-backref" href="#id39">Three-Phase subsurface Energy PK</a></h4>
</div>
<div class="section" id="surface-ice-energy-pk">
<h4><a class="toc-backref" href="#id40">Surface Ice Energy PK</a></h4>
</div>
</div>
<div class="section" id="surface-energy-balance-pks">
<h3><a class="toc-backref" href="#id41">Surface Energy Balance PKs</a></h3>
<div class="section" id="surface-energy-balance-snow-monolithic-version">
<h4><a class="toc-backref" href="#id42">Surface Energy Balance / Snow -- Monolithic Version</a></h4>
</div>
<div class="section" id="surface-energy-balance-generic-version">
<h4><a class="toc-backref" href="#id43">Surface Energy Balance -- Generic Version</a></h4>
</div>
</div>
<div class="section" id="biogeochemistry">
<h3><a class="toc-backref" href="#id44">Biogeochemistry</a></h3>
<div class="section" id="biogeochemistry-monolithic-version">
<h4><a class="toc-backref" href="#id45">Biogeochemistry -- Monolithic Version</a></h4>
</div>
</div>
<div class="section" id="deformation">
<h3><a class="toc-backref" href="#id46">Deformation</a></h3>
<div class="section" id="volumetric-deformation">
<h4><a class="toc-backref" href="#id47">Volumetric Deformation</a></h4>
</div>
</div>
</div>
<div class="section" id="mpcs">
<h2><a class="toc-backref" href="#id48">MPCs</a></h2>
<p>MPCs couple other PKs, and are the non-leaf nodes in the PK tree.</p>
<div class="section" id="weakmpc">
<h3><a class="toc-backref" href="#id49">WeakMPC</a></h3>
</div>
<div class="section" id="strongmpc">
<h3><a class="toc-backref" href="#id50">StrongMPC</a></h3>
</div>
</div>
<div class="section" id="physical-mpcs">
<h2><a class="toc-backref" href="#id51">Physical MPCs</a></h2>
<blockquote>
coupling is an art, and requires special off-diagonal work.  Physical MPCs can derive from default MPCs to provide special work.</blockquote>
<div class="section" id="coupled-water-mpc">
<h3><a class="toc-backref" href="#id52">Coupled Water MPC</a></h3>
<blockquote>
MPCCoupledWater: coupler which integrates surface and subsurface flow.</blockquote>
<p>Couples Richards equation to surface water through continuity of both pressure and fluxes.</p>
<p>Currently requires that the subsurface discretization is a face-based
discretization, i.e. one of the MFD methods.  Then the surface equations are
directly added into the subsurface discrete equations.</p>
<ul class="simple">
<li><cite>&quot;PKs order</cite>&quot; <tt class="docutils literal">[Array(string)]</tt> Supplies the names of the coupled PKs.
The order must be {subsurface_flow_pk, surface_flow_pk} (subsurface first).</li>
<li><cite>&quot;linear solver</cite>&quot; <tt class="docutils literal"><span class="pre">[linear-solver-spec]</span></tt> A <a href="#id130"><span class="problematic" id="id131">LinearSolver_</span></a> spec.  Only used
if this PK is not itself coupled by other strong couplers.</li>
<li><cite>&quot;preconditioner</cite>&quot; <tt class="docutils literal"><span class="pre">[preconditioner-spec]</span></tt> A <a class="reference internal" href="#preconditioner">Preconditioner</a> spec.  Only used
if this PK is not itself coupled by other strong couplers.</li>
<li><cite>&quot;water delegate</cite>&quot; <tt class="docutils literal">[list]</tt></li>
</ul>
<blockquote>
<p>Globalization hacks to deal with nonlinearity around the appearance/disappearance of surface water.</p>
<p>The water delegate works to eliminate discontinuities/strong nonlinearities
when surface cells shift from dry to wet (i.e. the surface pressure goes
from &lt; atmospheric pressure to &gt; atmospheric pressure.</p>
<p>These methods work to alter the predictor around this nonlinearity.</p>
<ul class="simple">
<li><cite>&quot;modify predictor with heuristic</cite>&quot; <tt class="docutils literal">[bool]</tt> <strong>false</strong> This simply
limits the prediction to backtrack to just above atmospheric on both the
first and second timesteps that take us over atmospheric.</li>
<li><cite>&quot;modify predictor damp and cap the water spurt</cite>&quot; <tt class="docutils literal">[bool]</tt> <strong>false</strong> The
second both limits (caps) and damps all surface cells to ensure that all
nearby cells are also not overshooting.  This is the preferred method.</li>
</ul>
<p>These methods work to alter the preconditioned correction for the same
reasons described above.</p>
<ul class="simple">
<li><cite>&quot;global water face limiter</cite>&quot; <tt class="docutils literal">[default]</tt> <strong>INF</strong> This is simply a limit
to the maximum allowed size of the correction (in [Pa]) on all faces.  Any
correction larger than this is set to this.</li>
<li><cite>&quot;cap the water spurt</cite>&quot; <tt class="docutils literal">[bool]</tt> <strong>false</strong> If a correction takes the
pressure on a surface cell from below atmospheric (dry) to above (wet),
the correction is set to a value which results in the new iterate to being
CAP_SIZE over atmospheric.</li>
<li><cite>&quot;damp the water spurt</cite>&quot; <tt class="docutils literal">[bool]</tt> <strong>false</strong> A damping factor (less than
one) is calculated to multiply the correction such that the largest
correction takes a cell to just above atmospheric.  All faces (globally)
are affected.</li>
<li><cite>&quot;damp and cap the water spurt</cite>&quot; <tt class="docutils literal">[bool]</tt> <strong>false</strong> None of the above
should really be used.  Capping, when the cap is particularly severe,
results in faces whose values are very out of equilibrium with their
neighboring cells which are not capped.  Damping results in a tiny
timestep in which, globally, at MOST one face can go from wet to dry.
This looks to do a combination, in which all things are damped, but faces
that are initially expected to go from dry to wet are pre-scaled to ensure
that, when damped, they are also (like the biggest change) allowed to go
from dry to wet (so that multiple cells can wet in the same step).  This
is the preferred method.</li>
</ul>
<p>In these methods, the following parameters are useful:</p>
<ul class="simple">
<li><cite>&quot;cap over atmospheric</cite>&quot; <tt class="docutils literal">[double]</tt> <strong>100 Pa</strong> This sets the max size over
atmospheric to which things are capped or damped.</li>
</ul>
</blockquote>
</div>
<div class="section" id="subsurface-mpc">
<h3><a class="toc-backref" href="#id53">Subsurface MPC</a></h3>
</div>
<div class="section" id="permafrost-mpc">
<h3><a class="toc-backref" href="#id54">Permafrost MPC</a></h3>
</div>
</div>
</div>
<div class="section" id="state">
<h1><a class="toc-backref" href="#id55">State</a></h1>
<p>State consists of two sublists, one for evaluators and the other for
atomic constants.  The latter is currently called <cite>&quot;initial
conditions</cite>&quot;, which is a terrible name which must be fixed.</p>
<p>example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;state&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;field evaluators&quot;</span><span class="nt">&gt;</span>
    ...
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span>
    ...
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
<div class="section" id="field-evaluators">
<h2><a class="toc-backref" href="#id56">Field Evaluators</a></h2>
<p>Many field evaluators exist, but most derive from one of four base types.</p>
<div class="section" id="field-evaluator-base-classes">
<h3><a class="toc-backref" href="#id57">Field Evaluator Base Classes</a></h3>
<div class="section" id="primaryvariableevaluator">
<h4><a class="toc-backref" href="#id58">PrimaryVariableEvaluator</a></h4>
</div>
<div class="section" id="secondaryvariableevaluator">
<h4><a class="toc-backref" href="#id59">SecondaryVariableEvaluator</a></h4>
</div>
<div class="section" id="secondaryvariablesevaluator">
<h4><a class="toc-backref" href="#id60">SecondaryVariablesEvaluator</a></h4>
</div>
<div class="section" id="independentvariableevaluator">
<h4><a class="toc-backref" href="#id61">IndependentVariableEvaluator</a></h4>
<p>While these provide base functionality, all of the physics are in the
following derived classes.</p>
</div>
</div>
<div class="section" id="water-content">
<h3><a class="toc-backref" href="#id62">Water Content</a></h3>
<p>Water content is the conserved quantity in most flow equations, including
Richard's equation with and without ice.  A variety of evaluators are provided
for inclusion of multiple phases.</p>
<div class="section" id="richardswatercontentevaluator">
<h4><a class="toc-backref" href="#id63">RichardsWaterContentEvaluator</a></h4>
<blockquote>
RichardsWaterContentEvaluator: water content without vapor</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 1310)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>Evaluator type: <cite>&quot;richards water content</cite>&quot;</p>
<p>Evaluates water content in cell E.</p>
<div class="formula">
Θ = <i>φ</i><i>n</i><sub><i>liq</i></sub><i>s</i><sub><i>liq</i></sub>|<i>E</i>|
</div>
<ul class="simple">
<li><cite>&quot;my key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_water_content</strong> Set by code, not user. [mol]</li>
<li><cite>&quot;porosity key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_porosity</strong> Names the porosity variable. [-]</li>
<li><cite>&quot;saturation liquid key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_saturation_liquid</strong> Names the saturation variable. [-]</li>
<li><cite>&quot;molar density liquid key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_molar_density_liquid</strong> Names the density variable. [mol m^-3]</li>
<li><cite>&quot;cell volume key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_cell_volume</strong> Names the cell volume variable. [m^3]</li>
</ul>
<p>Note that in the defaults, DOMAIN is determined from the name of the evaluated data, which is set by the name of the list.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;water_content&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;evaluator type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;richards water content&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="richardswatercontentwithvaporevaluator">
<h4><a class="toc-backref" href="#id64">RichardsWaterContentWithVaporEvaluator</a></h4>
<blockquote>
RichardsWaterContentEvaluator: water content without vapor</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 1338)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>Evaluator type: <cite>&quot;richards water content with vapor</cite>&quot;</p>
<p>Evaluates water content in cell E.</p>
<div class="formula">
Θ = <i>φ</i>(<i>n</i><sub><i>liq</i></sub><i>s</i><sub><i>liq</i></sub> + <i>n</i><sub><i>gas</i></sub><i>s</i><sub><i>gas</i></sub><i>ω</i>)|<i>E</i>|
</div>
<ul class="simple">
<li><cite>&quot;my key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_water_content</strong> Set by code, not user. [mol]</li>
<li><cite>&quot;porosity key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_porosity</strong> Names the porosity variable. [-]</li>
<li><cite>&quot;saturation liquid key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_saturation_liquid</strong> Names the saturation variable. [-]</li>
<li><cite>&quot;saturation gas key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_saturation_gas</strong> Names the gas saturation variable. [-]</li>
<li><cite>&quot;molar density liquid key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_molar_density_liquid</strong> Names the density variable. [mol m^-3]</li>
<li><cite>&quot;molar density gas key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_molar_density_gas</strong> Names the gas density variable. [mol m^-3]</li>
<li><cite>&quot;mol fraction vapor in gas key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_mol_frac_gas</strong> Names the molar fraction of water vapor in the gas phase variable. [-]</li>
<li><cite>&quot;cell volume key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_cell_volume</strong> Names the cell volume variable. [m^3]</li>
</ul>
<p>Note that in the defaults, DOMAIN is determined from the name of the evaluated data, which is set by the name of the list.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;water_content&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;evaluator type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;richards water content with vapor&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="permafrostwatercontentevaluator">
<h4><a class="toc-backref" href="#id65">PermafrostWaterContentEvaluator</a></h4>
<blockquote>
RichardsWaterContentEvaluator: water content without vapor</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 1369)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>Evaluator type: <cite>&quot;permafrost water content</cite>&quot;</p>
<p>Evaluates water content in cell E.</p>
<div class="formula">
Θ = <i>φ</i>(<i>n</i><sub><i>ice</i></sub><i>s</i><sub><i>ice</i></sub> + <i>n</i><sub><i>liq</i></sub><i>s</i><sub><i>liq</i></sub> + <i>n</i><sub><i>gas</i></sub><i>s</i><sub><i>gas</i></sub><i>ω</i>)|<i>E</i>|
</div>
<ul class="simple">
<li><cite>&quot;my key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_water_content</strong> Set by code, not user. [mol]</li>
<li><cite>&quot;porosity key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_porosity</strong> Names the porosity variable. [-]</li>
<li><cite>&quot;saturation ice key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_saturation_ice</strong> Names the ice saturation variable. [-]</li>
<li><cite>&quot;saturation liquid key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_saturation_liquid</strong> Names the liquid saturation variable. [-]</li>
<li><cite>&quot;saturation gas key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_saturation_gas</strong> Names the gas saturation variable. [-]</li>
<li><cite>&quot;molar density ice key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_molar_density_ice</strong> Names the ice density variable. [mol m^-3]</li>
<li><cite>&quot;molar density liquid key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_molar_density_liquid</strong> Names the liquid density variable. [mol m^-3]</li>
<li><cite>&quot;molar density gas key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_molar_density_gas</strong> Names the gas density variable. [mol m^-3]</li>
<li><cite>&quot;mol fraction vapor in gas key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_mol_frac_gas</strong> Names the molar fraction of water vapor in the gas phase variable. [-]</li>
<li><cite>&quot;cell volume key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>DOMAIN_cell_volume</strong> Names the cell volume variable. [m^3]</li>
</ul>
<p>Note that in the defaults, DOMAIN is determined from the name of the evaluated data, which is set by the name of the list.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;water_content&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;evaluator type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;permafrost water content&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="surface-water-potential-surfaces">
<h3><a class="toc-backref" href="#id66">Surface Water potential surfaces</a></h3>
<p>Evaluators for</p>
<div class="section" id="surfaceelevation">
<h4><a class="toc-backref" href="#id67">SurfaceElevation</a></h4>
<blockquote>
MeshedElevationEvaluator: evaluates the elevation (z-coordinate) and slope magnitude of a mesh.</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 1409)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>Evaluator type: <cite>&quot;meshed elevation</cite>&quot;</p>
<p>Evaluates the z-coordinate and the magnitude of the slope :math:<tt class="docutils literal">|\nambla_h z|</tt></p>
<ul class="simple">
<li><cite>&quot;elevation key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>elevation</strong> Name the elevation variable. [m]</li>
<li><cite>&quot;slope magnitude key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>slope_magnitude</strong> Name the elevation variable. [-]</li>
<li><cite>&quot;dynamic mesh</cite>&quot; <tt class="docutils literal">[bool]</tt> <strong>false</strong> Lets the evaluator know that the elevation changes in time, and adds the <cite>&quot;deformation</cite>&quot; dependency.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;elevation&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;evaluator type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;meshed elevation&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="surfacepotential">
<h4><a class="toc-backref" href="#id68">SurfacePotential</a></h4>
<blockquote>
PresElevEvaluator: evaluates h + z</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 1431)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>Evaluator type: &quot;&quot;</p>
<div class="formula">
<i>h</i> + <i>z</i>
</div>
<ul class="simple">
<li><cite>&quot;my key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>pres_elev</strong> Names the surface water potential variable, h + z [m]</li>
<li><cite>&quot;height key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>ponded_depth</strong> Names the height variable. [m]</li>
<li><cite>&quot;elevation key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>elevation</strong> Names the elevation variable. [m]</li>
</ul>
<p>NOTE: This is a legacy evaluator, and is not in the factory, so need not be in
the input spec.  However, we include it here because this could easily be
abstracted for new potential surfaces, kinematic wave, etc, at which point it
would need to be added to the factory and the input spec.</p>
<p>NOTE: This could easily be replaced by a generic <a class="reference internal" href="#additiveevaluator">AdditiveEvaluator</a></p>
</div>
<div class="section" id="snowsurfacepotential">
<h4><a class="toc-backref" href="#id69">SnowSurfacePotential</a></h4>
<blockquote>
PresElevEvaluator: evaluates h + z</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 1454)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>Evaluator type: &quot;snow skin potential&quot;</p>
<div class="formula">
<i>h</i> + <i>z</i> + <i>h</i><sub><i>snow</i></sub> + <i>dt</i>*<i>P</i><sub><i>snow</i></sub>
</div>
<ul class="simple">
<li><cite>&quot;my key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>snow_skin_potential</strong> Names the potential variable evaluated [m]</li>
<li><cite>&quot;ponded depth key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>ponded_depth</strong> Names the surface water depth variable. [m]</li>
<li><cite>&quot;snow depth key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>snow_depth</strong> Names the snow depth variable. [m]</li>
<li><cite>&quot;precipitation snow key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>precipitation_snow</strong> Names the snow precipitation key. [m]</li>
<li><cite>&quot;elevation key</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>elevation</strong> Names the elevation variable. [m]</li>
<li><cite>&quot;dt factor</cite>&quot; <tt class="docutils literal">[double]</tt> A free-parameter factor for providing a time scale for diffusion of snow precipitation into low-lying areas.  Typically on the order of 1e4-1e7. This timestep times the wave speed of snow provides an approximate length of how far snow precip can travel.  Extremely tunable! [s]</li>
</ul>
<p>NOTE: This is equivalent to a generic <a class="reference internal" href="#additiveevaluator">AdditiveEvaluator</a></p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;snow_skin_potential&quot;</span> <span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;field evaluator type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;snow skin potential&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;dt factor&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;864000.0&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="generic-evaluators">
<h3><a class="toc-backref" href="#id70">Generic Evaluators</a></h3>
<p>Several generic evaluators are provided.</p>
<div class="section" id="additiveevaluator">
<h4><a class="toc-backref" href="#id71">AdditiveEvaluator</a></h4>
</div>
<div class="section" id="multiplicativeevaluator">
<h4><a class="toc-backref" href="#id72">MultiplicativeEvaluator</a></h4>
</div>
</div>
</div>
<div class="section" id="initialconditions">
<h2><a class="toc-backref" href="#id73">InitialConditions</a></h2>
<p>Initial condition specs are used in two places:</p>
<ul class="simple">
<li>within the <a class="reference internal" href="#pk">PK</a> spec which describes the initial condition of primary variables (true
initial conditions), and</li>
<li>in the <cite>&quot;initial conditions</cite>&quot; sublist of state, in which the value
of atomic constants are provided (not really initial conditions and
should be renamed).  These atomic values are not controlled by
evaluators, and are not included in the DaG.  Likely these should be
removed entirely.</li>
</ul>
<div class="section" id="initialization-of-constant-scalars">
<h3><a class="toc-backref" href="#id74">Initialization of constant scalars</a></h3>
<p>A constant scalar field is the global (with respect to the mesh)
constant.  At the moment, the set of such fields includes atmospheric
pressure.  The initialization requires to provide a named sublist with
a single parameter <cite>&quot;value</cite>&quot;.</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;fluid_density&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;998.0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="initialization-of-constant-vectors">
<h3><a class="toc-backref" href="#id75">Initialization of constant vectors</a></h3>
<p>A constant vector field is the global (with respect to the mesh)
vector constant.  At the moment, the set of such vector constants
includes gravity.  The initialization requires to provide a named
sublist with a single parameter <cite>&quot;Array(double)</cite>&quot;. In two dimensions,
is looks like</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.0, -9.81}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="initialization-of-scalar-fields">
<h3><a class="toc-backref" href="#id76">Initialization of scalar fields</a></h3>
<p>A variable scalar field is defined by a few functions (labeled for instance,
<cite>&quot;Mesh Block i</cite>&quot; with non-overlapping ranges.
The required parameters for each function are <cite>&quot;region</cite>&quot;, <cite>&quot;component</cite>&quot;,
and the function itself.</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;porosity&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;Mesh Block 1&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;region&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Computational domain&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;component&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;cell&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.2&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;Mesh Block 2&quot;</span><span class="nt">&gt;</span>
      ...
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="initialization-of-tensor-fields">
<h3><a class="toc-backref" href="#id77">Initialization of tensor fields</a></h3>
<p>A variable tensor (or vector) field is defined similarly to a variable
scalar field.  The difference lies in the definition of the function
which is now a multi-values function.  The required parameters are
<cite>&quot;Number of DoFs</cite>&quot; and <cite>&quot;Function type</cite>&quot;.</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;Number of DoFs&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;Function type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;composite function&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;DoF 1 Function&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.9976e-12&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;DoF 2 Function&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.9976e-13&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="initialization-from-a-file">
<h3><a class="toc-backref" href="#id78">Initialization from a file</a></h3>
<p>Some data can be initialized from files. Additional sublist has to be
added to named sublist of the <cite>&quot;state</cite>&quot; list with the file name and
the name of attribute.  For a serial run, the file extension must be
<cite>&quot;.exo</cite>&quot;.  For a parallel run, it must be <cite>&quot;.par</cite>&quot;.  Here is an
example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;permeability&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;exodus file initialization&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;mesh_with_data.exo&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;attribute&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;perm&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
<p>example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;state&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;initial conditions&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;fluid_density&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;998.0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>

    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;fluid_viscosity&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.001&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>

    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;gravity&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.0, -9.81}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>

  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="boundaryconditions">
<h2><a class="toc-backref" href="#id79">BoundaryConditions</a></h2>
<p>In general, boundary conditions are provided in a heirarchical list by
boundary condition type, then functional form.  Boundary condition specs are
split between two types -- those which require a user-provided function
(i.e. Dirichlet data, etc) and those which do not (i.e. zero gradient
conditions).</p>
<p>A list of conditions might pull in both Dirichlet and Neumann data on
different regions, or use different functions on different regions.  The
following example illustrates how boundary conditions are prescribed across
the domain for a typical PK:</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;DIRICHLET_TYPE&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;DIRICHLET_FUNCTION_NAME&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;101325.0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC east&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{east}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;DIRICHLET_FUNCTION_NAME&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;102325.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;mass flux&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC north&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{north}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;outward mass flux&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;zero gradient&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC south&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{south}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
<p>Different PKs populate this general format with different names, replacing
DIRICHLET_TYPE and DIRICHLET_FUNCTION_NAME.</p>
<div class="section" id="flow-specific-boundary-conditions">
<h3><a class="toc-backref" href="#id80">Flow-specific Boundary Conditions</a></h3>
<p>Flow boundary conditions must follow the general format shown in
<a class="reference internal" href="#boundaryconditions">BoundaryConditions</a>.  Specific conditions implemented include:</p>
<div class="section" id="dirichlet-pressure-boundary-conditions">
<h4><a class="toc-backref" href="#id81">Dirichlet (pressure) boundary conditions</a></h4>
<p>Used for both surface and subsurface flows, this provides pressure data on
boundaries (in [Pa]).</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;pressure&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary pressure&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;101325.0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="neumann-mass-flux-boundary-conditions">
<h4><a class="toc-backref" href="#id82">Neumann (mass flux) boundary conditions</a></h4>
<p>Used for both surface and subsurface flows, this provides mass flux data (in [mol m^-2 s^-1], in the outward normal direction) on boundaries.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;mass flux&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;outward mass flux&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;-1.e-3&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="seepage-face-boundary-conditions">
<h4><a class="toc-backref" href="#id83">Seepage face boundary conditions</a></h4>
<p>A variety of seepage face boundary conditions are permitted for both surface
and subsurface flow PKs.  Typically seepage conditions are of the form:</p>
<blockquote>
<ul class="simple">
<li>if <span class="formula"><i>q</i>⋅<i>n̂</i> &lt; 0</span>, then <span class="formula"><i>q</i> = 0</span></li>
<li>if <span class="formula"><i>p</i> &gt; <i>p</i>0</span>, then <span class="formula"><i>p</i> = <i>p</i>0</span></li>
</ul>
</blockquote>
<p>This ensures that flow is only out of the domain, but that the max pressure on
the boundary is specified by <span class="formula"><i>p</i>0</span>.</p>
<p>Example: pressure (for surface or subsurface)</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;seepage face pressure&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary pressure&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;101325.&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
<p>Example: head (for surface)</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;seepage face head&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary head&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
<p>Additionally, an infiltration flux may be prescribed, which describes the max
flux.  This is for surface faces on which a typical precipitation rate might
be prescribed, to be enforced until the water table rises to the surface, at
which point the precip is turned off and water seeps into runoff.  This
capability is experimental and has not been well tested.</p>
<blockquote>
<ul class="simple">
<li>if <span class="formula"><i>q</i>⋅<i>n̂</i> &lt; <i>q</i>0</span>, then <span class="formula"><i>q</i> = <i>q</i>0</span></li>
<li>if <span class="formula"><i>p</i> &gt; <i>p</i><sub><i>atm</i></sub></span>, then <span class="formula"><i>p</i> = <i>p</i><sub><i>atm</i></sub></span></li>
</ul>
</blockquote>
<p>Example: seepage with infiltration</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;seepage face with infiltration&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;outward mass flux&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;-1.e-5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
<p>Note it would be straightforward to add both p0 and q0 in the same condition;
this has simply not had a use case yet.</p>
</div>
<div class="section" id="dirichlet-head-boundary-conditions">
<h4><a class="toc-backref" href="#id84">Dirichlet (head) boundary conditions</a></h4>
<p>Used for surface flows, this provides head data (in [m]) on boundaries.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;head&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary head&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.01&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="fixed-level-boundary-conditions">
<h4><a class="toc-backref" href="#id85">Fixed level boundary conditions</a></h4>
<p>For surface flows only.  This fixes the water table at a constant elevation.
It is a head condition that adapts to the surface elevation such that</p>
<div class="formula">
<i>h</i> = <i>max</i>(<i>h</i>0 − <i>z</i>, 0)
</div>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;fixed level&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;fixed level&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/ParameterList&gt;</span>
      <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="zero-head-gradient-boundary-conditions">
<h4><a class="toc-backref" href="#id86">Zero head gradient boundary conditions</a></h4>
<p>Used for surface flows, this is an &quot;outlet&quot; boundary condition which looks to
enforce the condition that</p>
<div class="formula">
÷<i>h</i>⋅<i>n̂</i> = 0
</div>
<p>for head <span class="formula"><i>h</i></span> and outward normal <span class="formula"><i>n̂</i></span>.  Note that this is an
&quot;outlet&quot; boundary, in the sense that it should really not be used on a
boundary in which</p>
<div class="formula">
÷<i>z</i>⋅<i>n̂</i> &gt; 0.
</div>
<p>This makes it a useful boundary condition for benchmark and 2D problems, where
the elevation gradient is clear, but not so useful for DEM-based meshes.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;zero gradient&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="critical-depth-boundary-conditions">
<h4><a class="toc-backref" href="#id87">Critical depth boundary conditions</a></h4>
<p>Also for surface flows, this is an &quot;outlet&quot; boundary condition which looks to
set an outward flux to take away runoff.  This condition is given by:</p>
<div class="formula">
<i>q</i> = <span class="sqrt"><span class="radical">√</span><span class="ignored">(</span><span class="root"><i>g</i><i>ẑ</i></span><span class="ignored">)</span></span><i>n</i><sub><i>liq</i></sub><i>h</i><sup>1</sup>.5
</div>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boundary conditions&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;critical depth&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;BC west&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;regions&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{west}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="time-integrators-solvers-and-other-mathematical-specs">
<h1><a class="toc-backref" href="#id88">Time integrators, solvers, and other mathematical specs</a></h1>
<p>Common specs for all solvers and time integrators, used in PKs.</p>
<div class="section" id="timeintegrator">
<h2><a class="toc-backref" href="#id89">TimeIntegrator</a></h2>
</div>
<div class="section" id="linear-solver-spec">
<h2><a class="toc-backref" href="#id90">Linear Solver Spec</a></h2>
<p>For each solver, a few parameters are used:</p>
<ul>
<li><p class="first"><cite>&quot;iterative method</cite>&quot; <tt class="docutils literal">[string]</tt> <cite>&quot;pcg</cite>&quot;, <cite>&quot;gmres</cite>&quot;, or <cite>&quot;nka</cite>&quot;</p>
<p>defines which method to use.</p>
</li>
<li><p class="first"><cite>&quot;error tolerance</cite>&quot; <tt class="docutils literal">[double]</tt> <strong>1.e-6</strong> is used in the convergence test.</p>
</li>
<li><p class="first"><cite>&quot;maximum number of iterations</cite>&quot; <tt class="docutils literal">[int]</tt> <strong>100</strong> is used in the convergence test.</p>
</li>
<li><p class="first"><cite>&quot;convergence criteria</cite>&quot; <tt class="docutils literal">[Array(string)]</tt>  <strong>{&quot;relative rhs&quot;}</strong> specifies multiple convergence criteria. The list
may include <cite>&quot;relative residual</cite>&quot;, <cite>&quot;relative rhs</cite>&quot;, and <cite>&quot;absolute residual</cite>&quot;, and <cite>&quot;???? force once????</cite>&quot;</p>
</li>
<li><p class="first"><cite>&quot;size of Krylov space</cite>&quot; <tt class="docutils literal">[int]</tt> is used in GMRES iterative method. The default value is 10.</p>
</li>
</ul>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;my solver&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;iterative method&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;gmres&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;error tolerance&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1e-12&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;maximum number of iterations&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;400&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;convergence criteria&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{relative residual}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;size of Krylov space&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>

  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;VerboseObject&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;Verbosity Level&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;high&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="preconditioner">
<h2><a class="toc-backref" href="#id91">Preconditioner</a></h2>
<p>These can be used by a process kernel lists to define a preconditioner.  The only common parameter required by all lists is the type:</p>
<blockquote>
<ul class="simple">
<li><cite>&quot;preconditioner type</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>&quot;identity&quot;</strong>, <cite>&quot;boomer amg</cite>&quot;, <cite>&quot;trilinos ml</cite>&quot;, <cite>&quot;block ilu</cite>&quot; ???</li>
<li><cite>&quot;PC TYPE parameters</cite>&quot; <tt class="docutils literal">[list]</tt> includes a list of parameters specific to the type of PC.</li>
</ul>
</blockquote>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;my preconditioner&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;trilinos ml&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;trilinos ml parameters&quot;</span><span class="nt">&gt;</span> ?????? check me!
       ...
   <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
<div class="section" id="hypre-s-boomer-amg">
<h3><a class="toc-backref" href="#id92">Hypre's Boomer AMG</a></h3>
<blockquote>
PreconditionerBoomerAMG: HYPRE's multigrid preconditioner.</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 2007)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>Internal parameters for Boomer AMG include</p>
<ul class="simple">
<li><cite>&quot;tolerance</cite>&quot; <tt class="docutils literal">[double]</tt> if is not zero, the preconditioner is dynamic
and approximate the inverse matrix with the prescribed tolerance (in
the energy norm ???).</li>
<li><cite>&quot;smoother sweeps</cite>&quot; <tt class="docutils literal">[int]</tt> <strong>3</strong> defines the number of smoothing loops. Default is 3.</li>
<li><cite>&quot;cycle applications</cite>&quot; <tt class="docutils literal">[int]</tt> <strong>5</strong> defines the number of V-cycles.</li>
<li><cite>&quot;strong threshold</cite>&quot; <tt class="docutils literal">[double]</tt> <strong>0.5</strong> defines the number of V-cycles. Default is 5.</li>
<li><cite>&quot;relaxation type</cite>&quot; <tt class="docutils literal">[int]</tt> <strong>6</strong> defines the smoother to be used. Default is 6
which specifies a symmetric hybrid Gauss-Seidel / Jacobi hybrid method. TODO: add others!</li>
<li><cite>&quot;coarsen type</cite>&quot; <tt class="docutils literal">[int]</tt> <strong>0</strong> defines the coarsening strategy to be used. Default is 0
which specifies a Falgout method. TODO: add others!</li>
<li><cite>&quot;max multigrid levels</cite>&quot; <tt class="docutils literal">[int]</tt> optionally defined the maximum number of multigrid levels.</li>
<li><cite>&quot;number of functions</cite>&quot; <tt class="docutils literal">[int]</tt> <strong>1</strong>  Any value &gt; 1 tells Boomer AMG to use the <cite>&quot;systems
of PDEs</cite>&quot; code.  Note that, to use this approach, unknowns must be ordered with
DoF fastest varying (i.e. not the native Epetra_MultiVector order).  By default, it
uses the <cite>&quot;unknown</cite>&quot; approach in which each equation is coarsened and
interpolated independently.  <strong>Getting this correct is very helpful!</strong><ul>
<li><cite>&quot;nodal strength of connection norm</cite>&quot; <tt class="docutils literal">[int]</tt> tells AMG to coarsen such
that each variable has the same coarse grid - sometimes this is more
&quot;physical&quot; for a particular problem. The value chosen here for nodal
determines how strength of connection is determined between the
coupled system.  I suggest setting nodal = 1, which uses a Frobenius
norm.  This does NOT tell AMG to use nodal relaxation.
Default is 0.</li>
</ul>
</li>
<li><cite>&quot;verbosity</cite>&quot; <tt class="docutils literal">[int]</tt> <strong>0</strong> prints a summary of run time settings and
timing information to stdout.  <cite>&quot;1</cite>&quot; prints coarsening info, <cite>&quot;2</cite>&quot; prints
smoothing info, and <cite>&quot;3</cite>'&quot; prints both.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;boomer amg parameters&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;tolerance&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;smoother sweeps&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;cycle applications&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;strong threshold&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.5&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;coarsen type&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;relaxation type&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;verbosity&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;number of functions&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="trilinos-ml">
<h3><a class="toc-backref" href="#id93">Trilinos ML</a></h3>
<blockquote>
PreconditionerML: Trilinos ML multigrid.</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 2066)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>Internal parameters of Trilinos ML includes</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;ml parameters&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;ML output&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;aggregation: damping factor&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.33&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;aggregation: nodes per aggregate&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;3&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;aggregation: threshold&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;aggregation: type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Uncoupled&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;coarse: type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Amesos-KLU&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;coarse: max size&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;128&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;coarse: damping factor&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;cycle applications&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;eigen-analysis: iterations&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;eigen-analysis: type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;cg&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;max levels&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;40&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;prec type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;MGW&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;smoother: damping factor&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;smoother: pre or post&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;both&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;smoother: sweeps&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;smoother: type&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Gauss-Seidel&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="block-ilu">
<h3><a class="toc-backref" href="#id94">Block ILU</a></h3>
<blockquote>
PreconditionerBlockILU:   Incomplete LU preconditioner.</blockquote>
<p>The internal parameters for block ILU are as follows:</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;block ilu parameters&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;fact: relax value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;fact: absolute threshold&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;fact: relative threshold&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;fact: level-of-fill&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;overlap&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;schwarz: combine mode&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;Add&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="indentity">
<h3><a class="toc-backref" href="#id95">Indentity</a></h3>
<p>The default, no PC applied.</p>
</div>
</div>
<div class="section" id="nonlinearsolver">
<h2><a class="toc-backref" href="#id96">NonlinearSolver</a></h2>
</div>
</div>
<div class="section" id="other-common-specs">
<h1><a class="toc-backref" href="#id97">Other Common Specs</a></h1>
<div class="section" id="ioevent">
<h2><a class="toc-backref" href="#id98">IOEvent</a></h2>
<blockquote>
IOEvent: base time/timestep control determing when in time to do something.</blockquote>
<p>The IOEvent is used for multiple objects that need to indicate simulation times or cycles on which to do something.</p>
<ul>
<li><p class="first"><cite>&quot;cycles start period stop</cite>&quot; <tt class="docutils literal">[Array(int)]</tt></p>
<blockquote>
<p>The first entry is the start cycle, the second is the cycle
period, and the third is the stop cycle or -1, in which case there
is no stop cycle. A visualization dump is written at such
cycles that satisfy cycle = start + n*period, for n=0,1,2,... and
cycle &lt; stop if stop != -1.0.</p>
</blockquote>
</li>
<li><p class="first"><cite>&quot;cycles start period stop N</cite>&quot; <tt class="docutils literal">[Array(int)]</tt></p>
<blockquote>
<p>If multiple cycles start period stop parameters are needed, then
use these parameters with N=0,1,2,...</p>
</blockquote>
</li>
<li><p class="first"><cite>&quot;cycles</cite>&quot; <tt class="docutils literal">[Array(int)]</tt></p>
<blockquote>
<p>An array of discrete cycles that at which a visualization dump is
written.</p>
</blockquote>
</li>
<li><p class="first"><cite>&quot;times start period stop</cite>&quot; <tt class="docutils literal">[Array(double)]</tt></p>
<blockquote>
<p>The first entry is the start time, the second is the time period,
and the third is the stop time or -1, in which case there is no
stop time. A visualization dump is written at such times that
satisfy time = start + n*period, for n=0,1,2,... and time &lt; stop
if stop != -1.0.  Note that all times units are in seconds.</p>
</blockquote>
</li>
<li><p class="first"><cite>&quot;times start period stop n</cite>&quot; <tt class="docutils literal">[Array(double)]</tt></p>
<blockquote>
<p>If multiple start period stop parameters are needed, then use this
these parameters with n=0,1,2,..., and not the single <cite>&quot;times
start period stop</cite>&quot; parameter.  Note that all times units are in
seconds.</p>
</blockquote>
</li>
<li><p class="first"><cite>&quot;times</cite>&quot; <tt class="docutils literal">[Array(double)]</tt></p>
<blockquote>
<p>An array of discrete times that at which a visualization dump
shall be written.  Note that all times units are in seconds.</p>
</blockquote>
</li>
</ul>
</div>
<div class="section" id="verboseobject">
<h2><a class="toc-backref" href="#id99">VerboseObject</a></h2>
<blockquote>
VerboseObject: a controller for writing log files on multiple cores with varying verbosity.</blockquote>
<p>This allows control of log-file verbosity for a wide variety of objects
and physics.</p>
<ul>
<li><p class="first"><cite>&quot;verbosity level</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>GLOBAL_VERBOSITY</strong>, <cite>&quot;low</cite>&quot;, <cite>&quot;medium</cite>&quot;, <cite>&quot;high</cite>&quot;, <cite>&quot;extreme</cite>&quot;</p>
<blockquote>
<p>The default is set by the global verbosity spec, (fix me!)  Typically,
<cite>&quot;low</cite>&quot; prints out minimal information, <cite>&quot;medium</cite>&quot; prints out errors and
overall high level information, <cite>&quot;high</cite>&quot; prints out basic debugging, and
<cite>&quot;extreme</cite>&quot; prints out local debugging information.</p>
</blockquote>
</li>
</ul>
<p>Note: while there are other options, users should typically not need them.
Instead, developers can use them to control output.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;verbose object&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;verbosity level&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;medium&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;my header&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;hide line prefix&quot;</span> <span class="na">type=</span><span class="s">&quot;bool&quot;</span> <span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;write on rank&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="function">
<h2><a class="toc-backref" href="#id100">Function</a></h2>
<blockquote>
Function: base class for all functions of space and time.</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 2217)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>Analytic, algabraic functions of space and time are used for a variety of
purposes, including boundary conditions, initial conditions, and independent
variables.</p>
<p>For initial conditions, functions are prescribed of space only, i.e.</p>
<p><span class="formula"><i>u</i> = <i>f</i>(<i>x</i>, <i>y</i>, <i>z</i>)</span></p>
<p>For boundary conditions and independent variables, functions are also a
function of time:</p>
<p><span class="formula"><i>u</i> = <i>f</i>(<i>t</i>, <i>x</i>, <i>y</i>, <i>z</i>)</span></p>
<p>A <tt class="docutils literal"><span class="pre">[function-spec]</span></tt> is used to prescribe these functions.</p>
<p>It is straightforward to add new functions as needed.</p>
<div class="section" id="constant-function">
<h3><a class="toc-backref" href="#id101">Constant Function</a></h3>
<blockquote>
ConstantFunction: Implements the Function interface using a constant value.</blockquote>
<p>Constant function is defined as <span class="formula"><i>f</i>(<i>x</i>) = <i>a</i></span>, for all <span class="formula"><i>x</i></span>.</p>
<ul class="simple">
<li><cite>&quot;value</cite>&quot; <tt class="docutils literal">[double]</tt> The constant to be applied.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-constant&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="tabular-function">
<h3><a class="toc-backref" href="#id102">Tabular Function</a></h3>
<blockquote>
TabularFunction: Piecewise-defined function.</blockquote>
<p>A piecewise function of one variable.</p>
<p>A tabular function is tabulated on a series of intervals; given values
<span class="formula"><i>x</i><sub><i>i</i></sub>, <i>y</i><sub><i>i</i></sub>, , <i>i</i> = 0, ...<i>n</i> − 1</span> and functional forms <span class="formula"><i>f</i><sub><i>j</i></sub>, , <i>j</i> = 0, ...<i>n</i> − 2</span> a tabular function <span class="formula"><i>f</i>(<i>x</i>)</span> is defined as:</p>
<div class="formula">
<span class="array"><span class="arrayrow">
<span class="arraycell align-c">
<i>f</i>(<i>x</i>)
</span>
<span class="arraycell align-c">
 = 
</span>
<span class="arraycell align-c">
<i>y</i><sub>0</sub>, 
</span>
<span class="arraycell align-c">
<i>x</i> ≤ <i>x</i><sub>0</sub>, 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-c">
 
</span>
<span class="arraycell align-c">
 
</span>
<span class="arraycell align-c">
 
</span>
<span class="arraycell align-c">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-c">
<i>f</i>(<i>x</i>)
</span>
<span class="arraycell align-c">
 = 
</span>
<span class="arraycell align-c">
<i>f</i><sub><i>i</i> − 1</sub>(<i>x</i>)
</span>
<span class="arraycell align-c">
<i>x</i> ∈ (<i>x</i><sub><i>i</i> − 1</sub>, <i>x</i><sub><i>i</i></sub>], 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-c">
 
</span>
<span class="arraycell align-c">
 
</span>
<span class="arraycell align-c">
 
</span>
<span class="arraycell align-c">
 
</span>

</span>
<span class="arrayrow">
<span class="arraycell align-c">
<i>f</i>(<i>x</i>)
</span>
<span class="arraycell align-c">
 = 
</span>
<span class="arraycell align-c">
<i>y</i><sub><i>n</i> − 1</sub>, 
</span>
<span class="arraycell align-c">
<i>x</i> &gt; <i>x</i><sub><i>n</i> − 1</sub>.
</span>

</span>
</span>
</div>
<p>The functional forms <span class="formula"><i>f</i><sub><i>j</i></sub></span> may be constant, which uses the left endpoint, i.e.</p>
<p><span class="formula"><i>f</i><sub><i>i</i></sub>(<i>x</i>) = <i>y</i><sub><i>i</i></sub></span>,</p>
<p>linear, i.e.</p>
<p><span class="formula"><i>f</i><sub><i>i</i></sub>(<i>x</i>) = (<i>y</i><sub><i>i</i></sub>*(<i>x</i> − <i>x</i><sub><i>i</i></sub>) + <i>y</i><sub><i>i</i> + 1</sub>*(<i>x</i><sub><i>i</i> + 1</sub> − <i>x</i>)) ⁄ (<i>x</i><sub><i>i</i> + 1</sub> − <i>x</i><sub><i>i</i></sub>)</span></p>
<p>or arbitrary, in which the <span class="formula"><i>f</i><sub><i>j</i></sub></span> must be provided.</p>
<p>The <span class="formula"><i>x</i><sub><i>i</i></sub></span> and <span class="formula"><i>y</i><sub><i>i</i></sub></span> may be provided in one of two ways -- explicitly in the input spec or from an HDF5 file.  The length of these must be equal, and the <span class="formula"><i>x</i><sub><i>i</i></sub></span> must be monotonically increasing.  Forms, as defined on intervals, must be of length equal to the length of the <span class="formula"><i>x</i><sub><i>i</i></sub></span> less one.</p>
<p>Explicitly specifying the data:</p>
<ul class="simple">
<li><cite>&quot;x values</cite>&quot; <tt class="docutils literal">[Array(double)]</tt> the <span class="formula"><i>x</i><sub><i>i</i></sub></span></li>
<li><cite>&quot;y values</cite>&quot; <tt class="docutils literal">[Array(double)]</tt> the <span class="formula"><i>y</i><sub><i>i</i></sub></span></li>
<li><cite>&quot;forms</cite>&quot; <tt class="docutils literal">[Array(string)]</tt> <strong>linear</strong>, <cite>&quot;constant</cite>&quot;, <cite>&quot;USER_DEFINED</cite>&quot;</li>
<li><cite>&quot;USER_DEFINED</cite>&quot; <tt class="docutils literal"><span class="pre">[function-spec]</span></tt> user-provided functional forms on the interval</li>
<li><cite>&quot;x coordinate</cite>&quot; <tt class="docutils literal">[string]</tt> <strong>t</strong>, <cite>&quot;x</cite>&quot;, <cite>&quot;y</cite>&quot;, <cite>&quot;z</cite>&quot; defines which coordinate direction the <span class="formula"><i>x</i><sub><i>i</i></sub></span> are formed, defaulting to time.</li>
</ul>
<p>The below example defines a function that is zero on interval <span class="formula">( − ∞,  0]</span>,
linear on interval <span class="formula">(0,  1]</span>, constant (<cite>f(x)=1</cite>) on interval <span class="formula">(1,  2]</span>,
square root of <cite>t</cite> on interval <span class="formula">(2,  3]</span>,
and constant (<cite>f(x)=2</cite>) on interval <span class="formula">(3,  ∞]</span>.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-tabular&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x values&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.0, 1.0, 2.0, 3.0}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;t&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;y values&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{0.0, 1.0, 2.0, 2.0}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;forms&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{linear, constant, USER_FUNC}&quot;</span><span class="nt">/&gt;</span>

  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;USER_FUNC&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-standard-math&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;operator&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;sqrt&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
<p>Loading table from file (note that <cite>&quot;USER_DEFINED</cite>&quot; is not an option here, but could be made so if requested):</p>
<ul class="simple">
<li><cite>&quot;file</cite>&quot; <tt class="docutils literal">[string]</tt> filename of the HDF5 data</li>
<li><cite>&quot;x header</cite>&quot; <tt class="docutils literal">[string]</tt> name of the dataset for the <span class="formula"><i>x</i><sub><i>i</i></sub></span> in the file</li>
<li><cite>&quot;y header</cite>&quot; <tt class="docutils literal">[string]</tt> name of the dataset for the <span class="formula"><i>y</i><sub><i>i</i></sub></span> in the file</li>
<li><cite>&quot;forms</cite>&quot; <tt class="docutils literal">[Array(string)]</tt> <strong>linear</strong>, <cite>&quot;constant</cite>&quot;</li>
</ul>
<p>The example below would perform linear-interpolation on the intervals provided by data within the hdf5 file <cite>&quot;my_data.h5</cite>&quot;.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-tabular&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;my_data.h5&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;t&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;/time&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;y header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;/data&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="smooth-step-function">
<h3><a class="toc-backref" href="#id103">Smooth step Function</a></h3>
<blockquote>
SmoothStepFunction: a smoothed discontinuity.</blockquote>
<p>A smooth <span class="formula"><i>C</i><sup>2</sup></span> function <cite>f(x)</cite> on interval <span class="formula">[<i>x</i><sub>0</sub>,  <i>x</i><sub>1</sub>]</span> is
defined such that <cite>f(x) = y_0</cite> for <cite>x &lt; x0</cite>, <cite>f(x) = y_1</cite> for <cite>x &gt; x_1</cite>, and
monotonically increasing for <span class="formula"><i>x</i> ∈ [<i>x</i><sub>0</sub>, <i>x</i><sub>1</sub>]</span> through cubic
interpolation.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-smooth-step&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x0&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;y0&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x1&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;y1&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;2.0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="polynomial-function">
<h3><a class="toc-backref" href="#id104">Polynomial Function</a></h3>
<blockquote>
PolynomialFunction: a polynomial</blockquote>
<p>A generic polynomial function is given by the following expression:</p>
<div class="formula">
<i>f</i>(<i>x</i>) = <span class="limits"><sup class="limit"><i>n</i></sup><span class="limit">⎲</span><span class="limit">⎳</span><sub class="limit"><i>j</i> = 0</sub></span><i>c</i><sub><i>j</i></sub>(<i>x</i> − <i>x</i><sub>0</sub>)<sup><i>p</i><sub><i>j</i></sub></sup>
</div>
<p>where <span class="formula"><i>c</i><sub><i>j</i></sub></span> are coefficients of monomials,
<span class="formula"><i>p</i><sub><i>j</i></sub></span> are integer exponents, and <span class="formula"><i>x</i><sub>0</sub></span> is the reference point.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-polynomial&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;coefficients&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{1.0, 1.0}}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;exponents&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{2, 4}}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;reference point&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.0&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="multi-variable-linear-function">
<h3><a class="toc-backref" href="#id105">Multi-variable linear Function</a></h3>
<blockquote>
LinearFunction: a multivariate linear function.</blockquote>
<p>A multi-variable linear function is formally defined by</p>
<div class="formula">
<i>f</i>(<i>x</i>) = <i>y</i><sub>0</sub> + <span class="limits"><sup class="limit"><i>n</i> − 1</sup><span class="limit">⎲</span><span class="limit">⎳</span><sub class="limit"><i>j</i> = 0</sub></span><i>g</i><sub><i>j</i></sub>(<i>x</i><sub><i>j</i></sub> − <i>x</i><sub>0, <i>j</i></sub>)
</div>
<p>with the constant term &quot;math:<cite>y_0</cite> and gradient <span class="formula"><i>g</i><sub>0</sub>,  <i>g</i><sub>1</sub> ..., <i>g</i><sub><i>n</i> − 1</sub></span>.
If the reference point <span class="formula"><i>x</i><sub>0</sub></span> is specified, it must have the same
number of values as the gradient.  Otherwise, it defaults to zero.
Note that one of the parameters in a multi-valued linear function can be time.
Here is an example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-linear&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;y0&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;gradient&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{1.0, 2.0, 3.0}}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x0&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{{2.0, 3.0, 1.0}}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="separable-function">
<h3><a class="toc-backref" href="#id106">Separable Function</a></h3>
<blockquote>
SeparableFunction: f(x,y) = f1(x)*f2(y)</blockquote>
<p>A separable function is defined as the product of other functions such as</p>
<div class="formula">
<i>f</i>(<i>x</i><sub>0</sub>, <i>x</i><sub>1</sub>, ..., <i>x</i><sub><i>n</i> − 1</sub>) = <i>f</i><sub>1</sub>(<i>x</i><sub>0</sub>) <i>f</i><sub>2</sub>(<i>x</i><sub>1</sub>, ..., <i>x</i><sub><i>n</i> − 1</sub>)
</div>
<p>where <span class="formula"><i>f</i><sub>1</sub></span> is defined by the <cite>&quot;function1</cite>&quot; sublist, and
<span class="formula"><i>f</i><sub>2</sub></span> by the <cite>&quot;function2</cite>&quot; sublist:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-separable&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function1&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function2&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="additive-function">
<h3><a class="toc-backref" href="#id107">Additive Function</a></h3>
<blockquote>
AdditiveFunction: f(x,y) = f1(x,y) + f2(x,y)</blockquote>
<p>An additive function simply adds two other function results together.</p>
<div class="formula">
<i>f</i>(<i>x</i>) = <i>f</i><sub>1</sub>(<i>x</i>) + <i>f</i><sub>2</sub>(<i>x</i>)
</div>
<p>where <span class="formula"><i>f</i><sub>1</sub></span> is defined by the <cite>&quot;function1</cite>&quot; sublist, and
<span class="formula"><i>f</i><sub>2</sub></span> by the <cite>&quot;function2</cite>&quot; sublist:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-additive&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function1&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function2&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="multiplicative-function">
<h3><a class="toc-backref" href="#id108">Multiplicative Function</a></h3>
<blockquote>
MultiplicativeFunction: f(x,y) = f1(x,y) * f2(x,y)</blockquote>
<p>A multiplicative function simply multiplies two other function results together.</p>
<div class="formula">
<i>f</i>(<i>x</i>) = <i>f</i><sub>1</sub>(<i>x</i>)*<i>f</i><sub>2</sub>(<i>x</i>)
</div>
<p>where <span class="formula"><i>f</i><sub>1</sub></span> is defined by the <cite>&quot;function1</cite>&quot; sublist, and
<span class="formula"><i>f</i><sub>2</sub></span> by the <cite>&quot;function2</cite>&quot; sublist:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-multiplicative&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function1&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function2&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="composition-function">
<h3><a class="toc-backref" href="#id109">Composition Function</a></h3>
<blockquote>
CompositionFunction: f(x,y) = f1(x,y) * f2(x,y)</blockquote>
<p>Function composition simply applies one function to the result of another.</p>
<div class="formula">
<i>f</i>(<i>x</i>) = <i>f</i><sub>1</sub>(<i>f</i><sub>2</sub>(<i>x</i>))
</div>
<p>where <span class="formula"><i>f</i><sub>1</sub></span> is defined by the <cite>&quot;function1</cite>&quot; sublist, and
<span class="formula"><i>f</i><sub>2</sub></span> by the <cite>&quot;function2</cite>&quot; sublist:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-composition&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function1&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function2&quot;</span><span class="nt">&gt;</span>
    function-specification
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="piecewise-bilinear-function">
<h3><a class="toc-backref" href="#id110">Piecewise Bilinear Function</a></h3>
<blockquote>
BilinearFunction: a piecewise bilinear function.</blockquote>
<p>A piecewise bilinear function extends the linear form of the tabular function to two variables.</p>
<p>Define <span class="formula"><i>i</i>(<i>x</i>) = <i>i</i> : <i>x</i><sub><i>i</i></sub> &lt; <i>x</i> &lt;  = <i>x</i><sub><i>i</i> + 1</sub></span> and similarly <span class="formula"><i>j</i>(<i>y</i>) = <i>j</i> : <i>y</i><sub><i>j</i></sub> &lt; <i>y</i> &lt;  = <i>y</i><sub><i>j</i> + 1</sub></span> for monotonically increasing <span class="formula"><i>x</i><sub><i>i</i></sub></span> and <span class="formula"><i>y</i><sub><i>j</i></sub></span>.</p>
<p>Given a two-dimensional array <span class="formula"><i>u</i><sub><i>i</i>, <i>j</i></sub></span>, <span class="formula"><i>f</i></span> is then defined by
bilinear interpolation on <span class="formula"><i>u</i><sub><i>i</i>(<i>x</i>), <i>j</i>(<i>y</i>)</sub>, <i>u</i><sub><i>i</i>(<i>x</i>) + 1, <i>j</i>(<i>y</i>)</sub>, <i>u</i><sub><i>i</i>(<i>x</i>), <i>j</i>(<i>y</i>) + 1</sub>, <i>u</i><sub><i>i</i>(<i>x</i>) + 1, <i>j</i>(<i>y</i>) + 1</sub>, <i>if</i> : <i>math</i> : </span> is in
<span class="formula">[<i>x</i><sub>0</sub>, <i>x</i><sub><i>n</i></sub>] × [<i>y</i><sub>0</sub>, <i>y</i><sub><i>m</i></sub>]</span>, linear interpolation if one of <span class="formula"><i>x</i>, <i>y</i></span>
are out of those bounds, and constant at the corner value if both are out of
bounds.</p>
<ul class="simple">
<li><cite>&quot;file</cite>&quot; <tt class="docutils literal">[string]</tt> HDF5 filename of the data</li>
<li><cite>&quot;row header</cite>&quot; <tt class="docutils literal">[string]</tt> name of the row dataset, the <span class="formula"><i>x</i><sub><i>i</i></sub></span></li>
<li><cite>&quot;row coordinate</cite>&quot; <tt class="docutils literal">[string]</tt> one of <cite>&quot;t</cite>&quot;,`&quot;x`&quot;,`&quot;y`&quot;,`&quot;z`&quot;</li>
<li><cite>&quot;column header</cite>&quot; <tt class="docutils literal">[string]</tt> name of the column dataset, the <span class="formula"><i>y</i><sub><i>i</i></sub></span></li>
<li><cite>&quot;column coordinate</cite>&quot; <tt class="docutils literal">[string]</tt> one of <cite>&quot;t</cite>&quot;,`&quot;x`&quot;,`&quot;y`&quot;,`&quot;z`&quot;</li>
<li><cite>&quot;value header</cite>&quot; <tt class="docutils literal">[string]</tt> name of the values dataset, the <span class="formula"><i>u</i><sub><i>i</i>, <i>j</i></sub></span></li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-bilinear&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;pressure.h5&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;row header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;/time&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;row coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;t&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;column header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;/x&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;column coordinate&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;x&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;value header&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;/pressure&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="distance-function">
<h3><a class="toc-backref" href="#id111">Distance Function</a></h3>
<blockquote>
DistanceFunction: distance from a reference point.</blockquote>
<p>A distance function calculates distance from reference point <span class="formula"><i>x</i><sub>0</sub></span>
using by the following expression:</p>
<div class="formula">
<i>f</i>(<i>x</i>) = <span class="limits"><sup class="limit"><i>n</i></sup><span class="limit">⎲</span><span class="limit">⎳</span><sub class="limit"><i>j</i> = 0</sub></span><i>m</i><sub><i>j</i></sub>(<i>x</i><sub><i>j</i></sub> − <i>x</i><sub>0, <i>j</i></sub>)<sup>2</sup>
</div>
<p>Note that the first parameter in <span class="formula"><i>x</i></span> can be time.
Here is an example of a distance function using isotropic metric:</p>
<p>Example:
.. code-block:: xml</p>
<blockquote>
<dl class="docutils">
<dt>&lt;ParameterList name=&quot;function-distance&quot;&gt;</dt>
<dd>&lt;Parameter name=&quot;x0&quot; type=&quot;Array(double)&quot; value=&quot;{1.0, 3.0, 0.0}&quot;/&gt;
&lt;Parameter name=&quot;metric&quot; type=&quot;Array(double)&quot; value=&quot;{1.0, 1.0, 1.0}&quot;/&gt;</dd>
</dl>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 2572)</p>
Definition list ends without a blank line; unexpected unindent.</div>
<p>&lt;/ParameterList&gt;</p>
</blockquote>
</div>
<div class="section" id="monomial-function">
<h3><a class="toc-backref" href="#id112">Monomial Function</a></h3>
<blockquote>
MonomialFunction: a multivariate monomial function.</blockquote>
<p>A multi-variable monomial function is given by the following expression:</p>
<div class="formula">
<i>f</i>(<i>x</i>) = <i>c</i><span class="limits"><sup class="limit"><i>n</i></sup><span class="limit">∏</span><sub class="limit"><i>j</i> = 0</sub></span>(<i>x</i><sub><i>j</i></sub> − <i>x</i><sub>0, <i>j</i></sub>)<sup><i>p</i><sub><i>j</i></sub></sup>
</div>
<p>with the constant factor <span class="formula"><i>c</i></span>, the reference point <span class="formula"><i>x</i><sub>0</sub></span>, and
integer exponents <span class="formula"><i>p</i><sub><i>j</i></sub></span>.
Note that the first parameter in <span class="formula"><i>x</i></span> can be time.
Here is an example of monomial of degree 6 in three variables:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-monomial&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;c&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1.0&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;x0&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(double)&quot;</span> <span class="na">value=</span><span class="s">&quot;{1.0, 3.0, 0.0}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;exponents&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(int)&quot;</span> <span class="na">value=</span><span class="s">&quot;{2, 3, 1}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="standard-math-function">
<h3><a class="toc-backref" href="#id113">Standard Math Function</a></h3>
<blockquote>
StandardMathFunction: provides access to many common mathematical functions.</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 2605)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>These functions allow to set up non-trivial time-dependent boundary conditions
which increases a set of analytic solutions that can be used in convergence
analysis tests.</p>
<div class="formula">
<i>f</i>(<i>x</i>) = <i>A</i>*<i>operator</i>(<i>p</i>*(<i>x</i> − <i>s</i>))
</div>
<p>or</p>
<div class="formula">
<i>f</i>(<i>x</i>) = <i>A</i>*<i>operator</i>(<i>x</i> − <i>s</i>, <i>p</i>)
</div>
<p>Note that these operate only on the first coordinate, which is often time.
Function composition can be used to apply these to other coordinates (or
better yet a dimension could/should be added upon request).</p>
<ul class="simple">
<li><cite>&quot;operator</cite>&quot; <tt class="docutils literal">[string]</tt> specifies the name of a standard mathematical function.
Available options are <cite>&quot;cos</cite>&quot;, <cite>&quot;sin</cite>&quot;, <cite>&quot;tan</cite>&quot;, <cite>&quot;acos</cite>&quot;, <cite>&quot;asin</cite>&quot;, <cite>&quot;atan</cite>&quot;,
<cite>&quot;cosh</cite>&quot;, <cite>&quot;sinh</cite>&quot;, <cite>&quot;tanh</cite>&quot;, <cite>&quot;exp</cite>&quot;, <cite>&quot;log</cite>&quot;, <cite>&quot;log10</cite>&quot;, <cite>&quot;sqrt</cite>&quot;, <cite>&quot;ceil</cite>&quot;,
<cite>&quot;fabs</cite>&quot;, <cite>&quot;floor</cite>&quot;, <cite>&quot;mod</cite>&quot;, and <cite>&quot;pow</cite>&quot;.</li>
<li><cite>&quot;amplitude</cite>&quot; <tt class="docutils literal">[double]</tt> specifies a multiplication factor <cite>a</cite> in formula <cite>a f(x)</cite>.
The multiplication factor is ignored by function <cite>mod</cite>. Default value is 1.</li>
<li><cite>&quot;parameter</cite>&quot; <tt class="docutils literal">[double]</tt> <strong>1.0</strong> specifies additional parameter <cite>p</cite> for
math functions with two arguments. These functions are <cite>&quot;a pow(x[0], p)</cite>&quot;
and <cite>&quot;a mod(x[0], p)</cite>&quot;.  Alternative, scales the argument before
application, for use in changing the period of trig functions.</li>
<li><cite>&quot;shift</cite>&quot; <tt class="docutils literal">[double]</tt> specifies a shift of the function argument. Default is 0.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;function-standard-math&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;operator&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;sqrt&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;amplitude&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;1e-7&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;shift&quot;</span> <span class="na">type=</span><span class="s">&quot;double&quot;</span> <span class="na">value=</span><span class="s">&quot;0.1&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
<p>This example defines function <cite>1e-7 sqrt(t-0.1)</cite>.</p>
</div>
</div>
<div class="section" id="operator">
<h2><a class="toc-backref" href="#id114">Operator</a></h2>
<blockquote>
Operator represents a linear map, and typically encapsulates a discretization.</blockquote>
<p><tt class="docutils literal">Operator</tt> represents a map from linear space X to linear space Y.  Typically,
this map is a linear map, and encapsulates much of the discretization involved
in moving from continuous to discrete equations.  At the moment, it is assumed
that X = Y, but this could be changed if future needs require it.</p>
<p>An <tt class="docutils literal">Operator</tt> provides an interface for applying both the forward and inverse
linear map (assuming the map is invertible).</p>
<p>Typically the <tt class="docutils literal">Operator</tt> is never seen by the user; instead the user provides
input information for helper classes based on the continuous mathematical
operator and the desired discretization.  These helpers build the needed
<tt class="docutils literal">Operator</tt>, which may incldude information from multiple helpers (i.e. in the
case of Jacobian Operators for a PDE).</p>
<p>However, one option may be provided by the user, which is related to dealing
with nearly singular operators:</p>
<ul class="simple">
<li><cite>&quot;diagonal shift</cite>&quot; <tt class="docutils literal">[double]</tt> <strong>0.0</strong> Adds a scalar shift to the diagonal
of the <tt class="docutils literal">Operator</tt>, which can be useful if the <tt class="docutils literal">Operator</tt> is singular or
near-singular.</li>
</ul>
<div class="section" id="operatoraccumulation">
<h3><a class="toc-backref" href="#id115">OperatorAccumulation</a></h3>
<blockquote>
<tt class="docutils literal">OperatorAccumulation</tt> generates a diagonal matrix representing accumulation</blockquote>
<p><tt class="docutils literal">OperatorAccumulation</tt> assembles the discrete form of <span class="formula"><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>A</i></span><span class="ignored">)/(</span><span class="denominator">∂<i>t</i></span><span class="ignored">)</span></span></span>.</p>
<p>This class is usually used as part of a preconditioner, providing the linearization:</p>
<div class="formula">
<span class="fraction"><span class="ignored">(</span><span class="numerator">∂</span><span class="ignored">)/(</span><span class="denominator">∂<i>A</i></span><span class="ignored">)</span></span><span class="array"><span class="arrayrow"><span class="bracket align-left">⎡</span></span><span class="arrayrow"><span class="bracket align-left">⎣</span></span></span><span class="fraction"><span class="ignored">(</span><span class="numerator">∂<i>A</i></span><span class="ignored">)/(</span><span class="denominator">∂<i>t</i></span><span class="ignored">)</span></span><span class="array"><span class="arrayrow"><span class="bracket align-right">⎤</span></span><span class="arrayrow"><span class="bracket align-right">⎦</span></span></span><sub><i>A</i><sub>0</sub></sub> = <span class="fraction"><span class="ignored">(</span><span class="numerator">|Ω<sub><i>E</i></sub>|</span><span class="ignored">)/(</span><span class="denominator">Δ<i>t</i></span><span class="ignored">)</span></span>
</div>
<p>for a grid element <span class="formula">Ω<sub><i>E</i></sub></span>.</p>
<p>No options are available here.</p>
</div>
<div class="section" id="operatordiffusion">
<h3><a class="toc-backref" href="#id116">OperatorDiffusion</a></h3>
<p><tt class="docutils literal">OperatorDiffusion</tt> form local <tt class="docutils literal">Op</tt> s and global <tt class="docutils literal">Operator</tt> s for elliptic equations:</p>
<div class="formula">
∇⋅<i>k</i>∇<i>u</i>
</div>
<p>with a variety of discretizations.  Note also, for reasons that are one part historical and potentially not that valid, this also supports and implementation with an advective source, i.e.:</p>
<div class="formula">
∇⋅<i>k</i>(∇<i>u</i> + <i>ẑ</i>)
</div>
<p>for gravitational terms in Richards equations.</p>
<p>The input spec for a diffusion operator consists of:</p>
<ul class="simple">
<li><cite>&quot;discretization primary</cite>&quot; <tt class="docutils literal">[string]</tt> Currently supported options include:</li>
</ul>
<blockquote>
<ul class="simple">
<li><cite>&quot;fv: default</cite>&quot; the standard two-point flux finite volume discretization</li>
<li><cite>&quot;nlfv: default</cite>&quot; the nonlinear finite volume method of ???</li>
<li>MFD methods, including:</li>
</ul>
<blockquote>
<ul class="simple">
<li><cite>&quot;mfd: default</cite>&quot;</li>
<li><cite>&quot;mfd: monotone for hex</cite>&quot;</li>
<li><cite>&quot;mfd: optimized for monotonicity</cite>&quot;</li>
<li><cite>&quot;mfd: two-point flux approximation</cite>&quot;</li>
<li><cite>&quot;mfd: optimized for sparsity</cite>&quot;</li>
<li><cite>&quot;mfd: support operator</cite>&quot;</li>
</ul>
</blockquote>
<p>Note that the most commonly used are <cite>&quot;fv: default</cite>&quot; for simple test
problems (this method is not particularly accurate for distorted
meshes), <cite>&quot;mfd: optimized for sparsity</cite>&quot; for most real problems on
unstructured meshes, and <cite>&quot;mfd: optimized for monotonicity</cite>&quot; for
orthogonal meshes with diagonal tensor/scalar coefficients.</p>
</blockquote>
<ul class="simple">
<li><cite>&quot;gravity</cite>&quot; [bool] <strong>false</strong> specifies if the gravitational flow term is included</li>
<li><cite>&quot;Newton correction</cite>&quot; [string] specifies a model for non-physical terms
that must be added to the matrix. These terms represent Jacobian and are needed
for the preconditioner. Available options are <cite>&quot;true Jacobian</cite>&quot; and <cite>&quot;approximate Jacobian</cite>&quot;.
The FV scheme accepts only the first options. The other schemes accept only the second option.</li>
<li><cite>&quot;scaled constraint equation</cite>&quot; [bool] <strong>false</strong> rescales flux continuity equations
on mesh faces.  These equations are formed without the nonlinear
coefficient. This option allows us to treat the case of zero nonlinear
coefficient, which otherwise generates zero rows in the operator, which is
then singular.  At moment this feature does not work with non-zero gravity
term.</li>
<li><cite>&quot;constraint equation scaling cutoff&quot;</cite>&quot; [double] specifies the cutoff value for
applying rescaling strategy described above.</li>
</ul>
<p>Additional options available only for the MFD family of discretizations include:</p>
<ul class="simple">
<li><cite>&quot;nonlinear coefficient</cite>&quot; [string] specifies a method for treating nonlinear
diffusion coefficient, if any. Available options are <cite>&quot;none</cite>&quot;, <cite>&quot;upwind:
face</cite>&quot;, <cite>&quot;divk: cell-face</cite>&quot; (default), <cite>&quot;divk: face</cite>&quot;, <cite>&quot;standard: cell</cite>&quot;,
<cite>&quot;divk: cell-face-twin</cite>&quot; and <cite>&quot;divk: cell-grad-face-twin</cite>&quot;.  Symmetry
preserving methods are the divk-family of methods and the classical
cell-centered method (<cite>&quot;standard: cell</cite>&quot;). The first part of the name
indicates the base scheme.  The second part (after the semi-column)
indicates required components of the composite vector that must be provided
by a physical PK.</li>
<li><cite>&quot;discretization secondary</cite>&quot; [string] specifies the most robust
discretization method that is used when the primary selection fails to
satisfy all a priori conditions.  This is typically <cite>&quot;mfd: default</cite>&quot;.
<strong>Used only when an MFD `&quot;primary discretization`&quot; is used</strong></li>
<li><cite>&quot;schema</cite>&quot; [Array(string)] defines the operator stencil. It is a collection of
geometric objects.  Typically this is set by the implementation and is not provided.</li>
<li><cite>&quot;preconditioner schema</cite>&quot; [Array(string)] <strong>{face,cell}</strong> Defines the
preconditioner stencil.  It is needed only when the default assembling
procedure is not desirable. If skipped, the <cite>&quot;schema</cite>&quot; is used instead.
In addition to the default, <strong>{face}</strong> may be used, which forms the Schur
complement.</li>
<li><cite>&quot;consistent faces</cite>&quot; [list] may contain a <cite>&quot;preconditioner</cite>&quot; and
<cite>&quot;linear operator</cite>&quot; list (see sections <a href="#id132"><span class="problematic" id="id133">Preconditioners_</span></a> and <a href="#id134"><span class="problematic" id="id135">LinearSolvers_</span></a>
respectively).  If these lists are provided, and the <cite>&quot;discretization
primary</cite>&quot; is of type <cite>&quot;mfd: *</cite>&quot;, then the diffusion method
UpdateConsistentFaces() can be used.  This method, given a set of cell
values, determines the faces constraints that satisfy the constraint
equation in MFD by assembling and inverting the face-only system.  This is
not currently used by any Amanzi PKs.</li>
<li><cite>&quot;diffusion tensor</cite>&quot; [string] allows us to solve problems with symmetric and non-symmetric
(but positive definite) tensors. Available options are <em>symmetric</em> (default) and <em>nonsymmetric</em>.</li>
</ul>
<p>Additional options for MFD with the gravity term include:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><cite>&quot;gravity term discretization</cite>&quot; [string] selects a model for discretizing the</dt>
<dd>gravity term. Available options are <cite>&quot;hydraulic head</cite>&quot; [default] and <cite>&quot;finite volume</cite>&quot;.
The first option starts with equation for the shifted solution, i.e. the hydraulic head,
and derives gravity discretization by the reserve shifting.
The second option is based on the divergence formula.</dd>
</dl>
</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;OPERATOR_NAME&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;discretization primary&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;mfd: optimized for monotonicity&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;discretization secondary&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;mfd: two-point flux approximation&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;schema&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{face, cell}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;preconditioner schema&quot;</span> <span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span> <span class="na">value=</span><span class="s">&quot;{face}&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;gravity&quot;</span> <span class="na">type=</span><span class="s">&quot;bool&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;gravity term discretization&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;hydraulic head&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;nonlinear coefficient&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;upwind: face&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;Parameter</span> <span class="na">name=</span><span class="s">&quot;Newton correction&quot;</span> <span class="na">type=</span><span class="s">&quot;string&quot;</span> <span class="na">value=</span><span class="s">&quot;true Jacobian&quot;</span><span class="nt">/&gt;</span>

  <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;consistent faces&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;linear solver&quot;</span><span class="nt">&gt;</span>
      ...
    <span class="nt">&lt;/ParameterList&gt;</span>
    <span class="nt">&lt;ParameterList</span> <span class="na">name=</span><span class="s">&quot;preconditioner&quot;</span><span class="nt">&gt;</span>
      ...
    <span class="nt">&lt;/ParameterList&gt;</span>
  <span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="section" id="operatoradvection">
<h3><a class="toc-backref" href="#id117">OperatorAdvection</a></h3>
<p><tt class="docutils literal">OperatorAdvection</tt> assembles the discrete form of:</p>
<div class="formula">
∇⋅<i>Aq</i>
</div>
<p>which advects quantity <span class="formula"><i>A</i></span> with fluxes <span class="formula"><i>q</i></span>.</p>
<p>This is a simple, first-order donor-upwind scheme, and is mostly intended for
use in diffusion-dominated advection-diffusion equations.  No options are
available here.</p>
</div>
</div>
</div>
<div class="system-messages section">
<h1>Docutils System Messages</h1>
<div class="system-message" id="id118">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 552); <em><a href="#id119">backlink</a></em></p>
Unknown target name: &quot;timecontrol&quot;.</div>
<div class="system-message" id="id120">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 829); <em><a href="#id121">backlink</a></em></p>
Unknown target name: &quot;pkdefaultbase&quot;.</div>
<div class="system-message" id="id122">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 869); <em><a href="#id123">backlink</a></em></p>
Unknown target name: &quot;pkdefaultbase&quot;.</div>
<div class="system-message" id="id124">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 902); <em><a href="#id125">backlink</a></em></p>
Unknown target name: &quot;pkdefaultbase&quot;.</div>
<div class="system-message" id="id126">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 977); <em><a href="#id127">backlink</a></em></p>
Unknown target name: &quot;linearsolver&quot;.</div>
<div class="system-message" id="id128">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 1062); <em><a href="#id129">backlink</a></em></p>
Unknown target name: &quot;linearsolver&quot;.</div>
<div class="system-message" id="id130">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 1186); <em><a href="#id131">backlink</a></em></p>
Unknown target name: &quot;linearsolver&quot;.</div>
<div class="system-message" id="id132">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 2784); <em><a href="#id133">backlink</a></em></p>
Unknown target name: &quot;preconditioners&quot;.</div>
<div class="system-message" id="id134">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ATSNativeSpec_dev.rst</tt>, line 2784); <em><a href="#id135">backlink</a></em></p>
Unknown target name: &quot;linearsolvers&quot;.</div>
</div>
</div>
</body>
</html>
