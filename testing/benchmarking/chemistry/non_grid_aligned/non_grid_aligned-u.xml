<ParameterList name="Main">
  <Parameter name="Amanzi Input Format Version" type="string" value="1.2.2"/>
  <ParameterList name="Execution Control">
    <Parameter name="Flow Model" type="string" value="Single Phase"/>
    <Parameter name="Transport Model" type="string" value="On"/>
    <Parameter name="Chemistry Model" type="string" value="Amanzi"/>

    <ParameterList name="Time Integration Mode">
      <ParameterList name="Initialize To Steady">
        <Parameter name="Start" type="double" value="0.0"/>
        <Parameter name="End" type="double" value="72.0" /> <!--value="72.0"/>-->
        <Parameter name="Switch" type="double" value="0.0"/>
        <Parameter name="Steady Initial Time Step" type="double" value="0.2"/>
        <Parameter name="Transient Initial Time Step" type="double" value="0.2"/>
      </ParameterList>
    </ParameterList>

    <Parameter name="Verbosity" type="string" value="High"/>

    <ParameterList name="Numerical Control Parameters">
      <ParameterList name="Unstructured Algorithm">
        <Parameter name="linear solver tolerance" type="double" value="1e-20"/>
        <Parameter name="linear solver maximum iterations" type="int" value="100"/> 

        <ParameterList name="Transient Implicit Time Integration">
          <Parameter name="transient time step increase factor" type="double" value="1.0"/>
          <Parameter name="transient preconditioner" type="string" value="Hypre AMG"/>
          <Parameter name="transient max time step" type="double" value="1e+7"/>
          <Parameter name="transient initialize with darcy" type="bool" value="true"/>
         </ParameterList>

        <ParameterList name="Flow Process Kernel">
          <Parameter name="Preconditioning Strategy" type="string" value="Diffusion Operator"/>
        </ParameterList>

        <ParameterList name="Transport Process Kernel">
          <Parameter name="transport subcycling" type="bool" value="true"/>
          <Parameter name="Transport Integration Algorithm" type="string" value="Explicit Second-Order"/>
          <Parameter name="CFL" type="double" value="1.0"/>
        </ParameterList>
      </ParameterList>
    </ParameterList>
  </ParameterList>
      
  <!-- MESH -->
  <ParameterList name="Domain">
    <Parameter name="Spatial Dimension" type="int" value="2"/>
 </ParameterList>

  <ParameterList name="Mesh">
    <ParameterList name="Unstructured">
      <ParameterList name="Expert">
        <Parameter name="Framework" type="string" value="MSTK"/>
        <Parameter name="Verify Mesh" type="bool" value="false"/>
      </ParameterList>
      <ParameterList name="Generate Mesh">
        <ParameterList name="Uniform Structured">
          <Parameter name="Domain Low Coordinate" type="Array(double)" value="{0, 0}"/>
          <Parameter name="Domain High Coordinate" type="Array(double)" value="{0.6, 0.5}"/>
          <Parameter name="Number of Cells" type="Array(int)" value="{120, 100}"/>
        </ParameterList>
      </ParameterList>
    </ParameterList>
  </ParameterList>

  <!-- REGIONS -->
  <ParameterList name="Regions">
    <ParameterList name="All domain">
      <ParameterList name="Region: Box">
        <Parameter name="Low Coordinate" type="Array(double)" value="{0.0, 0.0}"/>
        <Parameter name="High Coordinate" type="Array(double)" value="{0.6, 0.5}"/>
      </ParameterList>
    </ParameterList>
    <ParameterList name="Left bottom">
      <ParameterList name="Region: Box">
        <Parameter name="Low Coordinate" type="Array(double)" value="{0.0, 0.0}"/>
        <Parameter name="High Coordinate" type="Array(double)" value="{0.0, 0.25}"/>
      </ParameterList>
    </ParameterList>
    <ParameterList name="Left top">
      <ParameterList name="Region: Box">
        <Parameter name="Low Coordinate" type="Array(double)" value="{0.0, 0.25}"/>
        <Parameter name="High Coordinate" type="Array(double)" value="{0.0, 0.5}"/>
      </ParameterList>
    </ParameterList>
    <ParameterList name="Right">
      <ParameterList name="Region: Box">
        <Parameter name="Low Coordinate" type="Array(double)" value="{0.6, 0.0}"/>
        <Parameter name="High Coordinate" type="Array(double)" value="{0.6, 0.5}"/>
      </ParameterList>
    </ParameterList>
  </ParameterList>

  <!-- Materials -->
  <ParameterList name="Material Properties">
    <ParameterList name="Aquifers">
      <Parameter name="Assigned Regions" type="Array(string)" value="{All domain}"/>
      
      <ParameterList name="Porosity: Uniform">
        <Parameter name="Value" type="double" value="0.38"/>
      </ParameterList>
      
      <ParameterList name="Hydraulic Conductivity: Uniform">
        <Parameter name="Value" type="double" value="0.38e-2"/>
      </ParameterList>

      <ParameterList name="Dispersion Tensor: Uniform Isotropic">
        <Parameter name="alphaL" type="double" value="0.0001"/>
        <Parameter name="alphaT" type="double" value="0.0001"/>
      </ParameterList>
      
      <ParameterList name="Molecular Diffusion: Uniform">
        <Parameter name="Value" type="double" value="0.0"/>
      </ParameterList>
      
      <ParameterList name="Tortuosity: Uniform">
        <Parameter name="Value" type="double" value="1.0"/>
      </ParameterList>

      <ParameterList name="Capillary Pressure: None"/>
      
      <ParameterList name="Mineralogy">
	<ParameterList name="Calcite">
	  <Parameter name="Volume Fraction" type="double" value="0.0"/>
	  <Parameter name="Specific Surface Area" type="double" value="250.0"/>	  
	</ParameterList>
      </ParameterList>
      
    </ParameterList> <!--Aquifers-->
  </ParameterList> <!--Material Properties-->

  <!-- Phases: -->
  <ParameterList name="Phase Definitions">
    
    <ParameterList name="Aqueous">
      <ParameterList name="Phase Properties">
        <ParameterList name="Viscosity: Uniform">
          <Parameter name="Viscosity" type="double" value="1.0e-3"/>
        </ParameterList>
        <ParameterList name="Density: Uniform">
          <Parameter name="Density" type="double" value="1000.0"/>
        </ParameterList>
      </ParameterList>
      <ParameterList name="Phase Components">
        <ParameterList name="Water">
          <Parameter name="Component Solutes" type="Array(string)" value="{CO3--, Ca++}"/>
        </ParameterList>
      </ParameterList>      
    </ParameterList>
    
    <ParameterList name="Solid">
      <Parameter name="Minerals" type="Array(string)" value="{Calcite}"/>
    </ParameterList>
    
  </ParameterList>

  <!-- Initial Conditions: -->
  <ParameterList name="Initial Conditions">
    <ParameterList name="All">
      <Parameter name="Assigned Regions" type="Array(string)" value="{All domain}"/>

      <ParameterList name="IC: Uniform Pressure">
        <Parameter name="Phase" type="string" value="Aqueous"/>
        <Parameter name="Value" type="double" value="101325.0"/>
      </ParameterList>

      <ParameterList name="Solute IC">
        <ParameterList name="Aqueous">
          <ParameterList name="Water">

            <ParameterList name="CO3--">
              <ParameterList name="IC: Uniform Concentration">
                <Parameter name="Value" type="double" value="1e-10"/>
              </ParameterList>
              <Parameter name="Concentration Units" type="string" value="TBC"/>
            </ParameterList>
            
            <ParameterList name="Ca++">
              <ParameterList name="IC: Uniform Concentration">
                <Parameter name="Value" type="double" value="1e-10"/>
              </ParameterList>
              <Parameter name="Concentration Units" type="string" value="TBC"/>
            </ParameterList>
 
          </ParameterList>
        </ParameterList>
      </ParameterList>
    </ParameterList>
  </ParameterList>

  <!-- Boundary Conditions -->
  <ParameterList name="Boundary Conditions">
    <ParameterList name="BC For Left top">
      <Parameter name="Assigned Regions" type="Array(string)" value="{Left top}"/>

      <ParameterList name="BC: Flux">
        <Parameter name="Times" type="Array(double)" value="{0.0, 1e10}"/>
        <Parameter name="Time Functions" type="Array(string)" value="{Constant}"/>
        <Parameter name="Inward Mass Flux" type="Array(double)" value="{0.50e+1, 0.50e+1}"/>
      </ParameterList>

      <ParameterList name="Solute BC">
        <ParameterList name="Aqueous">
          <ParameterList name="Water">
          
            <ParameterList name="CO3--">
              <ParameterList name="BC: Uniform Concentration">
                <Parameter name="Times" type="Array(double)" value="{0.0, 9.4672798E10}"/>
                <Parameter name="Time Functions" type="Array(string)" value="{Constant}"/>
                <Parameter name="Values" type="Array(double)" value="{1e-10, 1e-10}"/>
              </ParameterList>
              <Parameter name="Concentration Units" type="string" value="Molar Concentration"/>
            </ParameterList>
          
            <ParameterList name="Ca++">
              <ParameterList name="BC: Uniform Concentration">
                <Parameter name="Times" type="Array(double)" value="{0.0, 9.4672798E10}"/>
                <Parameter name="Time Functions" type="Array(string)" value="{Constant}"/>
                <Parameter name="Values" type="Array(double)" value="{5e-2, 5e-2}"/>
              </ParameterList>
              <Parameter name="Concentration Units" type="string" value="Molar Concentration"/>
            </ParameterList>
            
          </ParameterList> <!--Water-->                    
        </ParameterList> <!--Aqueous-->        
      </ParameterList> <!--Solute BC-->
    </ParameterList> <!--BC For Left Top-->

    <ParameterList name="BC For Left Bottom">
      <Parameter name="Assigned Regions" type="Array(string)" value="{Left bottom}"/>
      
      <ParameterList name="BC: Flux">
        <Parameter name="Times" type="Array(double)" value="{0.0, 1e10}"/>
        <Parameter name="Time Functions" type="Array(string)" value="{Constant}"/>
        <Parameter name="Inward Mass Flux" type="Array(double)" value="{0.26e+1, 0.26e+1}"/>
      </ParameterList>

      <ParameterList name="Solute BC">
        <ParameterList name="Aqueous">
          <ParameterList name="Water">
            
            <ParameterList name="CO3--">
              <ParameterList name="BC: Uniform Concentration">
                <Parameter name="Times" type="Array(double)" value="{0.0, 1e10}"/>
                <Parameter name="Time Functions" type="Array(string)" value="{Constant}"/>
                <Parameter name="Values" type="Array(double)" value="{5e-2, 5e-2}"/>
              </ParameterList>              
              <Parameter name="Concentration Units" type="string" value="Molar Concentration"/>
            </ParameterList>
            
            <ParameterList name="Ca++">
              <ParameterList name="BC: Uniform Concentration">
                <Parameter name="Times" type="Array(double)" value="{0.0, 1e10}"/>
                <Parameter name="Time Functions" type="Array(string)" value="{Constant}"/>
                <Parameter name="Values" type="Array(double)" value="{1e-10, 1e-10}"/>
              </ParameterList>              
              <Parameter name="Concentration Units" type="string" value="Molar Concentration"/>
            </ParameterList>
            
          </ParameterList> <!--Water-->
        </ParameterList> <!--Aqueous-->
      </ParameterList> <!--Solute BC-->
    </ParameterList> <!--BC For Left Bottom-->

    <ParameterList name="BC For Right">
      <Parameter name="Assigned Regions" type="Array(string)" value="{Right}"/>
      <ParameterList name="BC: Hydrostatic">
        <Parameter name="Times" type="Array(double)" value="{0.0, 1e10}"/>
        <Parameter name="Time Functions" type="Array(string)" value="{Constant}"/>
        <Parameter name="Water Table Height" type="Array(double)" value="{1.0, 1.0}"/>
      </ParameterList>
    </ParameterList>
    
  </ParameterList> <!--Boundary Conditions-->

  <!-- Source Terms -->
  <ParameterList name="Sources"/>

  <!-- Output -->
  <ParameterList name="Output">
    <ParameterList name="Time Macros">
      <ParameterList name="Observation Times">
        <Parameter name="Values" type="Array(double)" value="{1.2096E+08}"/>
      </ParameterList>
      <ParameterList name="EveryYear">
        <Parameter name="Start_Period_Stop" type="Array(double)" value="{0, 1.0e+7, 1.0e+9}"/>
      </ParameterList>
    </ParameterList>

    <ParameterList name="Cycle Macros">
      <ParameterList name="EveryCycle">
        <Parameter name="Start_Period_Stop" type="Array(int)" value="{0, 100, -1}"/>
      </ParameterList>
    </ParameterList>

    <ParameterList name="Visualization Data">
      <Parameter name="File Name Base" type="string" value="non_grid_aligned"/>
      <Parameter name="File Name Digits" type="string" value="5"/>
      <!--Parameter name="Time Macro" type="Array(string)" value="{EveryYear}"/-->
      <Parameter name="Cycle Macros" type="Array(string)" value="{EveryCycle}"/>
    </ParameterList>

    <!--ParameterList name="Observation Data">
      <Parameter name="Observation Output Filename" type="string" value="dispersion.out"/>
      <ParameterList name="Point 01">
        <Parameter name="Region" type="string" value="Dnwind150"/>
        <Parameter name="Functional" type="string" value="Observation Data: Point"/>
        <Parameter name="Variable" type="string" value="Tc-99 Aqueous concentration"/>
        <Parameter name="Time Macro" type="string" value="Observation Times"/>
      </ParameterList>
    </ParameterList-->
  </ParameterList>
  
  <ParameterList name="Chemistry">
    <ParameterList name="Thermodynamic Database">
       <Parameter name="Format" type="string" value="simple" />
       <Parameter name="File" type="string" value="calcite_dbs.bgd" />
    </ParameterList> <!-- Thermodynamic Database -->

    <Parameter name="Engine" type="string" value="Amanzi"/>
    <Parameter name="Engine Input File" type="string" value="1d-calcite.in"/>
    
    <Parameter name="Verbosity" type="Array(string)" value="{verbose}" />
    <Parameter name="Activity Model" type="string" value="debye-huckel" />
    <Parameter name="Tolerance" type="double" value="1.5e-12"/>
    <Parameter name="Maximum Newton Iterations" type="int" value="150"/>
   <!-- <Parameter name="Auxiliary Data" type="Array(string)" value="{pH}"/> -->
    <Parameter name="Max Time Step (s)" type="double" value="15778463.0"/>
  </ParameterList> <!-- Chemistry -->
  
</ParameterList>
